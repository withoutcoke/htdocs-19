function editMapActions(){jQuery(document).ready(function(h){var m=mapsMarkerPro.admin,t=h("#mapSettings").serialize(),n=wp.media({title:mmpAdminL10n.map.chooseGpx,button:{text:mmpAdminL10n.map.choose},library:{type:["application/gpx","application/gpx+xml"]},multiple:!1}),e=new MmpGeocoding("map",h("#geocodingProvider").val(),mmpGeocoding,400,3);function i(){var e=h("#advancedSettings").prop("checked");h(".mmp-advanced").each(function(){e?h(this).show():h(this).hide()})}function a(){h("#filtersAllMarkers").prop("checked")?h("#filtersWrap").hide():h("#filtersWrap").show()}function g(){var e=S();m.loadResources().then(function(){m.geoJson[m.id]=m.parseGeoJson(e),m.drawGeoJson(),m.loadControls(),A()})}function o(e){m.settings.panelColor=e,m.loadPanel()}function s(e){m.settings.gpxTrackColor=e,m.setTrackStyle()}function r(e){m.settings.gpxWaypointsColor=e,m.setWaypointStyle()}function l(e){m.settings.gpxWaypointsFillColor=e,m.setWaypointStyle()}function c(e){m.settings.gpxChartLocatorColor=e,m.setChartStyle()}function p(e){m.settings.gpxChartLocatorFillColor=e,m.setChartStyle()}function u(){var t=[];h(".mmp-basemap").each(function(){t.push(h(this).data("id").toString())}),h("#basemapsList option").each(function(){var e=-1!==h.inArray(h(this).val().toString(),t);h(this).prop("disabled",e)}),h("#basemapsList option").each(function(){if(!h(this).prop("disabled"))return h(this).prop("selected",!0),!1}),h("#basemapsList option:enabled").length?h("#basemapsAdd").prop("disabled",!1):h("#basemapsAdd").prop("disabled",!0)}function d(){var t=[];h("#basemapList li").each(function(e){t.push(h(this).data("id").toString())}),m.settings.basemaps=t,m.loadBasemaps(),m.loadControls()}function f(){var t=[];h(".mmp-overlay").each(function(){t.push(h(this).data("id").toString())}),h("#overlaysList option").each(function(){var e=-1!==h.inArray(h(this).val().toString(),t);h(this).prop("disabled",e)}),h("#overlaysList option").each(function(){if(!h(this).prop("disabled"))return h(this).prop("selected",!0),!1}),h("#overlaysList option:enabled").length?h("#overlaysAdd").prop("disabled",!1):h("#overlaysAdd").prop("disabled",!0)}function v(){var t=[];h("#overlayList li").each(function(e){t.push(h(this).data("id").toString())}),m.settings.overlays=t,m.loadOverlays(),m.loadControls()}function y(){m.settings.overlaysActive=[],h('input[name="overlaysActive[]"]:checked').each(function(){m.settings.overlaysActive.push(h(this).val())})}function b(e,t){var n=void 0===t.active||!!t.active,i=t.icon||"",a=t.name||"",o=h('<li class="mmp-filter" data-id="'+e+'"></li>'),s=h("<div></div>");o.append(s);var r=h('<img class="mmp-handle mmp-align-middle" src="'+mmpAdminVars.pluginUrl+'images/icons/handle.png" />');s.append(r);var l=h('<label class="mmp-align-middle"><div class="switch"><input type="checkbox" name="filtersList['+e+'][active]"'+(n?' checked="checked"':"")+' /><span class="slider"></span></div></label>');h("input",l).change(function(){var e=h(this).closest("li").data("id"),t=h(this).prop("checked");h(".mmp-control-filters-selector[value="+e+"]").prop("checked",t),void 0!==m.groups[e]&&(m.groups[e].active=t),m.drawMarkers(),m.drawGeoJson()}),s.append(" ").append(l);var c=h('<input type="hidden" name="filtersList['+e+'][icon]" value="" />');s.append(c);var p=i?mmpAdminVars.iconsUrl+i:mmpAdminVars.pluginUrl+"images/leaflet/marker.png",u=h('<img class="mmp-filter-icon mmp-align-middle" src="'+p+'" />');u.click(function(){h("#iconTarget").val(h(this).parent().parent().data("id")),h("#icons").show()}),s.append(" ").append(u),(a=h('<input type="text" class="mmp-align-middle" name="filtersList['+e+'][name]" value="'+a+'" />')).change(function(){x(),m.loadControls()}),s.append(" ").append(a);var d=h('<i class="dashicons dashicons-no mmp-remove-filter"></i>');d.click(function(){h(this).parent().parent().remove(),_(),x(),g()}),s.append(" ").append(d),h("#filterList").append(o)}function _(){var t=[];h(".mmp-filter").each(function(){t.push(h(this).data("id"))}),h("#filtersMapList option").each(function(){var e=h(this).val()==m.id||-1!==h.inArray(parseInt(h(this).val()),t);h(this).prop("disabled",e)});var e=!1;h("#filtersMapList option").each(function(){if(!h(this).prop("disabled"))return e=!0,h(this).prop("selected",!0),!1}),e?h("#filtersAdd").prop("disabled",!1):(h("#filtersAdd").prop("disabled",!0),h("#filtersMapList option").prop("selected",!1)),h("#filtersMapList").select2({width:"300px"})}function x(){var n={};h("#filterList li").each(function(e){var t=h(this).data("id");n[t]={index:e,active:h('input[name="filtersList['+t+'][active]"]').prop("checked"),name:h('input[name="filtersList['+t+'][name]"]').val(),icon:h('input[name="filtersList['+t+'][icon]"]').val()}}),m.settings.filtersDetails=n}function w(){m.settings.gpxStartIcon=h("#gpxStartIcon").val(),m.settings.gpxEndIcon=h("#gpxEndIcon").val(),m.setTrackIcons()}function k(e){void 0!==m.map.pm&&(e?(m.settings.filtersGeoJson=!1,g(),m.map.pm.addControls({position:"topleft",drawMarker:!1,drawCircleMarker:!1})):(m.settings.filtersGeoJson=h("#filtersGeoJson").prop("checked"),g(),m.map.pm.removeControls()))}function C(){void 0!==m.map.pm&&m.map.pm.setPathOptions({stroke:h("#drawStroke").prop("checked"),color:h("#drawStrokeColor").val(),weight:parseInt(h("#drawStrokeWeight").val()),opacity:parseFloat(h("#drawStrokeOpacity").val()),lineCap:h("#drawLineCap").val(),lineJoin:h("#drawLineJoin").val(),fill:h("#drawFill").prop("checked"),fillColor:h("#drawFillColor").val(),fillOpacity:parseFloat(h("#drawFillOpacity").val()),fillRule:h("#drawFillRule").val()})}function S(){var a={type:"FeatureCollection",features:[]};return m.geoJson[m.id].eachLayer(function(e){var t=e.toGeoJSON();if((!(e instanceof L.Polyline)||t.geometry.coordinates.length)&&(!(e instanceof L.Polygon)||t.geometry.coordinates.length&&t.geometry.coordinates[0].length&&null!==t.geometry.coordinates[0][0])){void 0===t.properties&&(t.properties={}),e instanceof L.Circle?t.properties.radius=e.getRadius():e instanceof L.Rectangle&&(t.properties.rectangle=!0);for(var n=["name","stroke","color","weight","opacity","lineCap","lineJoin","fill","fillColor","fillOpacity","fillRule","popup"],i=0;i<n.length;i++)void 0!==e.options[n[i]]&&(t.properties[n[i]]=e.options[n[i]]);a.features.push(t)}}),a}function A(){h("#geoJson").empty(),m.geoJson[m.id].eachLayer(D)}function T(e){var t=!1;return e instanceof L.Circle?t="Circle":e instanceof L.Rectangle?t="Rectangle":e instanceof L.Polygon?t="Polygon":e instanceof L.Polyline&&(t="Polyline"),t}function D(e){var t=L.stamp(e),n=T(e),i=h('<li class="mmp-shape" data-id="'+t+'"></li>'),a=h("<div></div>");i.append(a);var o=h('<img class="mmp-align-middle" src="'+mmpAdminVars.pluginUrl+"images/icons/geojson-"+n.toLowerCase()+'.png" />');a.append(o);var s=h('<input type="text" class="mmp-align-middle" value="'+e.options.name+'" />');s.change(function(){var e=h(this).parent().parent().data("id"),t=m.geoJson[m.id].getLayer(e);void 0!==t&&(t.options.name=h(this).val(),m.updatePopup(t,!0))}),a.append(" ").append(s);var r=h('<img class="mmp-align-middle mmp-clickable" src="'+mmpAdminVars.pluginUrl+'images/icons/jump-to.png" />');r.click(function(){m.fitGeoJson(t)}),a.append(" ").append(r);var l=h('<img class="mmp-align-middle mmp-clickable" src="'+mmpAdminVars.pluginUrl+'images/icons/edit-layer.png" />');l.click(function(){P(),h("#shapeId").val(t);var e=m.geoJson[m.id].getLayer(h("#shapeId").val());void 0!==e&&(R(e.options),h("#shapeBackup").val(JSON.stringify(O())),h("#editShape").appendTo(h(this).parent()),h("#editShape").slideDown(500))}),a.append(" ").append(l),h("#geoJson").append(i)}function E(){var e=m.geoJson[m.id].getLayer(h("#shapeId").val());void 0!==e&&e.setStyle(O())}function O(){return{stroke:h("#editDrawStroke").prop("checked"),color:h("#editDrawStrokeColor").val(),weight:h("#editDrawStrokeWeight").val(),opacity:h("#editDrawStrokeOpacity").val(),lineCap:h("#editDrawLineCap").val(),lineJoin:h("#editDrawLineJoin").val(),fill:h("#editDrawFill").prop("checked"),fillColor:h("#editDrawFillColor").val(),fillOpacity:h("#editDrawFillOpacity").val(),fillRule:h("#editDrawFillRule").val(),popup:h("#editDrawPopup").val()}}function R(e){h("#editDrawStroke").prop("checked",e.stroke),h("#editDrawStrokeColor").spectrum("set",e.color),h("#editDrawStrokeWeight").val(e.weight),h("#editDrawStrokeOpacity").val(e.opacity),h('#editDrawLineCap option[value="'+e.lineCap+'"]').prop("selected",!0),h('#editDrawLineJoin option[value="'+e.lineJoin+'"]').prop("selected",!0),h("#editDrawFill").prop("checked",e.fill),h("#editDrawFillColor").spectrum("set",e.fillColor),h("#editDrawFillOpacity").val(e.fillOpacity),h('#editDrawFillRule option[value="'+e.fillRule+'"]').prop("selected",!0),h("#editDrawPopup").val(e.popup)}function P(){var e=h("#shapeBackup").val();e&&(R(JSON.parse(e)),E(),h("#shapeBackup").val(""))}function $(e){void 0!==e[0]&&m.map.fitBounds(e[0].getBounds(),{padding:[10,10]})}n.on("select",function(){var e=n.state().get("selection").first().toJSON();h("#gpxUrl").val(e.url),h("#updateGpx").click()}),m.on("settingsloaded",function(t){h("#filterList").empty(),Object.keys(t.filtersDetails).forEach(function(e){b(e,t.filtersDetails[e])}),_(),x()}),m.on("basemapsloaded",function(e){var n;h("input[name=basemapDefault]:checked").length||(h.each(e,function(e,t){if(m.map.hasLayer(t))return n=e,!1}),n&&h(".mmp-basemap").each(function(e,t){if(h("input[type=text]",t).val()===n)return h("input[type=radio]",t).prop("checked",!0),!1}))}),m.on("maploaded",function(){m.map.on("moveend",function(){h("#lat").val(m.map.getCenter().lat.toFixed(6)),h("#lng").val(m.map.getCenter().lng.toFixed(6))}),m.map.on("zoomend",function(){h("#zoom").val(m.map.getZoom().toFixed(1))}),m.on("controlsloaded",function(){t=h("#mapSettings").serialize(),h(".leaflet-control-layers-base .leaflet-control-layers-selector").change(function(){h(".mmp-basemap").each(function(e,t){var n=h("input[type=text]",t).val();if(m.map.hasLayer(m.basemaps[n]))return h("input[type=radio]",t).prop("checked",!0),!1})}),h(".leaflet-control-layers-overlays .leaflet-control-layers-selector").change(function(){h(".mmp-overlay").each(function(e,t){var n=h("input[type=text]",t).val(),i=m.map.hasLayer(m.overlays[n]);h("input[type=checkbox]",t).prop("checked",i)})}),h(".mmp-control-filters-selector").change(function(){var e=h(this).val(),t=h(this).prop("checked");h('input[name="filtersList['+e+'][active]"]').prop("checked",t)})}),m.map.on("pm:create",function(e){P(),h("#editShape").hide(),h("#editShape").appendTo(h("#mmp-tabDraw-settings"));var t=T(e.layer).toLowerCase();e.layer.options.name=mmpAdminL10n.geoJson[t],m.geoJson[m.id].addLayer(e.layer),A()}),m.map.on("pm:remove",function(e){P(),h("#editShape").hide(),h("#editShape").appendTo(h("#mmp-tabDraw-settings")),m.geoJson[m.id].removeLayer(e.layer),A()}),m.map.on("pm:cut",function(n){P(),h("#editShape").hide(),h("#editShape").appendTo(h("#mmp-tabDraw-settings")),m.geoJson[m.id].removeLayer(n.originalLayer),n.layer.eachLayer(function(e){var t=n.originalLayer.options.name||"";e.options.name=t,m.geoJson[m.id].addLayer(e)}),A()}),a(),C()}),m.on("geojsonloaded",function(){A()}),h("#chooseGpx").click(function(){n.open()}),h("#tabMap, #tabLayers, #tabControl, #tabMarker, #tabFilter, #tabList, #tabShare, #tabInteraction, #tabGpx, #tabDraw").click(function(){!function(e){var t=h(".mmp-tablink.active").first().attr("id");h(".mmp-tab").each(function(){h(this).hide()}),h(".mmp-tablink").each(function(){h(this).removeClass("active")}),h("#mmp-"+e.attr("id")+"-settings").show(),e.addClass("active");var n="tabDraw"===e.attr("id");n&&"tabDraw"!==t?k(!0):n||"tabDraw"!==t||k(!1)}(h(this))}),h("#tabMap").trigger("click"),h("#advancedSettings").change(function(){h.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_advanced_map_settings_state",nonce:h("#nonce").val(),state:h("#advancedSettings").prop("checked")?1:0},beforeSend:i})}),h(".mmp-delete").click(function(e){h.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_delete_map_direct",nonce:h("#nonce").val(),con:0,id:h("#id").val()}}).done(function(e){if(e.success){if(!confirm(e.response.message))return;h.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_delete_map_direct",nonce:h("#nonce").val(),con:1,id:e.response.id}}).done(function(e){e.success&&(t=h("#mapSettings").serialize(),window.location.href=mmpAdminVars.adminUrl+"admin.php?page=mapsmarkerpro_maps")})}})}),h("#panelColor").spectrum({preferredFormat:"hex3",showInput:!0,show:function(e){h(this).data("changed",!1),h("#panel").prop("checked",!0),h("#panel").trigger("change")},move:function(e){o(e.toHexString("hex3"))},change:function(e){h(this).data("changed",!0),o(e.toHexString("hex3"))},hide:function(e){h(this).data("changed")?o(e.toHexString("hex3")):o(h(this).val())}}),h("#gpxTrackColor").spectrum({preferredFormat:"hex3",showInput:!0,show:function(e){h(this).data("changed",!1)},move:function(e){s(e.toHexString("hex3"))},change:function(e){h(this).data("changed",!0),s(e.toHexString("hex3"))},hide:function(e){h(this).data("changed")?s(e.toHexString("hex3")):s(h(this).val())}}),h("#gpxWaypointsColor").spectrum({preferredFormat:"hex3",showInput:!0,show:function(e){h(this).data("changed",!1),h("#gpxWaypoints").prop("checked",!0),h("#gpxWaypoints").trigger("change"),h("#gpxWaypointsStroke").prop("checked",!0),h("#gpxWaypointsStroke").trigger("change")},move:function(e){r(e.toHexString("hex3"))},change:function(e){h(this).data("changed",!0),r(e.toHexString("hex3"))},hide:function(e){h(this).data("changed")?r(e.toHexString("hex3")):r(h(this).val())}}),h("#gpxWaypointsFillColor").spectrum({preferredFormat:"hex3",showInput:!0,show:function(e){h(this).data("changed",!1),h("#gpxWaypoints").prop("checked",!0),h("#gpxWaypoints").trigger("change")},move:function(e){l(e.toHexString("hex3"))},change:function(e){h(this).data("changed",!0),l(e.toHexString("hex3"))},hide:function(e){h(this).data("changed")?l(e.toHexString("hex3")):l(h(this).val())}}),h("#mapSettings").submit(function(e){e.preventDefault(),e.stopPropagation(),h.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_save_map",settings:h("#mapSettings").serialize(),geoJson:JSON.stringify(S())},beforeSend:function(){var e;e=h("#save"),h("#save").prop("disabled",!0),h(e).addClass("mmp-button-loading")}}).done(function(e){e.success?(t=h("#mapSettings").serialize(),"new"==h("#id").val()?(localStorage.setItem("saved",!0),window.location.href=mmpAdminVars.adminUrl+"admin.php?page=mapsmarkerpro_map&id="+e.response.id):h('<div class="notice notice-success"><p>'+e.response.message+"</p></div>").insertBefore(".mmp-main").delay(5e3).fadeOut(500,function(){h(this).remove()})):h('<div class="notice notice-error"><p>'+e.response+"</p></div>").insertBefore(".mmp-main").delay(5e3).fadeOut(500,function(){h(this).remove()})}).always(function(){var e;e=h("#save"),h(e).removeClass("mmp-button-loading"),h("#save").prop("disabled",!1)})}),h("#saveDefaultsLink").click(function(e){e.preventDefault(),e.stopPropagation(),h(this).hide(),h(".mmp-save-defaults").show()}),h("#saveDefaultsConfirm").click(function(e){h.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_save_map_defaults",settings:h("#mapSettings").serialize()},beforeSend:function(){h("#saveDefaultsConfirm").prop("disabled",!0),h("#saveDefaultsCancel").prop("disabled",!0),h(".mmp-save-defaults").addClass("mmp-save-defaults-loading")}}).always(function(){h(".mmp-save-defaults").removeClass("mmp-save-defaults-loading"),h(".mmp-save-defaults").fadeOut(500,function(){h("#saveDefaultsConfirm").prop("disabled",!1),h("#saveDefaultsCancel").prop("disabled",!1),h("#saveDefaultsLink").show()})})}),h("#saveDefaultsCancel").click(function(e){h(".mmp-save-defaults").hide(),h("#saveDefaultsLink").show()}),h("#fitMarkers").click(function(){m.fitVisibleMarkers()}),h("#name").change(function(){m.settings.name=h(this).val().replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),m.loadPanel()}),h("#width, input[name=widthUnit], #height, input[name=heightUnit]").change(function(){h("#widthUnitPct").prop("checked")&&100<h("#width").val()&&h("#width").val(100),m.settings.width=parseInt(h("#width").val()),m.settings.widthUnit=h("input[name=widthUnit]:checked").val(),m.settings.height=parseInt(h("#height").val()),m.settings.heightUnit=h("input[name=heightUnit]:checked").val(),m.setLayout()}),h("#lat, #lng").change(function(){var e=parseFloat(h("#lat").val()),t=parseFloat(h("#lng").val());m.map.panTo([e,t])}),h("#zoom, #minZoom, #maxZoom, #zoomStep").change(function(){m.map.options.minZoom=parseFloat(h("#minZoom").val()),m.map.options.maxZoom=parseFloat(h("#maxZoom").val()),m.map.options.zoomSnap=parseFloat(h("#zoomStep").val()),m.map.options.zoomDelta=parseFloat(h("#zoomStep").val()),m.map.setZoom(parseFloat(h("#zoom").val()))}),h("#maxBounds").change(function(){m.map.setMaxBounds(m.strToBounds(h("#maxBounds").val()))}),h("#restrictView").click(function(){h("#minZoom").val(m.map.getZoom()),m.map.options.minZoom=parseFloat(h("#minZoom").val()),h("#maxBounds").val(m.boundsToStr(m.map.getBounds())),m.map.setMaxBounds(m.strToBounds(h("#maxBounds").val()))}),h("#panel").change(function(){m.settings.panel=h(this).prop("checked"),m.loadPanel()}),h("#panelFs, #panelGpx, #panelGeoJson, #panelKml, #panelGeoRss").change(function(){m.settings[h(this).attr("id")]=h(this).prop("checked"),m.loadPanel()}),h("#basemapList").sortable({handle:".mmp-handle",update:d}),h("#basemapsAdd").click(function(){!function(e,t){var n=h('<li class="mmp-basemap" data-id="'+e+'"></li>'),i=h("<div></div>");n.append(i);var a=h('<input type="hidden" name="basemaps[]" value="'+e+'" />');i.append(a);var o=h('<img class="mmp-handle mmp-align-middle" src="'+mmpAdminVars.pluginUrl+'images/icons/handle.png" />');i.append(o);var s=h('<input type="radio" name="basemapDefault" value="'+e+'" />');s.change(function(){m.settings.basemapDefault=h(this).val(),m.loadBasemaps(),m.loadControls()}),i.append(" ").append(s);var r=h('<input type="text" class="mmp-align-middle" value="'+t+'" disabled="disabled" />');i.append(" ").append(r);var l=h('<i class="dashicons dashicons-no mmp-remove-basemap"></i>');l.click(function(){h(this).parent().parent().remove(),u(),d()}),i.append(" ").append(l),h("#basemapList").append(n)}(h("#basemapsList").val(),h("#basemapsList option:checked").text()),u(),d()}),h(".mmp-remove-basemap").click(function(){h(this).parent().parent().remove(),u(),d()}),u(),h("input[name=basemapDefault]").change(function(){m.settings.basemapDefault=h(this).val(),m.loadBasemaps(),m.loadControls()}),h("#overlayList").sortable({handle:".mmp-handle",update:v}),h("#overlaysAdd").click(function(){!function(e,t){var n=h('<li class="mmp-overlay" data-id="'+e+'"></li>'),i=h("<div></div>");n.append(i);var a=h('<input type="hidden" name="overlays[]" value="'+e+'" />');i.append(a);var o=h('<img class="mmp-handle mmp-align-middle" src="'+mmpAdminVars.pluginUrl+'images/icons/handle.png" />');i.append(o);var s=h('<input type="checkbox" name="overlaysActive[]" value="'+e+'" />');s.change(function(){y(),m.loadOverlays(),m.loadControls()}),i.append(" ").append(s);var r=h('<input type="text" class="mmp-align-middle" value="'+t+'" disabled="disabled" />');i.append(" ").append(r);var l=h('<i class="dashicons dashicons-no mmp-remove-overlay"></i>');l.click(function(){h(this).parent().parent().remove(),f(),v()}),i.append(" ").append(l),h("#overlayList").append(n)}(h("#overlaysList").val(),h("#overlaysList option:checked").text()),f(),v()}),h(".mmp-remove-overlay").click(function(){h(this).parent().parent().remove(),f(),v()}),f(),h('input[name="overlaysActive[]"]').change(function(){y(),m.loadOverlays(),m.loadControls()}),h("input[name=attributionPosition], #attributionCondensed").change(function(){m.settings.attributionPosition=h("input[name=attributionPosition]:checked").val(),m.settings.attributionCondensed=h("#attributionCondensed").prop("checked"),m.loadControls()}),h("input[name=zoomControlPosition]").change(function(){m.settings.zoomControlPosition=h("input[name=zoomControlPosition]:checked").val(),m.loadControls()}),h("input[name=fullscreenPosition]").change(function(){m.settings.fullscreenPosition=h("input[name=fullscreenPosition]:checked").val(),m.loadControls()}),h("input[name=resetPosition], #resetOnDemand").change(function(){m.settings.resetPosition=h("input[name=resetPosition]:checked").val(),m.settings.resetOnDemand=h("#resetOnDemand").prop("checked"),m.loadControls()}),h("input[name=locatePosition]").change(function(){m.settings.locatePosition=h("input[name=locatePosition]:checked").val(),m.loadControls()}),h("input[name=scalePosition]").change(function(){m.settings.scalePosition=h("input[name=scalePosition]:checked").val(),m.loadControls()}),h("#scaleMaxWidth, #scaleMetric, #scaleImperial").change(function(){m.settings.scaleMaxWidth=h("#scaleMaxWidth").val(),m.settings.scaleMetric=h("#scaleMetric").prop("checked"),m.settings.scaleImperial=h("#scaleImperial").prop("checked"),m.loadControls()}),h("input[name=layersPosition], #layersCollapsed").change(function(){m.settings.layersPosition=h("input[name=layersPosition]:checked").val(),m.settings.layersCollapsed=h("#layersCollapsed").val(),m.loadControls()}),h("input[name=filtersPosition], #filtersCollapsed, #filtersOrderBy, #filtersSortOrder").change(function(){h("#filtersSortOrder").prop("disabled","custom"==h("#filtersOrderBy").val()),m.settings.filtersPosition=h("input[name=filtersPosition]:checked").val(),m.settings.filtersCollapsed=h("#filtersCollapsed").val(),m.settings.filtersOrderBy=h("#filtersOrderBy").val(),m.settings.filtersSortOrder=h("#filtersSortOrder").val(),m.loadControls()}),h("input[name=gpxControlPosition], #gpxControlCollapsed").change(function(){m.settings.gpxControlPosition=h("input[name=gpxControlPosition]:checked").val(),m.settings.gpxControlCollapsed=h("#gpxControlCollapsed").val(),m.loadControls()}),h("#filtersButtons, #filtersIcon, #filtersName, #filtersCount").change(function(){m.settings[h(this).attr("id")]=h(this).prop("checked"),m.loadControls()}),h("input[name=minimapPosition], #minimapWidth, #minimapHeight, #minimapCollapsedWidth, #minimapCollapsedHeight, #minimapZoomLevelOffset, #minimapZoomLevelFixed, #minimapMinimized").change(function(){m.settings.minimapPosition=h("input[name=minimapPosition]:checked").val(),m.settings.minimapWidth=h("#minimapWidth").val(),m.settings.minimapHeight=h("#minimapHeight").val(),m.settings.minimapCollapsedWidth=h("#minimapCollapsedWidth").val(),m.settings.minimapCollapsedHeight=h("#minimapCollapsedHeight").val(),m.settings.minimapZoomLevelOffset=parseFloat(h("#minimapZoomLevelOffset").val()),m.settings.minimapZoomLevelFixed=parseFloat(h("#minimapZoomLevelFixed").val())||null,m.settings.minimapMinimized=h("#minimapMinimized").val(),m.loadControls()}),h("#filtersAllMarkers").change(function(){m.settings.filtersAllMarkers=h(this).prop("checked"),a(),g()}),h("#filtersGeoJson").change(function(){m.settings.filtersGeoJson=h(this).prop("checked"),g()}),h("#filterList").sortable({handle:".mmp-handle",update:function(){x(),m.loadControls()}}),h(".mmp-gpx-start-icon").click(function(){h("#iconTarget").val("gpx-start"),h("#icons").show()}),h(".mmp-gpx-end-icon").click(function(){h("#iconTarget").val("gpx-end"),h("#icons").show()}),h("#iconsList img").click(function(){var e=h("#iconTarget").val(),t=h(this).attr("src"),n=h(this).data("icon");"gpx-start"===e?(h("#gpxStartIcon").val(n),h(".mmp-gpx-start-icon").attr("src",t),w()):"gpx-end"===e?(h("#gpxEndIcon").val(n),h(".mmp-gpx-end-icon").attr("src",t),w()):(h('input[name="filtersList['+e+'][icon]"]').val(n),h('.mmp-filter[data-id="'+e+'"] .mmp-filter-icon').attr("src",t),x(),m.loadControls()),h("#icons").hide()}),h("#filtersAdd").click(function(){var e=h("#filtersMapList option:checked").text().replace(/\[(.+)\] /,"").replace(/ \((.+)\)$/,"");b(h("#filtersMapList").val(),{name:e}),_(),x(),g()}),_(),h(".mmp-remove-filter").click(function(){h(this).parent().parent().remove(),_(),x()}),h("#markerOpacity").change(function(){Object.keys(m.markers).forEach(function(e){m.markers[e].setOpacity(parseFloat(h("#markerOpacity").val()))})}),h("#tooltip").change(function(){var t=h(this).prop("checked");Object.keys(m.markers).forEach(function(e){m.markers[e].unbindTooltip(),t&&void 0!==m.tooltips[e]&&m.markers[e].bindTooltip(m.tooltips[e],m.tooltip)})}),h("#tooltipDirection, #tooltipPermanent, #tooltipSticky, #tooltipOpacity").change(function(){m.tooltip.direction=h("#tooltipDirection").val(),m.tooltip.permanent=h("#tooltipPermanent").prop("checked"),m.tooltip.sticky=h("#tooltipSticky").prop("checked"),m.tooltip.opacity=parseFloat(h("#tooltipOpacity").val()),h("#tooltip").trigger("change")}),h("#popupCenterOnMap, #popupMarkername, #popupAddress, #popupCoordinates, #popupDirections, #popupShare, #popupMinWidth, #popupMaxWidth, #popupMaxHeight").change(function(){m.settings.popupCenterOnMap=h("#popupCenterOnMap").prop("checked"),m.settings.popupMarkername=h("#popupMarkername").prop("checked"),m.settings.popupAddress=h("#popupAddress").prop("checked"),m.settings.popupCoordinates=h("#popupCoordinates").prop("checked"),m.settings.popupDirections=h("#popupDirections").prop("checked"),m.settings.popupShare=h("#popupShare").prop("checked"),m.settings.popupMinWidth=parseInt(h("#popupMinWidth").val()),m.settings.popupMaxWidth=parseInt(h("#popupMaxWidth").val()),m.settings.popupMaxHeight=parseInt(h("#popupMaxHeight").val()),m.updatePopups()}),h("#showCoverageOnHover, #spiderfyDistanceMultiplier").change(function(){m.settings.clustering&&(m.markerGroup.remove(),m.markerGroup.options.showCoverageOnHover=h("#showCoverageOnHover").prop("checked"),m.markerGroup.options.spiderfyDistanceMultiplier=parseFloat(h("#spiderfyDistanceMultiplier").val()),m.markerGroup.addTo(m.map))}),h("#listSearch, #listIcon, #listName, #listPopup, #listAddress, #listDistance").change(function(){m.settings[h(this).attr("id")]=h(this).prop("checked"),m.getList()}),h("#listDir, #listFs, #listShare").change(function(){m.settings.listDir=h("#listDir").prop("checked"),m.settings.listFs=h("#listFs").prop("checked"),m.settings.listShare=h("#listShare").prop("checked"),m.getList()}),h("#listDistanceUnit, #listDistancePrecision, #listOrderBy, #listSortOrder, #listLimit, #listAction").change(function(){m.settings.listDistanceUnit=h("#listDistanceUnit").val(),m.settings.listDistancePrecision=parseInt(h("#listDistancePrecision").val()),m.settings.listOrderBy=h("#listOrderBy").val(),m.settings.listSortOrder=h("#listSortOrder").val(),m.settings.listLimit=parseInt(h("#listLimit").val()),m.settings.listAction=h("#listAction").val(),m.getList()}),h("#listOrderById, #listOrderByName, #listOrderByAddress, #listOrderByDistance, #listOrderByIcon, #listOrderByCreated, #listOrderByUpdated").change(function(){m.settings[h(this).attr("id")]=h(this).prop("checked"),m.getList()}),h("#shareUrl, #shareText, #shareFacebook, #shareTwitter, #shareLinkedIn, #shareWhatsApp, #shareEmail").change(function(){m.settings.shareUrl=h("#shareUrl").val(),m.settings.shareText=h("#shareText").val(),m.settings.popupShare=h("#popupShare").prop("checked"),m.settings.listShare=h("#listShare").prop("checked"),m.settings.shareFacebook=h("#shareFacebook").prop("checked"),m.settings.shareTwitter=h("#shareTwitter").prop("checked"),m.settings.shareLinkedIn=h("#shareLinkedIn").prop("checked"),m.settings.shareWhatsApp=h("#shareWhatsApp").prop("checked"),m.settings.shareEmail=h("#shareEmail").prop("checked")}),h("#responsive").change(function(){m.settings.responsive=h(this).prop("checked"),m.setLayout()}),h("#boxZoom").change(function(){h(this).prop("checked")?m.map.boxZoom.enable():m.map.boxZoom.disable()}),h("#doubleClickZoom").change(function(){h(this).prop("checked")?m.map.doubleClickZoom.enable():m.map.doubleClickZoom.disable()}),h("#dragging").change(function(){h(this).prop("checked")?m.map.dragging.enable():m.map.dragging.disable()}),h("#inertia, #inertiaDeceleration, #inertiaMaxSpeed").change(function(){m.map.options.inertia=h("#inertia").prop("checked"),m.map.options.inertiaDeceleration=parseInt(h("#inertiaDeceleration").val()),m.map.options.inertiaMaxSpeed=parseInt(h("#inertiaMaxSpeed").val())}),h("#keyboard").change(function(){h(this).prop("checked")?m.map.keyboard.enable():m.map.keyboard.disable()}),h("#scrollWheelZoom").change(function(){h(this).prop("checked")?m.map.scrollWheelZoom.enable():m.map.scrollWheelZoom.disable()}),h("#touchZoom").change(function(){h(this).prop("checked")?m.map.touchZoom.enable():m.map.touchZoom.disable()}),h("#updateGpx").click(function(){var e=h("#gpxUrl").val();(m.settings.gpxUrl=e)?(m.on("gpxloaded",$),m.getGpx().then(m.loadControls)):(m.off("gpxloaded",$),m.gpx={},m.addGpx(),m.loadControls())}),h("#gpxShowStartIcon, #gpxShowEndIcon").change(function(){m.settings.gpxShowStartIcon=h("#gpxShowStartIcon").prop("checked"),m.settings.gpxShowEndIcon=h("#gpxShowEndIcon").prop("checked"),m.setTrackIcons()}),h("#gpxIntervalMarkers").change(function(){m.settings.gpxIntervalMarkers=h(this).prop("checked"),m.setIntervalMarkers()}),h("#gpxTrackWeight").change(function(){m.settings.gpxTrackWeight=parseInt(h(this).val()),m.setTrackStyle()}),h("#gpxTrackOpacity").change(function(){m.settings.gpxTrackOpacity=parseFloat(h(this).val()),m.setTrackStyle()}),h("#gpxMeta, #gpxMetaUnits").change(function(){m.settings.gpxMeta=h("#gpxMeta").prop("checked"),m.settings.gpxMetaUnits=h("#gpxMetaUnits").val(),m.setTrackMeta()}),h("#gpxMetaName, #gpxMetaDesc, #gpxMetaStart, #gpxMetaEnd, #gpxMetaTotal, #gpxMetaMoving, #gpxMetaDistance, #gpxMetaPace, #gpxMetaHeartRate, #gpxMetaElevation, #gpxMetaDownload").change(function(){m.settings[h(this).attr("id")]=h(this).prop("checked"),m.setTrackMeta()}),h("#gpxWaypoints").change(function(){m.settings.gpxWaypoints=h(this).prop("checked"),m.setWaypoints()}),h("#gpxWaypointsRadius").change(function(){m.settings.gpxWaypointsRadius=parseInt(h(this).val()),m.setWaypointStyle()}),h("#gpxWaypointsStroke").change(function(){m.settings.gpxWaypointsStroke=h(this).prop("checked"),m.setWaypointStyle()}),h("#gpxWaypointsWeight").change(function(){m.settings.gpxWaypointsWeight=parseInt(h(this).val()),m.setWaypointStyle()}),h("#gpxWaypointsFillOpacity").change(function(){m.settings.gpxWaypointsFillOpacity=parseFloat(h(this).val()),m.setWaypointStyle()}),h("#gpxChart").change(function(){m.settings.gpxChart=h(this).prop("checked"),m.loadChart(),m.addElevationChart()}),h("#gpxChartUnits, #gpxChartYOffset").change(function(){m.settings.gpxChartUnits=h(this).val(),m.settings.gpxChartYOffset=h("#gpxChartYOffset").val(),m.updateElevationChart(!0)}),h("#gpxChartHeight").change(function(){var e=parseInt(h(this).val());m.settings.gpxChartHeight=e,void 0!==m.containers.chartWrap&&(m.containers.chartWrap.style.height=e+"px")}),h("#gpxChartReverseX, #gpxChartReverseY").change(function(){m.settings.gpxChartReverseX=h("#gpxChartReverseX").prop("checked"),m.settings.gpxChartReverseY=h("#gpxChartReverseY").prop("checked"),m.updateElevationChart()}),h("#gpxChartYMin, #gpxChartYMax").change(function(){m.settings.gpxChartYMin=h("#gpxChartYMin").val(),m.settings.gpxChartYMax=h("#gpxChartYMax").val(),m.updateElevationChart()}),h("#gpxChartBgColor").spectrum({preferredFormat:"rgb",showAlpha:!0,showInput:!0,show:function(){h(this).data("changed",!1)},move:function(e){m.settings.gpxChartBgColor=e.toRgbString(),m.updateElevationChartThrottled()},change:function(e){h(this).data("changed",!0),m.settings.gpxChartBgColor=e.toRgbString(),m.updateElevationChartThrottled()},hide:function(e){h(this).data("changed")?m.settings.gpxChartBgColor=e.toRgbString():m.settings.gpxChartBgColor=h(this).val(),m.updateElevationChartThrottled()}}),h("#gpxChartGridLinesColor").spectrum({preferredFormat:"rgb",showAlpha:!0,showInput:!0,show:function(){h(this).data("changed",!1)},move:function(e){m.settings.gpxChartGridLinesColor=e.toRgbString(),m.updateElevationChartThrottled()},change:function(e){h(this).data("changed",!0),m.settings.gpxChartGridLinesColor=e.toRgbString(),m.updateElevationChartThrottled()},hide:function(e){h(this).data("changed")?m.settings.gpxChartGridLinesColor=e.toRgbString():m.settings.gpxChartGridLinesColor=h(this).val(),m.updateElevationChartThrottled()}}),h("#gpxChartTicksFontColor").spectrum({preferredFormat:"rgb",showAlpha:!0,showInput:!0,show:function(){h(this).data("changed",!1)},move:function(e){m.settings.gpxChartTicksFontColor=e.toRgbString(),m.updateElevationChartThrottled()},change:function(e){h(this).data("changed",!0),m.settings.gpxChartTicksFontColor=e.toRgbString(),m.updateElevationChartThrottled()},hide:function(e){h(this).data("changed")?m.settings.gpxChartTicksFontColor=e.toRgbString():m.settings.gpxChartTicksFontColor=h(this).val(),m.updateElevationChartThrottled()}}),h("#gpxChartLineWidth").change(function(){m.settings.gpxChartLineWidth=parseInt(h(this).val()),m.updateElevationChartThrottled()}),h("#gpxChartLineColor").spectrum({preferredFormat:"rgb",showAlpha:!0,showInput:!0,show:function(){h(this).data("changed",!1)},move:function(e){m.settings.gpxChartLineColor=e.toRgbString(),m.updateElevationChartThrottled()},change:function(e){h(this).data("changed",!0),m.settings.gpxChartLineColor=e.toRgbString(),m.updateElevationChartThrottled()},hide:function(e){h(this).data("changed")?m.settings.gpxChartLineColor=e.toRgbString():m.settings.gpxChartLineColor=h(this).val(),m.updateElevationChartThrottled()}}),h("#gpxChartFill").change(function(){m.settings.gpxChartFill=h(this).prop("checked"),m.updateElevationChartThrottled()}),h("#gpxChartFillColor").spectrum({preferredFormat:"rgb",showAlpha:!0,showInput:!0,show:function(){h(this).data("changed",!1)},move:function(e){m.settings.gpxChartFillColor=e.toRgbString(),m.updateElevationChartThrottled()},change:function(e){h(this).data("changed",!0),m.settings.gpxChartFillColor=e.toRgbString(),m.updateElevationChartThrottled()},hide:function(e){h(this).data("changed")?m.settings.gpxChartFillColor=e.toRgbString():m.settings.gpxChartFillColor=h(this).val(),m.updateElevationChartThrottled()}}),h("#gpxChartTooltipBgColor").spectrum({preferredFormat:"rgb",showAlpha:!0,showInput:!0,show:function(){h(this).data("changed",!1)},move:function(e){m.settings.gpxChartTooltipBgColor=e.toRgbString(),m.updateElevationChartThrottled()},change:function(e){h(this).data("changed",!0),m.settings.gpxChartTooltipBgColor=e.toRgbString(),m.updateElevationChartThrottled()},hide:function(e){h(this).data("changed")?m.settings.gpxChartTooltipBgColor=e.toRgbString():m.settings.gpxChartTooltipBgColor=h(this).val(),m.updateElevationChartThrottled()}}),h("#gpxChartTooltipFontColor").spectrum({preferredFormat:"rgb",showAlpha:!0,showInput:!0,show:function(){h(this).data("changed",!1)},move:function(e){m.settings.gpxChartTooltipFontColor=e.toRgbString(),m.updateElevationChartThrottled()},change:function(e){h(this).data("changed",!0),m.settings.gpxChartTooltipFontColor=e.toRgbString(),m.updateElevationChartThrottled()},hide:function(e){h(this).data("changed")?m.settings.gpxChartTooltipFontColor=e.toRgbString():m.settings.gpxChartTooltipFontColor=h(this).val(),m.updateElevationChartThrottled()}}),h("#gpxChartIndicatorLineWidth").change(function(){m.settings.gpxChartIndicatorLineWidth=parseInt(h(this).val()),m.updateElevationChartThrottled()}),h("#gpxChartIndicatorLineColor").spectrum({preferredFormat:"rgb",showAlpha:!0,showInput:!0,show:function(){h(this).data("changed",!1)},move:function(e){m.settings.gpxChartIndicatorLineColor=e.toRgbString(),m.updateElevationChartThrottled()},change:function(e){h(this).data("changed",!0),m.settings.gpxChartIndicatorLineColor=e.toRgbString(),m.updateElevationChartThrottled()},hide:function(e){h(this).data("changed")?m.settings.gpxChartIndicatorLineColor=e.toRgbString():m.settings.gpxChartIndicatorLineColor=h(this).val(),m.updateElevationChartThrottled()}}),h("#gpxChartLocator").change(function(){m.settings.gpxChartLocator=h(this).prop("checked")}),h("#gpxChartLocatorRadius").change(function(){m.settings.gpxChartLocatorRadius=parseInt(h(this).val()),m.setChartStyle()}),h("#gpxChartLocatorStroke").change(function(){m.settings.gpxChartLocatorStroke=h(this).prop("checked"),m.setChartStyle()}),h("#gpxChartLocatorColor").spectrum({preferredFormat:"hex3",showInput:!0,show:function(){h(this).data("changed",!1)},move:function(e){c(e.toHexString("hex3"))},change:function(e){h(this).data("changed",!0),c(e.toHexString("hex3"))},hide:function(e){h(this).data("changed")?c(e.toHexString("hex3")):c(h(this).val())}}),h("#gpxChartLocatorWeight").change(function(){m.settings.gpxChartLocatorWeight=parseFloat(h(this).val()),m.setChartStyle()}),h("#gpxChartLocatorFillColor").spectrum({preferredFormat:"hex3",showInput:!0,show:function(){h(this).data("changed",!1)},move:function(e){p(e.toHexString("hex3"))},change:function(e){h(this).data("changed",!0),p(e.toHexString("hex3"))},hide:function(e){h(this).data("changed")?p(e.toHexString("hex3")):p(h(this).val())}}),h("#gpxChartLocatorFillOpacity").change(function(){m.settings.gpxChartLocatorFillOpacity=parseFloat(h(this).val()),m.setChartStyle()}),h("#addGeoJson").click(function(){h("#geoJsonModal").slideDown(500)}),h("#geoJsonCancel").click(function(){h(".mmp-json-error").remove(),h("#geoJsonText").val(""),h("#geoJsonModal").slideUp(500)}),h("#geoJsonSave").click(function(){h(".mmp-json-error").remove();var e,t=h("#geoJsonText").val(),n=m.checkJson(t);if(!1!==n){try{e=n,L.geoJSON(e,{pointToLayer:function(e,t){if(e.properties.radius)return L.circle(t,e.properties.radius)},style:function(e){for(var t=O(),n=["stroke","color","weight","opacity","lineCap","lineJoin","fill","fillColor","fillOpacity","fillRule"],i=0;i<n.length;i++){var a=n[i];void 0!==e.properties[a]&&(t[a]=e.properties[a])}return t},onEachFeature:function(e,t){var n=T(t);!1!==n&&(t.options.name=e.properties.name||mmpAdminL10n.geoJson[n.toLowerCase()],t.options.popup=e.properties.popup||"",t.addTo(m.map),t.addTo(m.geoJson[m.id]))}}),A()}catch(e){return void h('<div class="notice notice-error mmp-json-error"><p>'+mmpAdminL10n.map.invalidGeoJson+"</p></div>").prependTo("#geoJsonModal").delay(5e3).fadeOut(500,function(){h(this).remove()})}h("#geoJsonText").val(""),h("#geoJsonModal").slideUp(500)}else h('<div class="notice notice-error mmp-json-error"><p>'+mmpAdminL10n.map.invalidJson+"</p></div>").prependTo("#geoJsonModal").delay(5e3).fadeOut(500,function(){h(this).remove()})}),h("#drawStrokeColor").spectrum({preferredFormat:"hex3",showInput:!0,show:function(){h("#drawStroke").prop("checked",!0),h("#drawStroke").trigger("change")},change:function(e){h("#drawStrokeColor").val(e.toHexString("hex3")),C()}}),h("#editDrawStrokeColor").spectrum({preferredFormat:"hex3",showInput:!0,show:function(){h("#editDrawStroke").prop("checked",!0),h("#editDrawStroke").trigger("change")},move:function(e){h("#editDrawStrokeColor").val(e.toHexString("hex3")),E()},change:function(e){h("#editDrawStrokeColor").val(e.toHexString("hex3")),E()},hide:function(e){h("#editDrawStrokeColor").val(e.toHexString("hex3")),E()}}),h("#drawFillColor").spectrum({preferredFormat:"hex3",showInput:!0,show:function(){h("#drawFill").prop("checked",!0),h("#drawFill").trigger("change")},change:function(e){h("#drawFillColor").val(e.toHexString("hex3")),C()}}),h("#editDrawFillColor").spectrum({preferredFormat:"hex3",showInput:!0,show:function(){h("#editDrawFill").prop("checked",!0),h("#editDrawFill").trigger("change")},move:function(e){h("#editDrawFillColor").val(e.toHexString("hex3")),E()},change:function(e){h("#editDrawFillColor").val(e.toHexString("hex3")),E()},hide:function(e){h("#editDrawFillColor").val(e.toHexString("hex3")),E()}}),h("#drawStroke, #drawStrokeWeight, #drawStrokeOpacity, #drawLineCap, #drawLineJoin, #drawFill, #drawFillOpacity, #drawFillRule").change(function(){C()}),h("#editDrawStroke, #editDrawStrokeWeight, #editDrawStrokeOpacity, #editDrawLineCap, #editDrawLineJoin, #editDrawFill, #editDrawFillOpacity, #editDrawFillRule").change(function(){E()}),h("#editDrawCancel").click(function(){P(),h("#editShape").slideUp(500)}),h("#editDrawSave").click(function(){E();var e=m.geoJson[m.id].getLayer(h("#shapeId").val());void 0!==e&&(e.options.popup=h("#editDrawPopup").val(),m.updatePopup(e,!0)),h("#shapeBackup").val(""),h("#editShape").slideUp(500)}),h("#editDrawDelete").click(function(){P();var e=m.geoJson[m.id].getLayer(h("#shapeId").val());void 0!==e&&(h("#editShape").hide(),h("#editShape").appendTo(h("#mmp-tabDraw-settings")),m.geoJson[m.id].removeLayer(e),A())}),h(".mmp-admin-modal, .mmp-admin-modal-close").click(function(e){e.target===this&&h("#icons").hide()}),h("#geocodingProvider").change(function(){h("#address").algoliaAutocomplete("destroy"),h("#address").off("autocomplete:selected"),(e=new MmpGeocoding("map",h("#geocodingProvider").val(),mmpGeocoding,400,3)).init()}),h(".mmp-shortcode").click(function(){h(this).select()}),i(),e.init(),window.onbeforeunload=function(){return t!==h("#mapSettings").serialize()?"":null},localStorage.getItem("saved")&&(h('<div class="notice notice-success"><p>'+mmpAdminL10n.map.saved+"</p></div>").insertBefore(".mmp-main").delay(5e3).fadeOut(500,function(){h(this).remove()}),localStorage.removeItem("saved")),h("#save").prop("disabled",!1)})}function listMapsActions(){jQuery(document).ready(function(r){function o(e){r("#pagination_top button, #pagination_bottom button").prop("disabled",e),r("#page_top, #page_bottom").prop("disabled",e),r("#perpage_top, #perpage_bottom").prop("disabled",e),r("#search_top, #search_bottom").prop("disabled",e)}function s(e,t,n,i,a){r.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_map_list",nonce:r("#mapListNonce").val(),page:e,limit:t,search:n,sort:i,order:a},beforeSend:function(){o(!0),r("#bulkActionSubmit").prop("disabled",!0),r("#map_list").empty(),r("#map_list").addClass("mmp-page-loading")}}).done(function(e){r("#mapcount_top, #mapcount_bottom").html(e.total),r("#previous_top, #previous_bottom").val(e.page-1),r("#next_top, #next_bottom").val(e.page+1),r("#last_top, #last_bottom").val(Math.ceil(e.total/e.limit)),r("#page_top, #page_bottom").val(e.page),r("#pagecount_top, #pagecount_bottom").html(Math.ceil(e.total/e.limit)),r("#perpage_top, #perpage_bottom").val(e.limit),r("#search_top, #search_botom").val(e.search),r("#map_list").html(e.html),r('.mmp-sortable[data-orderby="'+e.sort+'"]').addClass("mmp-sorted-"+e.order),r("#selectAll").click(function(){r('input[name="selected[]"]').each(function(e,t){r(t).prop("checked",r("#selectAll").prop("checked"))})}),r('input[name="selected[]"]').change(function(){var n=!0;r('input[name="selected[]"]').each(function(e,t){n=n&&r(t).prop("checked")}),r("#selectAll").prop("checked",n)}),r(".mmp-sortable").click(function(e){e.preventDefault(),e.stopPropagation();var t=r("#sortorder").val(),t=r("#orderby").val()==r(this).data("orderby")&&"asc"==t?"desc":"asc";r("#sortorder").val(t),r("#orderby").val(r(this).data("orderby")),s(r("#page_top").val(),r("#perpage_top").val(),r("#search_top").val(),r("#orderby").val(),r("#sortorder").val())}),r(".mmp-table td:nth-child(3)").mouseenter(function(){r(".mmp-action",r(this)).css("visibility","visible")}),r(".mmp-table td:nth-child(3)").mouseleave(function(){r(".mmp-action",r(this)).css("visibility","hidden")}),r(".mmp-delete").click(function(e){r.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_delete_map",nonce:r("#mapListNonce").val(),con:0,id:r(this).data("id")},beforeSend:function(){o(!0),r("#bulkActionSubmit").prop("disabled",!0)}}).done(function(e){if(e.success){if(!confirm(e.data.message))return;r.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_delete_map",nonce:r("#mapListNonce").val(),con:1,id:e.data.id},beforeSend:function(){o(!0),r("#bulkActionSubmit").prop("disabled",!0)}}).done(function(e){e.success&&s(r("#page_top").val(),r("#perpage_top").val(),r("#search_top").val(),r("#orderby").val(),r("#sortorder").val())}).always(function(){o(!1),r("#bulkActionSubmit").prop("disabled",!1)})}}).always(function(){o(!1),r("#bulkActionSubmit").prop("disabled",!1)})}),r(".mmp-shortcode").click(function(){r(this).select()}),r(".mmp-qrcode-link").click(function(e){e.preventDefault(),e.stopPropagation();var t=r(this).data("id"),n=r(this).data("url"),i=r("<div></div>").qrcode({width:256,height:256,text:n}),a=r("canvas",i)[0].toDataURL("image/png"),o=r("#qrcode_"+t),s=r('<a href="'+a+'" download="qr-code-map-'+t+'.png"><img src="'+a+'" /></a>');o.html(s),r("img",o).click()})}).always(function(){o(!1),r("input[name=bulkAction]").prop("checked",!1),r("#map_list").removeClass("mmp-page-loading")})}r("input[name=bulkAction]").change(function(){r("#bulkActionSubmit").prop("disabled",!1)}),r("#pagination_top button").click(function(){s(r(this).val(),r("#perpage_top").val(),r("#search_top").val(),r("#orderby").val(),r("#sortorder").val())}),r("#pagination_bottom button").click(function(){s(r(this).val(),r("#perpage_bottom").val(),r("#search_bottom").val(),r("#orderby").val(),r("#sortorder").val())}),r("#page_top, #perpage_top").change(function(){s(r("#page_top").val(),r("#perpage_top").val(),r("#search_top").val(),r("#orderby").val(),r("#sortorder").val())}),r("#page_bottom, #perpage_bottom").change(function(){s(r("#page_bottom").val(),r("#perpage_bottom").val(),r("#search_bottom").val(),r("#orderby").val(),r("#sortorder").val())}),r("#search_top").change(function(){s(1,r("#perpage_top").val(),r(this).val(),r("#orderby").val(),r("#sortorder").val())}),r("#search_bottom").change(function(){s(1,r("#perpage_bottom").val(),r(this).val(),r("#orderby").val(),r("#sortorder").val())}),r("#mapList").submit(function(e){var t;switch(e.preventDefault(),e.stopPropagation(),r("input[name=bulkAction]:checked").val()){case"duplicate":t=mmpAdminL10n.maps.bulkDuplicate;break;case"duplicate-assign":t=mmpAdminL10n.maps.bulkDuplicateAssign;break;case"delete":t=mmpAdminL10n.maps.bulkDelete;break;case"delete-assign":t=mmpAdminL10n.maps.bulkDeleteAssign.replace("{map}",r("#assignTarget").val());break;default:return}confirm(t)&&r.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_bulk_action_maps",nonce:r("#bulkNonce").val(),data:r("#mapList").serialize()},beforeSend:function(){o(!0),r("#bulkActionSubmit").prop("disabled",!0)}}).done(function(e){s(r("#page_top").val(),r("#perpage_top").val(),r("#search_top").val(),r("#orderby").val(),r("#sortorder").val())}).always(function(){o(!1),r("input[name=bulkAction]").prop("checked",!1)})}),r("#mmp-maps-screen-options-apply").click(function(){r.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_maps_screen_options",nonce:r("#screenoptionnonce").val(),hiddenColumns:r(".mmp-maps-column").not(":checked").map(function(){return this.value}).get(),perPage:r("#mmp-maps-per-page").val()},beforeSend:function(){o(!0)}}).done(function(e){r("#show-settings-link").click(),s(r("#page_top").val(),r("#perpage_top").val(),r("#search_top").val(),r("#orderby").val(),r("#sortorder").val())}).always(function(){o(!1)})}),s()})}function editMarkerActions(){var p=this;this.currentValues,this.map,this.basemaps={},this.marker,this.icon,this.geoJson=L.geoJSON(null,{pointToLayer:function(e,t){return L.marker(t,{pmIgnore:!0,interactive:!1,icon:L.icon({iconUrl:e.properties.icon,iconSize:[32,37],iconAnchor:[17,36],popupAnchor:[-1,-32],shadowUrl:mmpAdminVars.pluginUrl+"images/leaflet/marker-shadow.png",shadowSize:[41,41],shadowAnchor:[16,43]})})}}),jQuery(document).ready(function(s){function e(e){e=e||mmpL10n.popup.info,"undefined"!=typeof switchEditors&&(e=switchEditors.wpautop(e)),p.marker.setPopupContent(e)}function t(){window.open(s("#link").val(),"_blank")}function r(){"popup"===s("input[name=action]:checked").val()?(s("#link").val(""),s("#link_settings").hide(),s("#editor").show(),void 0!==p.marker&&(p.marker.bindPopup("",p.popup),p.marker.openPopup(),p.marker.off("click",t),e(s("#popup").val()))):(s("#editor").hide(),s("#link_settings").show(),void 0!==p.marker&&(p.marker.closePopup(),p.marker.unbindPopup(),p.marker.on("click",t)))}function l(e){var t=e.lat,n=e.lng;t<-90?t=-90:90<t&&(t=90),n<-180?n=-180:180<n&&(n=180),p.marker.setLatLng([t,n]),p.map.panTo(p.marker.getLatLng()),s("#lat").val(p.marker.getLatLng().lat.toFixed(6)),s("#lng").val(p.marker.getLatLng().lng.toFixed(6))}function c(){s("#iconTarget").val(s("input[name=icon]:checked").val()),p.icon.options.iconUrl=s("input[name=icon]:checked+img").attr("src"),p.marker.setIcon(p.icon),s("#uploadFile").val(""),s("#iconSearch").val(""),s("#iconList .mmp-radio").show(),s("#icons").hide()}function n(n){var e;p.currentValues=s("#markerSettings").serialize(),p.map=L.map("maps-marker-pro-marker",{center:[n.lat,n.lng],zoom:n.zoom,minZoom:0,maxZoom:23,zoomSnap:.5,zoomDelta:.5,maxBounds:[[-90,-180],[90,180]]}),s.each(n.availableBasemaps,function(e,t){1!==t.type&&3!==t.type&&4!==t.type&&5!==t.type||(t.options.minZoom=0,t.options.maxZoom=23,t.options.noWrap=!0,t.options.bounds=[[-90,-180],[90,180]]),1==t.type?t.wms?p.basemaps[e]=L.tileLayer.wms(t.url,t.options):p.basemaps[e]=L.tileLayer(t.url,t.options):2==t.type&&n.googleApiKey?p.basemaps[e]=new L.gridLayer.googleMutant(t.options):3==t.type&&n.bingApiKey?(t.options.bingMapsKey=n.bingApiKey,t.options.culture=n.bingCulture,p.basemaps[e]=L.tileLayer.bing(t.options)):4==t.type&&(n.hereApiKey||n.hereAppId&&n.hereAppCode)?(t.options.apiKey=n.hereApiKey,t.options.appId=n.hereAppId,t.options.appCode=n.hereAppCode,p.basemaps[e]=L.tileLayer.here(t.options)):5==t.type&&n.tomApiKey&&(t.options.apiKey=n.tomApiKey,p.basemaps[e]=L.tileLayer.tomTom(t.options))}),void 0!==p.basemaps[n.basemap]?p.basemaps[n.basemap].addTo(p.map):(e=Object.keys(p.basemaps)).length&&p.basemaps[e[0]].addTo(p.map),p.geoJson.addTo(p.map),p.icon=L.icon({iconUrl:n.icon?mmpAdminVars.iconsUrl+n.icon:mmpAdminVars.pluginUrl+"images/leaflet/marker.png",iconSize:[32,37],iconAnchor:[17,36],popupAnchor:[-1,-32],shadowUrl:mmpAdminVars.pluginUrl+"images/leaflet/marker-shadow.png",shadowSize:[41,41],shadowAnchor:[16,43]}),p.popup={maxWidth:400,minWidth:200,maxHeight:400,className:"mmp-popup"},p.marker=L.marker([n.lat,n.lng],{icon:p.icon,draggable:!0}).addTo(p.map),r(),p.map.on("click",function(e){l(e.latlng)}),p.map.on("zoomend",function(){s("#zoom").val(p.map.getZoom().toFixed(1))}),p.marker.on("dragend",function(e){l(p.marker.getLatLng())});var t={enableTime:!0,time_24hr:!/a(?!\\)/i.test(mmpAdminL10n.global.timeFormat.replace(/\\\\/g,"")),altInput:!0,altFormat:(mmpAdminL10n.global.dateFormat+" "+mmpAdminL10n.global.timeFormat).replace(/G(?!\\)/g,"H").replace(/h(?!\\)/g,"G").replace(/g(?!\\)/g,"h").replace(/S(?!\\)/g,"J").replace(/s(?!\\)/g,"S").replace(/a(?!\\)/g,"K").replace(/A(?!\\)/g,"K"),dateFormat:"Y-m-d H:i:S"},i=s("#scheduleFrom").flatpickr(t),a=s("#scheduleUntil").flatpickr(t);s("#scheduleFromClear").click(function(){i.clear()}),s("#scheduleUntilClear").click(function(){a.clear()}),s("#basemap").change(function(){s.each(p.basemaps,function(e,t){t.remove()}),void 0!==p.basemaps[s(this).val()]&&p.basemaps[s(this).val()].addTo(p.map)}),s("#previewMap").change(function(){s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_preview_map_markers",id:s("#previewMap").val()},beforeSend:function(){p.geoJson.clearLayers()}}).done(function(e){e.features&&(p.geoJson.addData(e),s("#previewOpacity").trigger("input"))})}),s("#previewOpacity").on("input",L.Util.throttle(function(){var t=parseFloat(s("#previewOpacity").val());p.geoJson.eachLayer(function(e){e.setOpacity(t)})},100)),s("#lat, #lng").change(function(){var e=parseFloat(s("#lat").val()),t=parseFloat(s("#lng").val());l(L.latLng(e,t))}),s("#zoom").change(function(){p.map.setZoom(parseFloat(s("#zoom").val()))}),s("input[name=icon]").change(c),s("input[name=action]").change(r),s("#markerSettings").submit(function(e){e.preventDefault(),e.stopPropagation(),s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_save_marker",settings:s("#markerSettings").serialize()},beforeSend:function(){var e;e=s("#save"),s("#save").prop("disabled",!0),s(e).addClass("mmp-button-loading")}}).done(function(e){e.success?(p.currentValues=s("#markerSettings").serialize(),"new"==s("#id").val()?(localStorage.setItem("saved",!0),window.location.href=mmpAdminVars.adminUrl+"admin.php?page=mapsmarkerpro_marker&id="+e.response.id):s('<div class="notice notice-success"><p>'+e.response.message+"</p></div>").insertBefore(".mmp-main").delay(5e3).fadeOut(500,function(){s(this).remove()})):s('<div class="notice notice-error"><p>'+e.response+"</p></div>").insertBefore(".mmp-main").delay(5e3).fadeOut(500,function(){s(this).remove()})}).always(function(){var e;e=s("#save"),s(e).removeClass("mmp-button-loading"),s("#save").prop("disabled",!1)})}),s("#saveDefaultsLink").click(function(e){e.preventDefault(),e.stopPropagation(),s(this).hide(),s(".mmp-save-defaults").show()}),s("#saveDefaultsConfirm").click(function(e){s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_save_marker_defaults",settings:s("#markerSettings").serialize()},beforeSend:function(){s("#saveDefaultsConfirm").prop("disabled",!0),s("#saveDefaultsCancel").prop("disabled",!0),s(".mmp-save-defaults").addClass("mmp-save-defaults-loading")}}).always(function(){s(".mmp-save-defaults").removeClass("mmp-save-defaults-loading"),s(".mmp-save-defaults").fadeOut(500,function(){s("#saveDefaultsConfirm").prop("disabled",!1),s("#saveDefaultsCancel").prop("disabled",!1),s("#saveDefaultsLink").show()})})}),s("#saveDefaultsCancel").click(function(e){s(".mmp-save-defaults").hide(),s("#saveDefaultsLink").show()}),s("#assignedMaps").select2({width:"260px",placeholder:mmpAdminL10n.marker.notAssigned,templateSelection:function(e){var t=s('<a href="'+mmpAdminVars.adminUrl+"admin.php?page=mapsmarkerpro_map&id="+e.id+'" target="_blank">'+mmpAdminL10n.marker.edit+"</a>");return t.click(function(e){e.stopPropagation()}),s("<span>"+e.text+"</span>").append(" (").append(t).append(")")}}),s("#changeIcon").click(function(){s("#iconUpload").hide(),s("#icons").show()}),s("#iconSearch").keyup(function(){var e=s(this).val();s('input[name="icon"]').each(function(){-1===s(this).val().toUpperCase().indexOf(e.toUpperCase())?s(this).parent().hide():s(this).parent().show()})}),s("#toggleUpload").click(function(){s("#iconUpload").toggle()}),s("#upload").click(function(){var e,t=s("#uploadFile").prop("files")[0];void 0!==t&&((e=new FormData).append("action","mmp_icon_upload"),e.append("nonce",s("#upload_nonce").val()),e.append("upload",t),s.ajax({type:"POST",url:ajaxurl,processData:!1,contentType:!1,context:this,data:e}).done(function(e){e.success&&(s("#iconList").prepend('<label class="mmp-radio"><input type="radio" name="icon" value="'+e.response.name+'" checked="checked" /><img class="mmp-icon" src="'+e.response.url+'" /></label>'),s("input[name=icon]").change(c),s("input[name=icon]").trigger("change"))}))});var o=new MmpGeocoding("marker",s("#geocodingProvider").val(),mmpGeocoding,400,3);o.init(),s("#geocodingProvider").change(function(){s("#address").algoliaAutocomplete("destroy"),s("#address").off("autocomplete:selected"),(o=new MmpGeocoding("marker",s("#geocodingProvider").val(),mmpGeocoding,400,3)).init()}),localStorage.getItem("saved")&&(s('<div class="notice notice-success"><p>'+mmpAdminL10n.marker.saved+"</p></div>").insertBefore(".mmp-main").delay(5e3).fadeOut(500,function(){s(this).remove()}),localStorage.removeItem("saved")),s("#save").prop("disabled",!1)}s(".mmp-delete").click(function(e){confirm(mmpAdminL10n.marker.delete)&&s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_delete_marker_direct",nonce:s("#nonce").val(),id:s("#id").val()}}).done(function(e){p.currentValues=s("#markerSettings").serialize(),window.location.href=mmpAdminVars.adminUrl+"admin.php?page=mapsmarkerpro_markers"})}),s(".mmp-admin-modal, .mmp-admin-modal-close").click(function(e){e.target===this&&s("#icons").hide()}),s("#popup").change(function(){e(s(this).val())}),s("#maps-marker-pro-marker").css({width:"100%",height:"480px"}),"undefined"!=typeof tinymce&&tinymce.on("AddEditor",function(e){e.editor.on("Change",function(){s("#popup").val(this.getContent()).trigger("change")})}),s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_marker_settings",id:s("#id").val(),basemap:s("#basemap").val(),lat:s("#lat").val(),lng:s("#lng").val(),zoom:s("#zoom").val()}}).done(function(e){n(e.settings)}),window.onbeforeunload=function(){return p.currentValues!==s("#markerSettings").serialize()?"":null}})}function listMarkersActions(){jQuery(document).ready(function(s){function r(e){s("#pagination_top button, #pagination_bottom button").prop("disabled",e),s("#page_top, #page_bottom").prop("disabled",e),s("#perpage_top, #perpage_bottom").prop("disabled",e),s("#search_top, #search_bottom").prop("disabled",e),s("#map_top, #map_bottom").prop("disabled",e)}function l(e,t,n,i,a,o){s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_marker_list",nonce:s("#markerListNonce").val(),page:e,limit:t,search:n,map:i,sort:a,order:o},beforeSend:function(){r(!0),s("#bulkActionSubmit").prop("disabled",!0),s("#marker_list").empty(),s("#marker_list").addClass("mmp-page-loading")}}).done(function(e){s("#markercount_top, #markercount_bottom").html(e.total),s("#previous_top, #previous_bottom").val(e.page-1),s("#next_top, #next_bottom").val(e.page+1),s("#last_top, #last_bottom").val(Math.ceil(e.total/e.limit)),s("#page_top, #page_bottom").val(e.page),s("#pagecount_top, #pagecount_bottom").html(Math.ceil(e.total/e.limit)),s("#perpage_top, #perpage_bottom").val(e.limit),s("#search_top, #search_bottom").val(e.search),s("#marker_list").html(e.html),s('.mmp-sortable[data-orderby="'+e.sort+'"]').addClass("mmp-sorted-"+e.order),s("#selectAll").click(function(){s('input[name="selected[]"]').each(function(e,t){s(t).prop("checked",s("#selectAll").prop("checked"))})}),s('input[name="selected[]"]').change(function(){var n=!0;s('input[name="selected[]"]').each(function(e,t){n=n&&s(t).prop("checked")}),s("#selectAll").prop("checked",n)}),s(".mmp-sortable").click(function(e){e.preventDefault(),e.stopPropagation();var t=s("#sortorder").val(),t=s("#orderby").val()==s(this).data("orderby")&&"asc"==t?"desc":"asc";s("#sortorder").val(t),s("#orderby").val(s(this).data("orderby")),l(s("#page_top").val(),s("#perpage_top").val(),s("#search_top").val(),s("#map_top").val(),s("#orderby").val(),s("#sortorder").val())}),s(".mmp-table td:nth-child(4)").mouseenter(function(){s(".mmp-action",s(this)).css("visibility","visible")}),s(".mmp-table td:nth-child(4)").mouseleave(function(){s(".mmp-action",s(this)).css("visibility","hidden")}),s(".mmp-delete").click(function(e){var t=s(this).data("id");confirm(mmpAdminL10n.markers.delete.replace("{marker}",t))&&s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_delete_marker",nonce:s("#markerListNonce").val(),id:t},beforeSend:function(){r(!0),s("#bulkActionSubmit").prop("disabled",!0)}}).done(function(e){l(s("#page_top").val(),s("#perpage_top").val(),s("#search_top").val(),s("#map_top").val(),s("#orderby").val(),s("#sortorder").val())}).always(function(){r(!1),s("#bulkActionSubmit").prop("disabled",!1)})})}).always(function(){r(!1),s("#bulkActionSubmit").prop("disabled",!1),s("#marker_list").removeClass("mmp-page-loading")})}s("input[name=bulkAction]").change(function(){s("#bulkActionSubmit").prop("disabled",!1)}),s("#pagination_top button").click(function(){l(s(this).val(),s("#perpage_top").val(),s("#search_top").val(),s("#map_top").val(),s("#orderby").val(),s("#sortorder").val())}),s("#pagination_bottom button").click(function(){l(s(this).val(),s("#perpage_bottom").val(),s("#search_bottom").val(),s("#map_bottom").val(),s("#orderby").val(),s("#sortorder").val())}),s("#page_top, #perpage_top").change(function(){l(s("#page_top").val(),s("#perpage_top").val(),s("#search_top").val(),s("#map_top").val(),s("#orderby").val(),s("#sortorder").val())}),s("#page_bottom, #perpage_bottom").change(function(){l(s("#page_bottom").val(),s("#perpage_bottom").val(),s("#search_bottom").val(),s("#map_bottom").val(),s("#orderby").val(),s("#sortorder").val())}),s("#search_top").change(function(){l(1,s("#perpage_top").val(),s(this).val(),s("#map_top").val(),s("#orderby").val(),s("#sortorder").val())}),s("#search_bottom").change(function(){l(1,s("#perpage_bottom").val(),s(this).val(),s("#map_bottom").val(),s("#orderby").val(),s("#sortorder").val())}),s("#map_top").select2({width:"200px"}).on("select2:select",function(){s("#map_bottom").select2("val",s("#map_top").val()),l(s("#page_top").val(),s("#perpage_top").val(),s("#search_top").val(),s(this).val(),s("#orderby").val(),s("#sortorder").val())}),s("#map_bottom").select2({width:"200px"}).on("select2:select",function(){s("#map_top").select2("val",s("#map_bottom").val()),l(s("#page_bottom").val(),s("#perpage_bottom").val(),s("#search_bottom").val(),s(this).val(),s("#orderby").val(),s("#sortorder").val())}),s("#markerList").submit(function(e){var t;switch(e.preventDefault(),e.stopPropagation(),s("input[name=bulkAction]:checked").val()){case"duplicate":t=mmpAdminL10n.markers.bulkDuplicate;break;case"delete":t=mmpAdminL10n.markers.bulkDelete;break;case"assign":t=mmpAdminL10n.markers.bulkAssign.replace("{map}",s("#assignTarget").val());break;default:return}confirm(t)&&s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_bulk_action_markers",nonce:s("#bulkNonce").val(),data:s("#markerList").serialize()},beforeSend:function(){r(!0),s("#bulkActionSubmit").prop("disabled",!0)}}).done(function(e){l(s("#page_top").val(),s("#perpage_top").val(),s("#search_top").val(),s("#map_top").val(),s("#orderby").val(),s("#sortorder").val())}).always(function(){r(!1),s("#bulkActionSubmit").prop("disabled",!1)})}),s("#mmp-markers-screen-options-apply").click(function(){s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_markers_screen_options",nonce:s("#screenoptionnonce").val(),hiddenColumns:s(".mmp-markers-column").not(":checked").map(function(){return this.value}).get(),perPage:s("#mmp-markers-per-page").val()},beforeSend:function(){r(!0)}}).done(function(e){s("#show-settings-link").click(),l(s("#page_top").val(),s("#perpage_top").val(),s("#search_top").val(),s("#map_top").val(),s("#orderby").val(),s("#sortorder").val())}).always(function(){r(!1)})}),l()})}function settingsActions(){jQuery(document).ready(function(s){var e=document.location.toString().split("#")[1],i=s("#settings").serialize(),a={},t=[];function n(e){s(".mmp-settings-tab").hide(),s(".mmp-tablink").removeClass("active"),s("#"+e+"_link").addClass("active"),s("#"+e+"_tab").show(),window.location.hash=e}function o(e){s(e).prop("disabled",!0),s(e).addClass("mmp-button-loading")}function r(e){s(e).removeClass("mmp-button-loading"),s(e).prop("disabled",!1)}function l(){s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_get_custom_layers",nonce:s("input[name=nonce]").val()}}).done(function(e){t=e;var a=s("<ul></ul>"),o=s("<ul></ul>");s.each(t,function(e,t){var n=s("<li></li>"),i=s('<img src="'+mmpAdminVars.pluginUrl+'images/icons/edit-layer.png" />');i.css("margin","0 10px 0 0"),i.css("verticalAlign","middle"),i.css("cursor","pointer"),i.click(function(){var e;e=t.id,s("#customLayerId").val(e),c()}),n.append(i),n.append("[ID "+t.id+"] "+t.name),"1"==t.overlay?o.append(n):a.append(n)}),s("#custom-basemaps").html(a),s("#custom-overlays").html(o)})}function c(){var n=s("#customLayerId").val(),i={},a={};"0"!=n&&(s.each(t,function(e,t){if(t.id==n)return i=t,a=JSON.parse(t.options),!1}),"1"==i.overlay?s("#customLayerTypeOverlay").prop("checked",!0):s("#customLayerTypeBasemap").prop("checked",!0),s("#customLayerWms").prop("checked","1"==i.wms),s("#customLayerTms").prop("checked",a.tms),s("#customLayerRasterTiles").prop("checked",a.rasterTiles),s("#customLayerNoWrap").prop("checked",a.noWrap),s("#customLayerErrorTiles").prop("checked",a.errorTiles),s("#customLayerName").val(i.name),s("#customLayerUrl").val(i.url),s("#customLayerSubdomains").val(a.subdomains),s("#customLayerBounds").val(a.bounds),s("#customLayerMinZoom").val(a.minNativeZoom),s("#customLayerMaxZoom").val(a.maxNativeZoom),s("#customLayerOpacity").val(a.opacity),s("#customLayerAttribution").val(a.attribution),"1"==i.wms&&(s("#custom-layer-wms").show(),s("#customLayerTransparent").prop("checked",a.transparent),s("#customLayerUppercase").prop("checked",a.uppercase),s("#customLayerLayers").val(a.layers),s("#customLayerStyles").val(a.styles),s("#customLayerFormat").val(a.format),s("#customLayerVersion").val(a.version))),s("#mmp-custom-layer-modal").show()}s(".mmp-tablink").click(function(){n(s(this).attr("id").replace("_link",""))}),s(".mmp-settings-nav ul li").each(function(){var e=s(this).closest(".mmp-settings-nav-group").find("span").html(),t=s(this).attr("id").replace("_link",""),n=s(this).html(),i=n;s("#"+t+"_tab").find("h3, p, .mmp-settings-desc, .mmp-settings-footnote").each(function(){i=i+" "+s(this).html()}),i=i.replace(/"/g,""),void 0===a[e]&&(a[e]=[]),a[e].push({value:t,search:i,title:n})}),s("#mmp-custom-layer-add").click(function(){s("#customLayerId").val("0"),c()}),s("#customLayerWms").change(function(){s(this).attr("checked")?s("#custom-layer-wms").show():s("#custom-layer-wms").hide()}),s("#settings").submit(function(e){e.preventDefault(),e.stopPropagation();var n=s("#settings").serialize();s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_save_settings",settings:n},beforeSend:function(){o(s("#save"))}}).done(function(e){i=n;var t=e.success?"notice-success":"notice-error";s('<div class="notice '+t+'"><p>'+e.response+"</p></div>").insertBefore("#settings").delay(5e3).fadeOut(500,function(){s(this).remove()}),e.flush&&function(){s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_flush_rewrite_rules",nonce:s("input[name=nonce]").val()}})}()}).fail(function(){s('<div class="notice notice-error"><p>'+mmpAdminL10n.global.ajaxError+"</p></div>").insertBefore("#settings").delay(5e3).fadeOut(500,function(){s(this).remove()})}).always(function(){r(s("#save"))})});var p=s("<select></select>").attr("id","mmp-select-search-tabs").css("width","300px").append("<option></option>");s.each(a,function(e,t){var i=s("<optgroup></optgroup>");i.attr("label",e),s.each(t,function(e,t){var n=s("<option></option>").attr("value",t.value).attr("data-search",t.search).html(t.title);i.append(n)}),p.append(i)}),p.appendTo("#top"),p.select2({placeholder:mmpAdminL10n.settings.search,allowClear:!0,matcher:function(n,e){if(""===s.trim(n.term))return e;if(void 0===e.text||void 0===e.children)return null;var i=[];if(s.each(e.children,function(e,t){-1===t.text.toUpperCase().indexOf(n.term.toUpperCase())&&-1===s(t.element).data("search").toUpperCase().indexOf(n.term.toUpperCase())||i.push(t)}),i.length){var t=s.extend({},e,!0);return t.children=i,t}return null}}).change(function(){n(s(this).val())}),s(".mmp-admin-modal, .mmp-admin-modal-close").click(function(e){e.target===this&&(s("#mmp-custom-layer-modal").hide(),s("#mmp-custom-layer-form").trigger("reset"),s("#custom-layer-wms").hide())}),s("#mmp-custom-layer-delete").click(function(){s("#mmp-custom-layer-modal").hide(),s("#mmp-custom-layer-form").trigger("reset"),s("#custom-layer-wms").hide(),function(e){s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_delete_custom_layer",nonce:s("input[name=nonce]").val(),id:e}}).done(function(e){l()})}(s("#customLayerId").val())}),s("#mmp-custom-layer-save").click(function(){s.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_save_custom_layer",nonce:s("input[name=nonce]").val(),settings:s("#mmp-custom-layer-form").serialize()},beforeSend:function(){o(s("#mmp-custom-layer-save"))}}).done(function(e){s("#mmp-custom-layer-modal").hide(),s("#mmp-custom-layer-form").trigger("reset"),s("#custom-layer-wms").hide(),l()}).always(function(){r(s("#mmp-custom-layer-save"))})}),n(void 0!==e?e:s(".mmp-tablink").first().attr("id").replace("_link","")),l(),window.onbeforeunload=function(){return i!==s("#settings").serialize()?"":null},s("#save").prop("disabled",!1)})}function toolsActions(){jQuery(document).ready(function(d){var e=document.location.toString().split("#")[1],i=0;function n(e){d(".mmp-tools-tab").hide(),d(".mmp-tablink").removeClass("active"),d("#"+e+"_tab").addClass("active"),d("#"+e+"_tab_content").show(),window.location.hash=e}function a(e){d(e).prop("disabled",!0),d(e).addClass("mmp-button-loading")}function o(e){d(e).removeClass("mmp-button-loading"),d(e).prop("disabled",!1)}function s(e){d("#backup_log").append('<span class="mmp-error">error ('+e.status+" - "+e.statusText+")</span>")}function t(e,t,n){var i=e?"notice-success":"notice-error";n.after('<div class="notice '+i+'"><p>'+t+"</p></div>")}function c(){var t=[];d(".mmp-basemap").each(function(){t.push(d(this).data("id").toString())}),d("#basemapsList option").each(function(){var e=-1!==d.inArray(d(this).val().toString(),t);d(this).prop("disabled",e)}),d("#basemapsList option").each(function(){if(!d(this).prop("disabled"))return d(this).prop("selected",!0),!1}),d("#basemapsList option:enabled").length?d("#basemapsAdd").prop("disabled",!1):d("#basemapsAdd").prop("disabled",!0),d("input[name=basemapDefault]:checked").length||d("input[name=basemapDefault]").first().prop("checked",!0)}function p(){var t=[];d(".mmp-overlay").each(function(){t.push(d(this).data("id").toString())}),d("#overlaysList option").each(function(){var e=-1!==d.inArray(d(this).val().toString(),t);d(this).prop("disabled",e)}),d("#overlaysList option").each(function(){if(!d(this).prop("disabled"))return d(this).prop("selected",!0),!1}),d("#overlaysList option:enabled").length?d("#overlaysAdd").prop("disabled",!1):d("#overlaysAdd").prop("disabled",!0)}function r(e){for(var t=0;t<e.log.length;t++)d("#backup_log").append(e.log[t]+"<br />");e.offset+1e3<e.total[e.table]?(i+=1e3,e.offset+=1e3):(i+=e.total[e.table]-e.offset,e.table++,e.offset=0);for(var n=0,t=0;t<e.total.length;t++)n+=e.total[t];return percent=(i/n*100).toFixed(0),d("#backup_progress").css("width",percent+"%"),e}function l(e){var n=d("#move_markers_source"),i=n.val(),a=d("#move_markers_target"),o=a.val(),s=d("#remove_markers_map"),r=s.val(),l=d("#assign_markers_map"),c=l.val(),p=d("#assign_map"),u=p.val();n.empty(),a.empty(),s.empty(),l.empty(),p.empty(),d.each(e,function(e,t){n.append(d("<option></option>").attr("value",e).text(t).prop("selected",e==i)),a.append(d("<option></option>").attr("value",e).text(t).prop("selected",e==o)),s.append(d("<option></option>").attr("value",e).text(t).prop("selected",e==r)),l.append(d("<option></option>").attr("value",e).text(t).prop("selected",e==c)),p.append(d("<option></option>").attr("value",e).text(t).prop("selected",e==u))})}d(".mmp-tablink").click(function(){n(d(this).attr("id").replace("_tab",""))}),d(".mmp-batch-settings-tablink").click(function(){var e=d(this).data("target");d(".mmp-map-batch-settings-group").hide(),d(".mmp-batch-settings-tablink").removeClass("active"),d(this).addClass("active"),d("#"+e+"Content").show()}),d(".batch-settings-check").change(function(){d(this).prop("checked")?d(this).closest(".mmp-map-batch-setting").addClass("mmp-changed"):d(this).closest(".mmp-map-batch-setting").removeClass("mmp-changed"),d(".mmp-batch-settings-tablink").each(function(){var e=d(this).data("target");d(".batch-settings-check:checked",d("#"+e+"Content")).length?d(this).addClass("mmp-changed"):d(this).removeClass("mmp-changed")})}),d(".mmp-gpx-start-icon").click(function(){d("#gpxIconTarget").val("gpx-start"),d("#iconsGpx").show()}),d(".mmp-gpx-end-icon").click(function(){d("#gpxIconTarget").val("gpx-end"),d("#iconsGpx").show()}),d("#iconsListGpx img").click(function(){var e=d("#gpxIconTarget").val(),t=d(this).attr("src"),n=d(this).data("icon");"gpx-start"===e?(d("#gpxStartIcon").val(n),d(".mmp-gpx-start-icon").attr("src",t)):"gpx-end"===e&&(d("#gpxEndIcon").val(n),d(".mmp-gpx-end-icon").attr("src",t)),d("#iconsGpx").hide()}),d("#batch_settings_maps").select2({width:"400px"}),d("#save_batch_settings").click(function(){confirm(mmpAdminL10n.tools.batchSettings)&&d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_batch_settings",nonce:d(this).data("nonce"),settings:d("#mapSettings").serialize()},beforeSend:function(){a(d(this))}}).done(function(e){t(e.success,e.message,d("#batch_settings_section"))}).fail(function(){t(!1,mmpAdminL10n.global.ajaxError,d("#batch_settings_section"))}).always(function(){o(d(this))})}),d("#basemapList").sortable({handle:".mmp-handle"}),d("#basemapsAdd").click(function(){!function(e,t){var n=d('<li class="mmp-basemap" data-id="'+e+'"></li>'),i=d("<div></div>");n.append(i);var a=d('<input type="hidden" name="basemaps[]" value="'+e+'" />');i.append(a);var o=d('<img class="mmp-handle mmp-align-middle" src="'+mmpAdminVars.pluginUrl+'images/icons/handle.png" />');i.append(o);var s=d('<input type="radio" name="basemapDefault" value="'+e+'" />');i.append(" ").append(s);var r=d('<input type="text" class="mmp-align-middle" value="'+t+'" disabled="disabled" />');i.append(" ").append(r);var l=d('<i class="dashicons dashicons-no mmp-remove-basemap"></i>');l.click(function(){d(this).parent().parent().remove(),c()}),i.append(" ").append(l),d("#basemapList").append(n)}(d("#basemapsList").val(),d("#basemapsList option:checked").text()),c()}),d(".mmp-remove-basemap").click(function(){d(this).parent().parent().remove(),c()}),c(),d("#overlayList").sortable({handle:".mmp-handle"}),d("#overlaysAdd").click(function(){!function(e,t){var n=d('<li class="mmp-overlay" data-id="'+e+'"></li>'),i=d("<div></div>");n.append(i);var a=d('<input type="hidden" name="overlays[]" value="'+e+'" />');i.append(a);var o=d('<img class="mmp-handle mmp-align-middle" src="'+mmpAdminVars.pluginUrl+'images/icons/handle.png" />');i.append(o);var s=d('<input type="checkbox" name="overlaysActive[]" value="'+e+'" />');i.append(" ").append(s);var r=d('<input type="text" class="mmp-align-middle" value="'+t+'" disabled="disabled" />');i.append(" ").append(r);var l=d('<i class="dashicons dashicons-no mmp-remove-overlay"></i>');l.click(function(){d(this).parent().parent().remove(),p()}),i.append(" ").append(l),d("#overlayList").append(n)}(d("#overlaysList").val(),d("#overlaysList option:checked").text()),p()}),d(".mmp-remove-overlay").click(function(){d(this).parent().parent().remove(),p()}),p(),d("#batch_layers_maps").select2({width:"400px"}),d("#save_batch_layers").click(function(){confirm(mmpAdminL10n.tools.batchLayers)&&d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_batch_layers",nonce:d(this).data("nonce"),settings:d("#mapLayers").serialize()},beforeSend:function(){a(d(this))}}).done(function(e){t(e.success,e.message,d("#batch_layers_section"))}).fail(function(){t(!1,mmpAdminL10n.global.ajaxError,d("#batch_layers_section"))}).always(function(){o(d(this))})}),d("#sourceIcon").click(function(){d("#replaceIcon").val("0"),d("#icons").show()}),d("#targetIcon").click(function(){d("#replaceIcon").val("1"),d("#icons").show()}),d("#iconsList img").click(function(){var e="0"==d("#replaceIcon").val()?"#sourceIcon":"#targetIcon",t=d(this).attr("src");d(e).attr("src",t),d("#icons").hide()}),d("#replace_icon").click(function(){confirm(mmpAdminL10n.tools.replaceIcon)&&d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_replace_icon",nonce:d(this).data("nonce"),source:d("#sourceIcon").attr("src"),target:d("#targetIcon").attr("src")},beforeSend:function(){a(d(this))}}).done(function(e){t(e.success,e.message,d("#replace_icon_section"))}).fail(function(){t(!1,mmpAdminL10n.global.ajaxError,d("#replace_icon_section"))}).always(function(){o(d(this))})}),d("#backup_file").change(function(){var e,t;i=0,d("#backup_log").empty(),d("#backup_progress").css("width","0"),this.files.length?(e=(this.files[0].size/1024/1024).toFixed(2)+" MiB",t=d("#backup_max_size").val()/1024/1024+" MiB",d("#backup_log").append(mmpAdminL10n.tools.maxFileSize.replace("{maxFileSize}",t)+"<br />"),t<=0||this.files[0].size<=d("#backup_max_size").val()?(d("#backup_log").append('<span style="color:green;">'+mmpAdminL10n.tools.chosenFileSizeGood.replace("{chosenFileSize}",e)+"</span><br />"),d("#backup_start").prop("disabled",!0),d("#restore_start").prop("disabled",!1)):d("#backup_log").append('<span style="color:red;">'+mmpAdminL10n.tools.chosenFileSizeBad.replace("{chosenFileSize}",e)+"</span><br />")):(d("#restore_start").prop("disabled",!0),d("#backup_start").prop("disabled",!1))}),d("#backup_start").click(function(){i=0,d("#backup_start").prop("disabled",!0),d("#restore_start").prop("disabled",!0),d("#backup_start").addClass("mmp-button-loading"),function t(e,n,i,a){d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_backup",nonce:d("#backup_start").data("nonce"),table:e,offset:n,total:JSON.stringify(i),filename:a||0}}).done(function(e){3<(e=r(e)).table?(d("#backup_log").append(e.message),d("#backup_start").removeClass("mmp-button-loading"),window.location=e.url):t(e.table,e.offset,e.total,e.filename)}).fail(function(e){s(e)})}(0,0,[],!1)}),d("#restore_start").click(function(){i=0,d("#restore_start").prop("disabled",!0),d("#backup_start").prop("disabled",!0),d("#restore_start").addClass("mmp-button-loading"),function t(e,n,i){var a=new FormData;if(a.append("action","mmp_restore"),a.append("nonce",d("#restore_start").data("nonce")),a.append("table",e),a.append("offset",n),a.append("total",i),!i.length){var o=d("#backup_file").prop("files")[0];if(void 0===o)return void d("#restore_start").removeClass("mmp-button-loading");a.append("upload",o)}d.ajax({type:"POST",url:ajaxurl,context:this,data:a,processData:!1,contentType:!1}).done(function(e){3<(e=r(e)).table?(l(e.maps),d("#backup_log").append(e.message),d("#restore_start").removeClass("mmp-button-loading")):t(e.table,e.offset,e.total)}).fail(function(e){s(e)})}(0,0,[])}),d("#settings").click(function(){d(this).select()}),d("#update_settings").click(function(){d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_update_settings",nonce:d(this).data("nonce"),settings:d("#settings").val()},beforeSend:function(){a(d(this))}}).done(function(e){t(e.success,e.message,d("#update_settings_section"))}).fail(function(){t(!1,mmpAdminL10n.global.ajaxError,d("#update_settings_section"))}).always(function(){o(d(this))})}),d("#move_markers").click(function(){d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_move_markers",nonce:d(this).data("nonce"),source:d("#move_markers_source").val(),target:d("#move_markers_target").val()},beforeSend:function(){a(d(this))}}).done(function(e){e.success&&l(e.maps),t(e.success,e.message,d("#move_markers_section"))}).fail(function(){t(!1,mmpAdminL10n.global.ajaxError,d("#move_markers_section"))}).always(function(){o(d(this))})}),d("#remove_markers").click(function(){d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_remove_markers",nonce:d(this).data("nonce"),map:d("#remove_markers_map").val()},beforeSend:function(){a(d(this))}}).done(function(e){e.success&&l(e.maps),t(e.success,e.message,d("#remove_markers_section"))}).fail(function(){t(!1,mmpAdminL10n.global.ajaxError,d("#remove_markers_section"))}).always(function(){o(d(this))})}),d("#assign_markers").click(function(){d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_assign_markers",nonce:d(this).data("nonce"),map:d("#assign_markers_map").val()},beforeSend:function(){a(d(this))}}).done(function(e){e.success&&l(e.maps),t(e.success,e.message,d("#assign_markers_section"))}).fail(function(){t(!1,mmpAdminL10n.global.ajaxError,d("#assign_markers_section"))}).always(function(){o(d(this))})}),d("#register_strings").click(function(){d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_register_strings",nonce:d(this).data("nonce")},beforeSend:function(){a(d(this))}}).done(function(e){t(e.success,e.message,d("#register_strings_section"))}).fail(function(){t(!1,mmpAdminL10n.global.ajaxError,d("#register_strings_section"))}).always(function(){o(d(this))})}),d("input[name=test_mode]").change(function(){"on"===d(this).val()?(d("#test_mode_wrap").attr("class","mmp-test-mode-on"),d("#test_mode_status").html(mmpAdminL10n.tools.testModeOn)):(d("#test_mode_wrap").attr("class","mmp-test-mode-off"),d("#test_mode_status").html(mmpAdminL10n.tools.testModeOff))}),d("#import_file").change(function(){var e;d("#import_start").prop("disabled",!0),this.files.length?((this.files[0].size/1024/1024).toFixed(2),(e=d("#import_max_size").val())<=0||this.files[0].size<=e?(d("#import_filesize_error").hide(),d("#import_start").prop("disabled",!1)):d("#import_filesize_error").show()):d("#import_filesize_error").hide()}),d("#import_form").submit(function(e){e.preventDefault(),e.stopPropagation();var t=new FormData(this);d.ajax({type:"POST",url:ajaxurl,context:this,data:t,processData:!1,contentType:!1,beforeSend:function(){a(d("#import_start")),d("#import_log").empty()}}).done(function(e){e.success?(d("#import_log").append(e.summary+"<br />"),d.each(e.details,function(e,t){d("#import_log").append("["+(e+1)+"] "+t.message+"<br />")}),l(e.maps)):d("#import_log").append(e.message)}).fail(function(){d("#import_log").append("Failed to send request")}).always(function(){o(d("#import_start"))})}),d("#export_include, #export_exclude").select2({width:"220px"}),d("#export_form").submit(function(e){e.preventDefault(),e.stopPropagation(),d.ajax({type:"POST",url:ajaxurl,context:this,data:d(this).serialize(),beforeSend:function(){a(d("#export_start")),d("#export_log").empty()}}).done(function(e){e.success?(d("#export_log").append(e.response.message),window.location.href=e.response.url):d("#export_log").append(e.response)}).fail(function(){d("#export_log").append(mmpAdminL10n.global.ajaxError)}).always(function(){o(d("#export_start"))})}),d("#start_health_check").click(function(){d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_health_check",nonce:d(this).data("nonce")},beforeSend:function(){a(d(this))}}).done(function(e){e.success?d("#health_check_result").html(e.response):t(!1,e.message,d("#health_section"))}).fail(function(){t(!1,mmpAdminL10n.global.ajaxError,d("#health_section"))}).always(function(){o(d(this))})}),d("#reset_database_confirm").change(function(){d(this).prop("checked")?d("#reset_database").prop("disabled",!1):d("#reset_database").prop("disabled",!0)}),d("#reset_database").click(function(){d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_reset_database",nonce:d(this).data("nonce"),confirm:d("#reset_database_confirm").prop("checked")},beforeSend:function(){a(d(this))}}).done(function(e){e.success&&l(e.maps),t(e.success,e.message,d("#reset_database_section"))}).fail(function(){t(!1,mmpAdminL10n.global.ajaxError,d("#reset_database_section"))}).always(function(){o(d(this))})}),d("#reset_settings_confirm").change(function(){d(this).prop("checked")?d("#reset_settings").prop("disabled",!1):d("#reset_settings").prop("disabled",!0)}),d("#reset_settings").click(function(){d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_reset_settings",nonce:d(this).data("nonce"),confirm:d("#reset_settings_confirm").prop("checked"),reset:{plugin:d("#reset_plugin_settings").prop("checked"),map:d("#reset_map_settings").prop("checked"),marker:d("#reset_marker_settings").prop("checked")}},beforeSend:function(){a(d(this))}}).done(function(e){t(e.success,e.message,d("#reset_settings_section"))}).fail(function(){t(!1,mmpAdminL10n.global.ajaxError,d("#reset_settings_section"))}).always(function(){o(d(this))})}),d("#data_migration_check").click(function(){d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_check_migration",nonce:d(this).data("nonce")},beforeSend:function(){d(this).prop("disabled",!0),d(this).addClass("mmp-button-loading")}}).done(function(e){d("#migration_log").html(e.log),d(".mmp-migration-shortcode").click(function(){d(this).select()}),d("#data_migration_start").prop("disabled",!1)}).fail(function(){t(!1,mmpAdminL10n.global.ajaxError,d("#data_migration"))}).always(function(){d(this).removeClass("mmp-button-loading")})}),d("#data_migration_start").click(function(){d.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_data_migration",nonce:d(this).data("nonce")},beforeSend:function(){d(this).prop("disabled",!0),d(this).addClass("mmp-button-loading")}}).done(function(e){t(e.success,e.message,d("#data_migration"))}).fail(function(){t(!1,mmpAdminL10n.global.ajaxError,d("#data_migration"))}).always(function(){d(this).removeClass("mmp-button-loading")})}),d(".mmp-admin-modal, .mmp-admin-modal-close").click(function(e){e.target===this&&(d("#icons").hide(),d("#iconsGpx").hide())}),d(window).on("hashchange",function(e){var t=document.location.toString().split("#")[1];void 0!==t&&n(t)}),n(void 0!==e?e:d(".mmp-tablink").first().attr("id").replace("_tab","")),d(".mmp-batch-settings-tablink").first().trigger("click")})}function licenseActions(){jQuery(document).ready(function(n){function e(e){n(".mmp-license-error").remove(),n(".mmp-license-section button").prop("disabled",!0),n(e).addClass("mmp-button-loading")}function t(e){n(e).removeClass("mmp-button-loading"),n(".mmp-license-section button").prop("disabled",!1)}function i(e,t){n(e).closest(".mmp-license-section").after('<div class="notice notice-error mmp-license-error"><p>'+t+"</p></div>")}n("#update_license").click(function(){n.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_update_license",nonce:n(this).data("nonce"),key:n("#license_key").val(),multisite:n("#distribute_multisite").prop("checked")?1:0},beforeSend:function(){e(this)}}).done(function(e){e.success?location.reload():i(this,e.response)}).fail(function(){i(this,mmpAdminL10n.global.ajaxError)}).always(function(){t(this)})}),n("#personal_trial_submit").click(function(){n.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_register_personal_trial",nonce:n(this).data("nonce"),first_name:n("#personal_trial_first_name").val(),last_name:n("#personal_trial_last_name").val(),email:n("#personal_trial_email").val(),tos:n("#personal_trial_tos").prop("checked")?1:0},beforeSend:function(){e(this)}}).done(function(e){e.success?location.reload():i(this,e.response)}).fail(function(){i(this,mmpAdminL10n.global.ajaxError)}).always(function(){t(this)})}),n("#anonymous_trial_show").click(function(e){e.preventDefault(),e.stopPropagation(),n(this).remove(),n("#anonymous_trial").removeClass("mmp-hidden")}),n("#anonymous_trial_submit").click(function(){n.ajax({type:"POST",url:ajaxurl,context:this,data:{action:"mmp_register_anonymous_trial",nonce:n(this).data("nonce"),tos:n("#anonymous_trial_tos").prop("checked")?1:0},beforeSend:function(){e(this)}}).done(function(e){e.success?location.reload():i(this,e.response)}).fail(function(){i(this,mmpAdminL10n.global.ajaxError)}).always(function(){t(this)})})})}function MmpGeocoding(e,t,n,i,a){var h=this;this.type=e,this.provider=t,this.options=n,this.typinginterval=i,this.minChars=a,this.providers={algolia:{resultsKey:"hits",geoKey:"_geoloc",footer:h.options.algolia.footer,getUrl:function(){var e=h.options[h.provider],t="https://places-dsn.algolia.net/1/places/query?query={query}&hitsPerPage=10";return e.appId&&(t+="&x-algolia-application-id="+e.appId),e.apiKey&&(t+="&x-algolia-api-key="+e.apiKey),t+="&language="+e.language,e.countries&&(t+="&countries="+e.countries),t+="&aroundLatLngViaIP="+(e.aroundLatLngViaIP?"true":"false"),e.aroundLatLng&&(t+="&aroundLatLng="+e.aroundLatLng),t},format:function(e){var t=h.options[h.provider].language,n=e.administrative,i=e.city,a=e.country,o="";void 0!==e._highlightResult.locale_names[t]&&e._highlightResult.locale_names[t].length?o=e._highlightResult.locale_names[t][0].value:void 0!==e._highlightResult.locale_names&&e._highlightResult.locale_names.length&&(o=e._highlightResult.locale_names[0].value),i=i?e._highlightResult.city[0].value:null,n=n&&void 0!==e._highlightResult.administrative?e._highlightResult.administrative[0].value:null,a=a?e._highlightResult.country.value:null;var s=e._tags,r=h.getUnifiedType(["country","city","address"],s),l=r.charAt(0).toUpperCase()+r.slice(1);return'<span class="ap-suggestion-icon ap-'+r+'" title="'+l+'"></span><span class="ap-name">'+o+'</span><span class="ap-address">'+((n?", "+n:"")+(i?", "+i:"")+(a?", "+a:""))+"</span>"},beforeSend:function(e){jQuery("#geocodingError").empty();var t=h.options[h.provider];t.appId&&t.apiKey&&(e.setRequestHeader("X-Algolia-Application-Id",t.appId),e.setRequestHeader("X-Algolia-API-Key",t.apiKey))},displayError:function(e,t){200!==t.status&&(jQuery("#address").css("background","#ffc"),jQuery("#geocodingError").html("Algolia Places error "+e.status+": "+e.message))}},photon:{resultsKey:"features",geoKey:"geometry.coordinates",footer:h.options.photon.footer,getUrl:function(){var e=h.options[h.provider],t="https://photon.mapsmarker.com/pro/api?q={query}&limit=10";return e.language&&(t+="&lang="+e.language),e.locationbiaslat&&(t+="&lat="+e.locationbiaslat),e.locationbiaslon&&(t+="&lon="+e.locationbiaslon),e.bounds&&(t+="&bbox="+[e.lon1,e.lat1,e.lon2,e.lat2].join(",")),e.filter&&(t+="&osm_tag="+e.filter),t},format:function(e,t){var n=e.properties.country,i=e.properties.city,a=e.properties.housenumber,o=e.properties.street,s=e.properties.postcode,r=e.properties.state,l=void 0!==e.properties.name?e.properties.name.replace(t,"<em>"+t+"</em>"):"",c=(c=(o?", "+o+(a?" "+a:""):"")+(s?" "+s:"")+(i?", "+i:"")+(r?", "+r:"")+(n?", "+n:"")).replace(t,"<em>"+t+"</em>"),p=e.properties.osm_value,u=h.getUnifiedType(["country","state","city","address"],p),d=u.charAt(0).toUpperCase()+u.slice(1);return'<span class="ap-suggestion-icon ap-'+u+'" title="'+d+'"></span><span class="ap-name">'+l+'</span><span class="ap-address">'+c+"</span>"},displayError:function(e,t){var n=JSON.parse(t.responseText);200!=t.status&&(jQuery("#address").css("background","#ffc"),jQuery("#geocodingError").html("Photon@MapsMarker error: "+n.message))}},locationiq:{resultsKey:null,geoKey:null,footer:h.options.locationiq.footer,getUrl:function(){var e=h.options[h.provider],t="https://api.locationiq.com/v1/autocomplete.php?q={query}&normalizecity=1&limit=10";return e.apiKey&&(t+="&key="+e.apiKey),e.bounds&&(t+="&viewbox="+[e.lon1,e.lat1,e.lon2,e.lat2].join(",")),t+="&accept-language="+e.language},format:function(e,t){var n=e.address.country,i=e.address.city,a=e.address.housenumber,o=e.address.road,s=e.address.postcode,r=e.address.state,l=void 0!==e.address.name?e.address.name.replace(t,"<em>"+t+"</em>"):"",c=(c=(o?", "+o+(a?" "+a:""):"")+(s?" "+s:"")+(i?", "+i:"")+(r?", "+r:"")+(n?", "+n:"")).replace(t,"<em>"+t+"</em>"),p=e.type.toLowerCase(),u=h.getUnifiedType(["country","state","city","address"],p),d=u.charAt(0).toUpperCase()+u.slice(1);return'<span class="ap-suggestion-icon ap-'+u+'" title="'+d+'"></span><span class="ap-name">'+l+'</span><span class="ap-address">'+c+"</span>"},displayError:function(e,t){200!==t.status&&(jQuery("#address").css("background","#ffc"),jQuery("#geocodingError").html("LocationIQ error "+e.status+": "+e.message))}},mapquest:{resultsKey:"results.locations",geoKey:"latLng",footer:h.options.mapquest.footer,getUrl:function(){var e=h.options[h.provider],t="https://www.mapquestapi.com/geocoding/v1/address?location={query}&maxResults=10";return e.api_key&&(t+="&key="+e.api_key),e.boundingBox&&(t+="&boundingBox="+[e.lat1,e.lon1,e.lat2,e.lon2].join(",")),t},format:function(e,t){var n="";n+=void 0!==e.street&&e.street?e.street+", ":"",n+=void 0!==e.adminArea5&&e.adminArea5?e.adminArea5+", ":"",n+=void 0!==e.adminArea4&&e.adminArea4?e.adminArea4+", ":"",n+=void 0!==e.adminArea3&&e.adminArea3?e.adminArea3+", ":"",n+=void 0!==e.adminArea2&&e.adminArea2?e.adminArea2+", ":"",n+=void 0!==e.adminArea1&&e.adminArea1?e.adminArea1:"";var i=e.geocodeQuality.toLowerCase(),a=h.getUnifiedType(["country","city","address"],i),o=a.charAt(0).toUpperCase()+a.slice(1);return'<span class="ap-suggestion-icon ap-'+a+'" title="'+o+'"></span><span class="ap-name">'+n.replace(t,"<em>"+t+"</em>")+"</span>"},displayError:function(e,t){200!==t.status&&(jQuery("#address").css("background","#ffc"),jQuery("#geocodingError").html("MapQuest error "+e.status+": "+e.message))}},google:{resultsKey:"results",geoKey:"geometry.location",footer:h.options.google.footer,getUrl:function(){var e=h.options[h.provider],t=mmpAdminVars.baseUrl+"index.php?mapsmarkerpro=google-places&address={query}";return e.nonce&&(t+="&nonce="+e.nonce),t},format:function(e,t){var n=e.types,i=h.getUnifiedType(["country","locality","street_address"],n),a=i.charAt(0).toUpperCase()+i.slice(1);return'<span class="ap-suggestion-icon ap-'+i+'" title="'+a+'"></span><span class="ap-name">'+e.address.replace(t,"<em>"+t+"</em>")+"</span>"},displayError:function(e){"OK"!==e.status&&"ZERO_RESULTS"!=e.status&&(jQuery("#address").css("background","#ffc"),jQuery("#geocodingError").html("Google Geocoding error: "+e.status))}},tomtom:{resultsKey:"results",geoKey:"position",footer:h.options.tomtom.footer,getUrl:function(){var e=h.options[h.provider],t="https://api.tomtom.com/search/2/geocode/{query}.JSON?limit=10";return e.apiKey&&(t+="&key="+e.apiKey),e.language&&(t+="&language="+e.language),e.countrySet&&(t+="&countrySet="+e.countrySet),e.lat&&(t+="&lat="+e.lat),e.lon&&(t+="&lon="+e.lon),e.radius&&(t+="&radius="+e.radius),t},format:function(e,t){var n=e.address.freeformAddress;n+=n!==e.address.country?", "+e.address.country:"";var i=e.type,a=(i="Geography"===i?"Municipality"===e.entityType?"city":"Country"===e.entityType?"country":"address":"address").charAt(0).toUpperCase()+i.slice(1);return'<span class="ap-suggestion-icon ap-'+i+'" title="'+a+'"></span><span class="ap-name">'+n.replace(t,"<em>"+t+"</em>")+"</span>"},displayError:function(e,t){200!==t.status&&(jQuery("#address").css("background","#ffc"),jQuery("#geocodingError").html("TomTom Geocoding error "+e.status+": "+e.message))}}},this.init=function(){jQuery("#address").algoliaAutocomplete({minLength:h.minChars,hint:!1,autoselect:!0,openOnFocus:!1,debug:!1},[{source:function(e,a){h.query=jQuery("#address").val(),jQuery.ajax({url:h.providers[h.provider].getUrl().replace("{query}",h.query),type:"GET",beforeSend:function(e){jQuery("#geocodingError").empty(),jQuery("#address").addClass("results-loading"),"function"==typeof h.providers[h.provider].beforeSend&&h.providers[h.provider].beforeSend(e)}}).done(function(n,e,t){var i;"GOOGLE_ERROR"===n.status?(jQuery("#geocodingError").html("Google Geocoding error: "+n.results.status+": "+n.results.error_message),jQuery("#address").removeClass("results-loading"),jQuery("#address").css("background","#ffc")):"ZERO_RESULTS"===n.status?jQuery("#address").removeClass("results-loading"):("locationiq"===h.provider&&n.length?(jQuery.each(n,function(e,t){n[e].name=jQuery(h.providers[h.provider].format(t,h.query)).text().trim()}),a(n,n)):"mapquest"===h.provider&&n.results[0].locations.length?(jQuery.each(n.results[0].locations,function(e,t){n.results[0].locations[e].name=jQuery(h.providers[h.provider].format(t,h.query)).text().trim()}),a(n.results[0].locations,n)):n[h.providers[h.provider].resultsKey].length&&(i=h.providers[h.provider].resultsKey,jQuery.each(n[i],function(e,t){n[i][e].name=jQuery(h.providers[h.provider].format(t,h.query)).text().trim()}),a(n[i],n)),jQuery("#address").removeClass("results-loading"),"function"==typeof h.providers[h.provider].displayError&&h.providers[h.provider].displayError(n,t))}).fail(function(e){"function"==typeof h.providers[h.provider].displayError&&h.providers[h.provider].displayError(e.responseJSON,e),jQuery("#address").removeClass("results-loading"),jQuery("#address").css("background","#ffc")})},displayKey:"name",templates:{suggestion:function(e){var t=jQuery("#address").val();return h.providers[h.provider].format(e,t)},footer:h.providers[h.provider].footer,header:'<div id="geocoding-results-header-div">'+h.options.header+'</div><div id="geocoding-results-header-image-div"><img src="'+mmpAdminVars.pluginUrl+'images/geocoding/icon-key-enter.png" /></div><div style="clear:both; border-bottom:1px solid #ccc;"></div>'},debounce:h.typinginterval}]).on("autocomplete:selected",function(e,t){var n;"google"!==h.provider?"locationiq"===h.provider?h.selected(parseFloat(t.lat),parseFloat(t.lon)):-1!==(n=h.providers[h.provider].geoKey).indexOf(".")?(n=n.split("."),"photon"===h.provider?h.selected(t[n[0]][n[1]][1],t[n[0]][n[1]][0]):h.selected(t[n[0]][n[1]].lat,t[n[0]][n[1]].lng)):"tomtom"===h.provider?h.selected(t[n].lat,t[n].lon):h.selected(t[n].lat,t[n].lng):h.googleSelected(t.place_id)})},this.selected=function(e,t){"map"===h.type?(mapsMarkerPro.admin.map.panTo([e,t]),jQuery("#lat").val(e.toFixed(6)),jQuery("#lng").val(t.toFixed(6))):"marker"===h.type&&(editMarker.marker.setLatLng([e,t]),editMarker.map.panTo(editMarker.marker.getLatLng()),jQuery("#lat").val(editMarker.marker.getLatLng().lat.toFixed(6)),jQuery("#lng").val(editMarker.marker.getLatLng().lng.toFixed(6)))},this.googleSelected=function(e){var t=mmpAdminVars.baseUrl+"index.php?mapsmarkerpro=google-places&place_id={place_id}&nonce={wpnonce}";jQuery.ajax({url:t.replace("{place_id}",e).replace("{wpnonce}",h.options[h.provider].nonce),type:"GET",beforeSend:function(e){jQuery("#geocodingError").empty(),jQuery("#address").addClass("results-loading"),"function"==typeof h.providers[h.provider].beforeSend&&h.providers[h.provider].beforeSend(e)}}).done(function(e,t,n){jQuery("#address").removeClass("results-loading"),"OK"===e.status&&h.selected(e.results.geometry.location.lat,e.results.geometry.location.lng)})},this.getUnifiedType=function(e,t){for(var n=0;n<e.length;n++){var i=e[n];if(-1!==t.indexOf(i))break}switch(i){case"address":case"street_address":return"address";case"city":case"locality":case"venue":return"city";case"state":case"country":return"country";default:return"address"}}}function QR8bitByte(e){this.mode=QRMode.MODE_8BIT_BYTE,this.data=e}function QRCode(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=new Array}!function(n){var i={};function a(e){if(i[e])return i[e].exports;var t=i[e]={exports:{},id:e,loaded:!1};return n[e].call(t.exports,t,t.exports,a),t.loaded=!0,t.exports}a.m=n,a.c=i,a.p="",a(0)}([function(e,t,n){"use strict";e.exports=n(1)},function(e,t,n){"use strict";var i=n(2),o=n(3);i.element=o;var s=n(4);s.isArray=o.isArray,s.isFunction=o.isFunction,s.isObject=o.isPlainObject,s.bind=o.proxy,s.each=function(e,n){o.each(e,function(e,t){return n(t,e)})},s.map=o.map,s.mixin=o.extend,s.Event=o.Event;var r=n(5),l=n(6),a=o.fn.autocomplete,c="aaAutocomplete",p={initialize:function(i,a){return a=s.isArray(a)?a:[].slice.call(arguments,1),i=i||{},this.each(function(){var e,t=o(this),n=new l({el:t});e=new r({input:t,eventBus:n,dropdownMenuContainer:i.dropdownMenuContainer,hint:void 0===i.hint||!!i.hint,minLength:i.minLength,autoselect:i.autoselect,autoselectOnBlur:i.autoselectOnBlur,tabAutocomplete:i.tabAutocomplete,openOnFocus:i.openOnFocus,templates:i.templates,debug:i.debug,clearOnSelected:i.clearOnSelected,cssClasses:i.cssClasses,datasets:a,keyboardShortcuts:i.keyboardShortcuts,appendTo:i.appendTo,autoWidth:i.autoWidth}),t.data(c,e)})},open:function(){return this.each(function(){var e,t=o(this);(e=t.data(c))&&e.open()})},close:function(){return this.each(function(){var e,t=o(this);(e=t.data(c))&&e.close()})},val:function(n){return arguments.length?this.each(function(){var e,t=o(this);(e=t.data(c))&&e.setVal(n)}):function(e){var t,n;(t=e.data(c))&&(n=t.getVal());return n}(this.first())},destroy:function(){return this.each(function(){var e,t=o(this);(e=t.data(c))&&(e.destroy(),t.removeData(c))})}};o.fn.autocomplete=function(e){var t;return p[e]&&"initialize"!==e?(t=this.filter(function(){return!!o(this).data(c)}),p[e].apply(t,[].slice.call(arguments,1))):p.initialize.apply(this,arguments)},o.fn.autocomplete.noConflict=function(){return o.fn.autocomplete=a,this},o.fn.autocomplete.sources=r.sources,o.fn.autocomplete.escapeHighlightedString=s.escapeHighlightedString,e.exports=o.fn.autocomplete},function(e,t){"use strict";e.exports={element:null}},function(e,t){e.exports=jQuery},function(e,t,n){"use strict";var i,a=n(2);function s(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}e.exports={isArray:null,isFunction:null,isObject:null,bind:null,each:null,map:null,mixin:null,isMsie:function(e){if(void 0===e&&(e=navigator.userAgent),/(msie|trident)/i.test(e)){var t=e.match(/(msie |rv:)(\d+(.\d+)?)/i);if(t)return t[2]}return!1},escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isNumber:function(e){return"number"==typeof e},toStr:function(e){return null==e?"":e+""},cloneDeep:function(e){var n=this.mixin({},e),i=this;return this.each(n,function(e,t){e&&(i.isArray(e)?n[t]=[].concat(e):i.isObject(e)&&(n[t]=i.cloneDeep(e)))}),n},error:function(e){throw new Error(e)},every:function(n,i){var a=!0;return n?(this.each(n,function(e,t){a=a&&(i.call(null,e,t,n)&&a)}),!!a):a},any:function(n,i){var a=!1;return n&&this.each(n,function(e,t){if(i.call(null,e,t,n))return!(a=!0)}),a},getUniqueId:(i=0,function(){return i++}),templatify:function(e){if(this.isFunction(e))return e;var t=a.element(e);return"SCRIPT"===t.prop("tagName")?function(){return t.text()}:function(){return String(e)}},defer:function(e){setTimeout(e,0)},noop:function(){},formatPrefix:function(e,t){return t?"":e+"-"},className:function(e,t,n){return(n?"":".")+e+t},escapeHighlightedString:function(e,t,n){t=t||"<em>";var i=document.createElement("div");i.appendChild(document.createTextNode(t)),n=n||"</em>";var a=document.createElement("div");a.appendChild(document.createTextNode(n));var o=document.createElement("div");return o.appendChild(document.createTextNode(e)),o.innerHTML.replace(RegExp(s(i.innerHTML),"g"),t).replace(RegExp(s(a.innerHTML),"g"),n)}}},function(e,t,n){"use strict";var s="aaAttrs",r=n(4),l=n(2),o=n(6),c=n(7),i=n(16),p=n(18),u=n(19);function d(e){if((e=e||{}).input||r.error("missing input"),this.isActivated=!1,this.debug=!!e.debug,this.autoselect=!!e.autoselect,this.autoselectOnBlur=!!e.autoselectOnBlur,this.openOnFocus=!!e.openOnFocus,this.minLength=r.isNumber(e.minLength)?e.minLength:1,this.autoWidth=void 0===e.autoWidth||!!e.autoWidth,this.clearOnSelected=!!e.clearOnSelected,this.tabAutocomplete=void 0===e.tabAutocomplete||!!e.tabAutocomplete,e.hint=!!e.hint,e.hint&&e.appendTo)throw new Error("[autocomplete.js] hint and appendTo options can't be used at the same time");this.css=e.css=r.mixin({},u,e.appendTo?u.appendTo:{}),this.cssClasses=e.cssClasses=r.mixin({},u.defaultClasses,e.cssClasses||{}),this.cssClasses.prefix=e.cssClasses.formattedPrefix=r.formatPrefix(this.cssClasses.prefix,this.cssClasses.noPrefix),this.listboxId=e.listboxId=[this.cssClasses.root,"listbox",r.getUniqueId()].join("-");var t=function(e){var t,n,i,a;t=l.element(e.input),n=l.element(p.wrapper.replace("%ROOT%",e.cssClasses.root)).css(e.css.wrapper),e.appendTo||"block"!==t.css("display")||"table"!==t.parent().css("display")||n.css("display","table-cell");var o=p.dropdown.replace("%PREFIX%",e.cssClasses.prefix).replace("%DROPDOWN_MENU%",e.cssClasses.dropdownMenu);i=l.element(o).css(e.css.dropdown).attr({role:"listbox",id:e.listboxId}),e.templates&&e.templates.dropdownMenu&&i.html(r.templatify(e.templates.dropdownMenu)());(a=t.clone().css(e.css.hint).css(function(e){return{backgroundAttachment:e.css("background-attachment"),backgroundClip:e.css("background-clip"),backgroundColor:e.css("background-color"),backgroundImage:e.css("background-image"),backgroundOrigin:e.css("background-origin"),backgroundPosition:e.css("background-position"),backgroundRepeat:e.css("background-repeat"),backgroundSize:e.css("background-size")}}(t))).val("").addClass(r.className(e.cssClasses.prefix,e.cssClasses.hint,!0)).removeAttr("id name placeholder required").prop("readonly",!0).attr({"aria-hidden":"true",autocomplete:"off",spellcheck:"false",tabindex:-1}),a.removeData&&a.removeData();t.data(s,{"aria-autocomplete":t.attr("aria-autocomplete"),"aria-expanded":t.attr("aria-expanded"),"aria-owns":t.attr("aria-owns"),autocomplete:t.attr("autocomplete"),dir:t.attr("dir"),role:t.attr("role"),spellcheck:t.attr("spellcheck"),style:t.attr("style"),type:t.attr("type")}),t.addClass(r.className(e.cssClasses.prefix,e.cssClasses.input,!0)).attr({autocomplete:"off",spellcheck:!1,role:"combobox","aria-autocomplete":e.datasets&&e.datasets[0]&&e.datasets[0].displayKey?"both":"list","aria-expanded":"false","aria-label":e.ariaLabel,"aria-owns":e.listboxId}).css(e.hint?e.css.input:e.css.inputWithNoHint);try{t.attr("dir")||t.attr("dir","auto")}catch(e){}return(n=e.appendTo?n.appendTo(l.element(e.appendTo).eq(0)).eq(0):t.wrap(n).parent()).prepend(e.hint?a:null).append(i),{wrapper:n,input:t,hint:a,menu:i}}(e);this.$node=t.wrapper;var n=this.$input=t.input,i=t.menu,a=t.hint;e.dropdownMenuContainer&&l.element(e.dropdownMenuContainer).css("position","relative").append(i.css("top","0")),n.on("blur.aa",function(e){var t=document.activeElement;r.isMsie()&&(i[0]===t||i[0].contains(t))&&(e.preventDefault(),e.stopImmediatePropagation(),r.defer(function(){n.focus()}))}),i.on("mousedown.aa",function(e){e.preventDefault()}),this.eventBus=e.eventBus||new o({el:n}),this.dropdown=new d.Dropdown({appendTo:e.appendTo,wrapper:this.$node,menu:i,datasets:e.datasets,templates:e.templates,cssClasses:e.cssClasses,minLength:this.minLength}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onSync("shown",this._onShown,this).onSync("empty",this._onEmpty,this).onSync("redrawn",this._onRedrawn,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new d.Input({input:n,hint:a}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),this._bindKeyboardShortcuts(e),this._setLanguageDirection()}r.mixin(d.prototype,{_bindKeyboardShortcuts:function(e){var a,o;e.keyboardShortcuts&&(a=this.$input,o=[],r.each(e.keyboardShortcuts,function(e){"string"==typeof e&&(e=e.toUpperCase().charCodeAt(0)),o.push(e)}),l.element(document).keydown(function(e){var t,n=e.target||e.srcElement,i=n.tagName;n.isContentEditable||"INPUT"===i||"SELECT"===i||"TEXTAREA"===i||(t=e.which||e.keyCode,-1!==o.indexOf(t)&&(a.focus(),e.stopPropagation(),e.preventDefault()))}))},_onSuggestionClicked:function(e,t){var n;(n=this.dropdown.getDatumForSuggestion(t))&&this._select(n,{selectionMethod:"click"})},_onCursorMoved:function(e,t){var n=this.dropdown.getDatumForCursor(),i=this.dropdown.getCurrentCursor().attr("id");this.input.setActiveDescendant(i),n&&(t&&this.input.setInputValue(n.value,!0),this.eventBus.trigger("cursorchanged",n.raw,n.datasetName))},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint(),this.eventBus.trigger("cursorremoved")},_onDatasetRendered:function(){this._updateHint(),this.eventBus.trigger("updated")},_onOpened:function(){this._updateHint(),this.input.expand(),this.eventBus.trigger("opened")},_onEmpty:function(){this.eventBus.trigger("empty")},_onRedrawn:function(){this.$node.css("top","0px"),this.$node.css("left","0px");var e=this.$input[0].getBoundingClientRect();this.autoWidth&&this.$node.css("width",e.width+"px");var t=this.$node[0].getBoundingClientRect(),n=e.bottom-t.top;this.$node.css("top",n+"px");var i=e.left-t.left;this.$node.css("left",i+"px"),this.eventBus.trigger("redrawn")},_onShown:function(){this.eventBus.trigger("shown"),this.autoselect&&this.dropdown.cursorTopSuggestion()},_onClosed:function(){this.input.clearHint(),this.input.removeActiveDescendant(),this.input.collapse(),this.eventBus.trigger("closed")},_onFocused:function(){var e;this.isActivated=!0,this.openOnFocus&&((e=this.input.getQuery()).length>=this.minLength?this.dropdown.update(e):this.dropdown.empty(),this.dropdown.open())},_onBlurred:function(){var e=this.dropdown.getDatumForCursor(),t=this.dropdown.getDatumForTopSuggestion(),n={selectionMethod:"blur"};this.debug||(this.autoselectOnBlur&&e?this._select(e,n):this.autoselectOnBlur&&t?this._select(t,n):(this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()))},_onEnterKeyed:function(e,t){var n=this.dropdown.getDatumForCursor(),i=this.dropdown.getDatumForTopSuggestion(),a={selectionMethod:"enterKey"};n?(this._select(n,a),t.preventDefault()):this.autoselect&&i&&(this._select(i,a),t.preventDefault())},_onTabKeyed:function(e,t){var n;this.tabAutocomplete?(n=this.dropdown.getDatumForCursor())?(this._select(n,{selectionMethod:"tabKey"}),t.preventDefault()):this._autocomplete(!0):this.dropdown.close()},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var e=this.input.getQuery();this.dropdown.isEmpty&&e.length>=this.minLength?this.dropdown.update(e):this.dropdown.moveCursorUp(),this.dropdown.open()},_onDownKeyed:function(){var e=this.input.getQuery();this.dropdown.isEmpty&&e.length>=this.minLength?this.dropdown.update(e):this.dropdown.moveCursorDown(),this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(e,t){this.input.clearHintIfInvalid(),t.length>=this.minLength?this.dropdown.update(t):this.dropdown.empty(),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var e=this.input.getLanguageDirection();this.dir!==e&&(this.dir=e,this.$node.css("direction",e),this.dropdown.setLanguageDirection(e))},_updateHint:function(){var e,t,n,i,a=this.dropdown.getDatumForTopSuggestion();a&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(e=this.input.getInputValue(),t=c.normalizeQuery(e),n=r.escapeRegExChars(t),(i=new RegExp("^(?:"+n+")(.+$)","i").exec(a.value))?this.input.setHint(e+i[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(e){var t,n=this.input.getHint(),i=this.input.getQuery(),a=e||this.input.isCursorAtEnd();n&&i!==n&&a&&((t=this.dropdown.getDatumForTopSuggestion())&&this.input.setInputValue(t.value),this.eventBus.trigger("autocompleted",t.raw,t.datasetName))},_select:function(e,t){void 0!==e.value&&this.input.setQuery(e.value),this.clearOnSelected?this.setVal(""):this.input.setInputValue(e.value,!0),this._setLanguageDirection(),!1===this.eventBus.trigger("selected",e.raw,e.datasetName,t).isDefaultPrevented()&&(this.dropdown.close(),r.defer(r.bind(this.dropdown.empty,this.dropdown)))},open:function(){var e;this.isActivated||((e=this.input.getInputValue()).length>=this.minLength?this.dropdown.update(e):this.dropdown.empty()),this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(e){e=r.toStr(e),this.isActivated?this.input.setInputValue(e):(this.input.setQuery(e),this.input.setInputValue(e,!0)),this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy(),this.dropdown.destroy(),function(e,t){var n=e.find(r.className(t.prefix,t.input));r.each(n.data(s),function(e,t){void 0===e?n.removeAttr(t):n.attr(t,e)}),n.detach().removeClass(r.className(t.prefix,t.input,!0)).insertAfter(e),n.removeData&&n.removeData(s);e.remove()}(this.$node,this.cssClasses),this.$node=null},getWrapper:function(){return this.dropdown.$container[0]}}),d.Dropdown=i,d.Input=c,d.sources=n(20),e.exports=d},function(e,t,n){"use strict";var o=n(4),i=n(2);function a(e){e&&e.el||o.error("EventBus initialized without el"),this.$el=i.element(e.el)}o.mixin(a.prototype,{trigger:function(e,t,n,i){var a=o.Event("autocomplete:"+e);return this.$el.trigger(a,[t,n,i]),a}}),e.exports=a},function(e,t,n){"use strict";var r={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},l=n(4),c=n(2),i=n(8);function o(e){var t,n,i,a,o,s=this;(e=e||{}).input||l.error("input is missing"),t=l.bind(this._onBlur,this),n=l.bind(this._onFocus,this),i=l.bind(this._onKeydown,this),a=l.bind(this._onInput,this),this.$hint=c.element(e.hint),this.$input=c.element(e.input).on("blur.aa",t).on("focus.aa",n).on("keydown.aa",i),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=l.noop),l.isMsie()?this.$input.on("keydown.aa keypress.aa cut.aa paste.aa",function(e){r[e.which||e.keyCode]||l.defer(l.bind(s._onInput,s,e))}):this.$input.on("input.aa",a),this.query=this.$input.val(),this.$overflowHelper=(o=this.$input,c.element('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:o.css("font-family"),fontSize:o.css("font-size"),fontStyle:o.css("font-style"),fontVariant:o.css("font-variant"),fontWeight:o.css("font-weight"),wordSpacing:o.css("word-spacing"),letterSpacing:o.css("letter-spacing"),textIndent:o.css("text-indent"),textRendering:o.css("text-rendering"),textTransform:o.css("text-transform")}).insertAfter(o))}function s(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey}o.normalizeQuery=function(e){return(e||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},l.mixin(o.prototype,i,{_onBlur:function(){this.resetInputValue(),this.$input.removeAttr("aria-activedescendant"),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(e){var t=r[e.which||e.keyCode];this._managePreventDefault(t,e),t&&this._shouldTrigger(t,e)&&this.trigger(t+"Keyed",e)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(e,t){var n,i,a;switch(e){case"tab":i=this.getHint(),a=this.getInputValue(),n=i&&i!==a&&!s(t);break;case"up":case"down":n=!s(t);break;default:n=!1}n&&t.preventDefault()},_shouldTrigger:function(e,t){var n;switch(e){case"tab":n=!s(t);break;default:n=!0}return n},_checkInputValue:function(){var e,t,n,i,a=this.getInputValue();n=a,i=this.query,t=!(!(e=o.normalizeQuery(n)===o.normalizeQuery(i))||!this.query)&&this.query.length!==a.length,this.query=a,e?t&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(e){this.query=e},getInputValue:function(){return this.$input.val()},setInputValue:function(e,t){void 0===e&&(e=this.query),this.$input.val(e),t?this.clearHint():this._checkInputValue()},expand:function(){this.$input.attr("aria-expanded","true")},collapse:function(){this.$input.attr("aria-expanded","false")},setActiveDescendant:function(e){this.$input.attr("aria-activedescendant",e)},removeActiveDescendant:function(){this.$input.removeAttr("aria-activedescendant")},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(e){this.$hint.val(e)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var e=this.getInputValue(),t=this.getHint(),n=e!==t&&0===t.indexOf(e);""!==e&&n&&!this.hasOverflow()||this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var e=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=e},isCursorAtEnd:function(){var e,t=this.$input.val().length,n=this.$input[0].selectionStart;return l.isNumber(n)?n===t:!document.selection||((e=document.selection.createRange()).moveStart("character",-t),t===e.text.length)},destroy:function(){this.$hint.off(".aa"),this.$input.off(".aa"),this.$hint=this.$input=this.$overflowHelper=null}}),e.exports=o},function(e,t,n){"use strict";var s=n(9),r=/\s+/;function i(e,t,n,i){var a,o,s;if(!n)return this;for(t=t.split(r),n=i?(s=i,(o=n).bind?o.bind(s):function(){o.apply(s,[].slice.call(arguments,0))}):n,this._callbacks=this._callbacks||{};a=t.shift();)this._callbacks[a]=this._callbacks[a]||{sync:[],async:[]},this._callbacks[a][e].push(n);return this}function l(i,a,o){return function(){for(var e,t=0,n=i.length;!e&&t<n;t+=1)e=!1===i[t].apply(a,o);return!e}}e.exports={onSync:function(e,t,n){return i.call(this,"sync",e,t,n)},onAsync:function(e,t,n){return i.call(this,"async",e,t,n)},off:function(e){var t;if(!this._callbacks)return this;e=e.split(r);for(;t=e.shift();)delete this._callbacks[t];return this},trigger:function(e){var t,n,i,a,o;if(!this._callbacks)return this;e=e.split(r),i=[].slice.call(arguments,1);for(;(t=e.shift())&&(n=this._callbacks[t]);)a=l(n.sync,this,[t].concat(i)),o=l(n.async,this,[t].concat(i)),a()&&s(o);return this}}},function(e,t,n){"use strict";var i,a,o,s=[n(10),n(12),n(13),n(14),n(15)],r=-1,l=[],c=!1;function p(){i&&a&&(i=!1,a.length?l=a.concat(l):r=-1,l.length&&u())}function u(){if(!i){i=!(c=!1);for(var e=l.length,t=setTimeout(p);e;){for(a=l,l=[];a&&++r<e;)a[r].run();r=-1,e=l.length}a=null,i=!(r=-1),clearTimeout(t)}}for(var d=-1,h=s.length;++d<h;)if(s[d]&&s[d].test&&s[d].test()){o=s[d].install(u);break}function m(e,t){this.fun=e,this.array=t}m.prototype.run=function(){var e=this.fun,t=this.array;switch(t.length){case 0:return e();case 1:return e(t[0]);case 2:return e(t[0],t[1]);case 3:return e(t[0],t[1],t[2]);default:return e.apply(null,t)}},e.exports=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new m(e,t)),c||i||(c=!0,o())}},function(e,n,t){(function(t){"use strict";n.test=function(){return void 0!==t&&!t.browser},n.install=function(e){return function(){t.nextTick(e)}}}).call(n,t(11))},function(e,t){var n,i,a=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function r(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var l,c=[],p=!1,u=-1;function d(){p&&l&&(p=!1,l.length?c=l.concat(c):u=-1,c.length&&h())}function h(){if(!p){var e=r(d);p=!0;for(var t=c.length;t;){for(l=c,c=[];++u<t;)l&&l[u].run();u=-1,t=c.length}l=null,p=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new m(e,t)),1!==c.length||p||r(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t){(function(a){"use strict";var o=a.MutationObserver||a.WebKitMutationObserver;t.test=function(){return o},t.install=function(e){var t=0,n=new o(e),i=a.document.createTextNode("");return n.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}}).call(t,function(){return this}())},function(e,t){(function(n){"use strict";t.test=function(){return!n.setImmediate&&void 0!==n.MessageChannel},t.install=function(e){var t=new n.MessageChannel;return t.port1.onmessage=e,function(){t.port2.postMessage(0)}}}).call(t,function(){return this}())},function(e,t){(function(n){"use strict";t.test=function(){return"document"in n&&"onreadystatechange"in n.document.createElement("script")},t.install=function(t){return function(){var e=n.document.createElement("script");return e.onreadystatechange=function(){t(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},n.document.documentElement.appendChild(e),t}}}).call(t,function(){return this}())},function(e,t){"use strict";t.test=function(){return!0},t.install=function(e){return function(){setTimeout(e,0)}}},function(e,t,n){"use strict";var r=n(4),l=n(2),i=n(8),a=n(17),c=n(19);function p(a){var e,t,n,o=this;(a=a||{}).menu||r.error("menu is required"),r.isArray(a.datasets)||r.isObject(a.datasets)||r.error("1 or more datasets required"),a.datasets||r.error("datasets is required"),this.isOpen=!1,this.isEmpty=!0,this.minLength=a.minLength||0,this.templates={},this.appendTo=a.appendTo||!1,this.css=r.mixin({},c,a.appendTo?c.appendTo:{}),this.cssClasses=a.cssClasses=r.mixin({},c.defaultClasses,a.cssClasses||{}),this.cssClasses.prefix=a.cssClasses.formattedPrefix||r.formatPrefix(this.cssClasses.prefix,this.cssClasses.noPrefix),e=r.bind(this._onSuggestionClick,this),t=r.bind(this._onSuggestionMouseEnter,this),n=r.bind(this._onSuggestionMouseLeave,this);var i=r.className(this.cssClasses.prefix,this.cssClasses.suggestion);this.$menu=l.element(a.menu).on("mouseenter.aa",i,t).on("mouseleave.aa",i,n).on("click.aa",i,e),this.$container=a.appendTo?a.wrapper:this.$menu,a.templates&&a.templates.header&&(this.templates.header=r.templatify(a.templates.header),this.$menu.prepend(this.templates.header())),a.templates&&a.templates.empty&&(this.templates.empty=r.templatify(a.templates.empty),this.$empty=l.element('<div class="'+r.className(this.cssClasses.prefix,this.cssClasses.empty,!0)+'"></div>'),this.$menu.append(this.$empty),this.$empty.hide()),this.datasets=r.map(a.datasets,function(e){return t=o.$menu,n=e,i=a.cssClasses,new p.Dataset(r.mixin({$menu:t,cssClasses:i},n));var t,n,i}),r.each(this.datasets,function(e){var t=e.getRoot();t&&0===t.parent().length&&o.$menu.append(t),e.onSync("rendered",o._onRendered,o)}),a.templates&&a.templates.footer&&(this.templates.footer=r.templatify(a.templates.footer),this.$menu.append(this.templates.footer()));var s=this;l.element(window).resize(function(){s._redraw()})}r.mixin(p.prototype,i,{_onSuggestionClick:function(e){this.trigger("suggestionClicked",l.element(e.currentTarget))},_onSuggestionMouseEnter:function(e){var t,n=l.element(e.currentTarget);n.hasClass(r.className(this.cssClasses.prefix,this.cssClasses.cursor,!0))||(this._removeCursor(),t=this,setTimeout(function(){t._setCursor(n,!1)},0))},_onSuggestionMouseLeave:function(e){if(e.relatedTarget&&0<l.element(e.relatedTarget).closest("."+r.className(this.cssClasses.prefix,this.cssClasses.cursor,!0)).length)return;this._removeCursor(),this.trigger("cursorRemoved")},_onRendered:function(e,t){var n;this.isEmpty=r.every(this.datasets,function(e){return e.isEmpty()}),this.isEmpty?(t.length>=this.minLength&&this.trigger("empty"),this.$empty?t.length<this.minLength?this._hide():(n=this.templates.empty({query:this.datasets[0]&&this.datasets[0].query}),this.$empty.html(n),this.$empty.show(),this._show()):!r.any(this.datasets,function(e){return e.templates&&e.templates.empty})||t.length<this.minLength?this._hide():this._show()):this.isOpen&&(this.$empty&&(this.$empty.empty(),this.$empty.hide()),t.length>=this.minLength?this._show():this._hide()),this.trigger("datasetRendered")},_hide:function(){this.$container.hide()},_show:function(){this.$container.css("display","block"),this._redraw(),this.trigger("shown")},_redraw:function(){this.isOpen&&this.appendTo&&this.trigger("redrawn")},_getSuggestions:function(){return this.$menu.find(r.className(this.cssClasses.prefix,this.cssClasses.suggestion))},_getCursor:function(){return this.$menu.find(r.className(this.cssClasses.prefix,this.cssClasses.cursor)).first()},_setCursor:function(e,t){e.first().addClass(r.className(this.cssClasses.prefix,this.cssClasses.cursor,!0)).attr("aria-selected","true"),this.trigger("cursorMoved",t)},_removeCursor:function(){this._getCursor().removeClass(r.className(this.cssClasses.prefix,this.cssClasses.cursor,!0)).removeAttr("aria-selected")},_moveCursor:function(e){var t,n,i,a;this.isOpen&&(n=this._getCursor(),t=this._getSuggestions(),this._removeCursor(),-1!==(i=((i=t.index(n)+e)+1)%(t.length+1)-1)?(i<-1&&(i=t.length-1),this._setCursor(a=t.eq(i),!0),this._ensureVisible(a)):this.trigger("cursorRemoved"))},_ensureVisible:function(e){var t=e.position().top,n=t+e.height()+parseInt(e.css("margin-top"),10)+parseInt(e.css("margin-bottom"),10),i=this.$menu.scrollTop(),a=this.$menu.height()+parseInt(this.$menu.css("padding-top"),10)+parseInt(this.$menu.css("padding-bottom"),10);t<0?this.$menu.scrollTop(i+t):a<n&&this.$menu.scrollTop(i+(n-a))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,this.isEmpty||this._show(),this.trigger("opened"))},setLanguageDirection:function(e){this.$menu.css("ltr"===e?this.css.ltr:this.css.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(e){var t=null;return e.length&&(t={raw:a.extractDatum(e),value:a.extractValue(e),datasetName:a.extractDatasetName(e)}),t},getCurrentCursor:function(){return this._getCursor().first()},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},cursorTopSuggestion:function(){this._setCursor(this._getSuggestions().first(),!1)},update:function(t){r.each(this.datasets,function(e){e.update(t)})},empty:function(){r.each(this.datasets,function(e){e.clear()}),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){this.$menu.off(".aa"),this.$menu=null,r.each(this.datasets,function(e){e.destroy()})}}),p.Dataset=a,e.exports=p},function(e,t,n){"use strict";var r="aaDataset",l="aaValue",c="aaDatum",p=n(4),u=n(2),d=n(18),o=n(19),i=n(8);function a(e){var t,n,i;(e=e||{}).templates=e.templates||{},e.source||p.error("missing source"),e.name&&!/^[_a-zA-Z0-9-]+$/.test(e.name)&&p.error("invalid dataset name: "+e.name),this.query=null,this._isEmpty=!0,this.highlight=!!e.highlight,this.name=void 0===e.name||null===e.name?p.getUniqueId():e.name,this.source=e.source,this.displayFn=(t=(t=e.display||e.displayKey)||"value",p.isFunction(t)?t:function(e){return e[t]}),this.debounce=e.debounce,this.cache=!1!==e.cache,this.templates=(n=e.templates,i=this.displayFn,{empty:n.empty&&p.templatify(n.empty),header:n.header&&p.templatify(n.header),footer:n.footer&&p.templatify(n.footer),suggestion:n.suggestion||function(e){return"<p>"+i(e)+"</p>"}}),this.css=p.mixin({},o,e.appendTo?o.appendTo:{}),this.cssClasses=e.cssClasses=p.mixin({},o.defaultClasses,e.cssClasses||{}),this.cssClasses.prefix=e.cssClasses.formattedPrefix||p.formatPrefix(this.cssClasses.prefix,this.cssClasses.noPrefix);var a=p.className(this.cssClasses.prefix,this.cssClasses.dataset);this.$el=e.$menu&&0<e.$menu.find(a+"-"+this.name).length?u.element(e.$menu.find(a+"-"+this.name)[0]):u.element(d.dataset.replace("%CLASS%",this.name).replace("%PREFIX%",this.cssClasses.prefix).replace("%DATASET%",this.cssClasses.dataset)),this.$menu=e.$menu,this.clearCachedSuggestions()}a.extractDatasetName=function(e){return u.element(e).data(r)},a.extractValue=function(e){return u.element(e).data(l)},a.extractDatum=function(e){var t=u.element(e).data(c);return"string"==typeof t&&(t=JSON.parse(t)),t},p.mixin(a.prototype,i,{_render:function(t,o){if(this.$el){var n,s=this,e=[].slice.call(arguments,2);if(this.$el.empty(),n=o&&o.length,this._isEmpty=!n,!n&&this.templates.empty)this.$el.html(function(){var e=[].slice.call(arguments,0);return e=[{query:t,isEmpty:!0}].concat(e),s.templates.empty.apply(this,e)}.apply(this,e)).prepend(s.templates.header?i.apply(this,e):null).append(s.templates.footer?a.apply(this,e):null);else if(n)this.$el.html(function(){var e,t,i=[].slice.call(arguments,0),a=this,n=d.suggestions.replace("%PREFIX%",this.cssClasses.prefix).replace("%SUGGESTIONS%",this.cssClasses.suggestions);return e=u.element(n).css(this.css.suggestions),t=p.map(o,function(e){var t,n=d.suggestion.replace("%PREFIX%",a.cssClasses.prefix).replace("%SUGGESTION%",a.cssClasses.suggestion);return(t=u.element(n).attr({role:"option",id:["option",Math.floor(1e8*Math.random())].join("-")}).append(s.templates.suggestion.apply(this,[e].concat(i)))).data(r,s.name),t.data(l,s.displayFn(e)||void 0),t.data(c,JSON.stringify(e)),t.children().each(function(){u.element(this).css(a.css.suggestionChild)}),t}),e.append.apply(e,t),e}.apply(this,e)).prepend(s.templates.header?i.apply(this,e):null).append(s.templates.footer?a.apply(this,e):null);else if(o&&!Array.isArray(o))throw new TypeError("suggestions must be an array");this.$menu&&this.$menu.addClass(this.cssClasses.prefix+(n?"with":"without")+"-"+this.name).removeClass(this.cssClasses.prefix+(n?"without":"with")+"-"+this.name),this.trigger("rendered",t)}function i(){var e=[].slice.call(arguments,0),e=[{query:t,isEmpty:!n}].concat(e);return s.templates.header.apply(this,e)}function a(){var e=[].slice.call(arguments,0),e=[{query:t,isEmpty:!n}].concat(e);return s.templates.footer.apply(this,e)}},getRoot:function(){return this.$el},update:function(n){function e(e){var t;this.canceled||n!==this.query||(t=[].slice.call(arguments,1),this.cacheSuggestions(n,e,t),this._render.apply(this,[n,e].concat(t)))}var t,i;this.query=n,this.canceled=!1,this.shouldFetchFromCache(n)?e.apply(this,[this.cachedSuggestions].concat(this.cachedRenderExtraArgs)):(i=function(){t.canceled||t.source(n,e.bind(t))},(t=this).debounce?(clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout(function(){t.debounceTimeout=null,i()},this.debounce)):i())},cacheSuggestions:function(e,t,n){this.cachedQuery=e,this.cachedSuggestions=t,this.cachedRenderExtraArgs=n},shouldFetchFromCache:function(e){return this.cache&&this.cachedQuery===e&&this.cachedSuggestions&&this.cachedSuggestions.length},clearCachedSuggestions:function(){delete this.cachedQuery,delete this.cachedSuggestions,delete this.cachedRenderExtraArgs},cancel:function(){this.canceled=!0},clear:function(){this.$el&&(this.cancel(),this.$el.empty(),this.trigger("rendered",""))},isEmpty:function(){return this._isEmpty},destroy:function(){this.clearCachedSuggestions(),this.$el=null}}),e.exports=a},function(e,t){"use strict";e.exports={wrapper:'<span class="%ROOT%"></span>',dropdown:'<span class="%PREFIX%%DROPDOWN_MENU%"></span>',dataset:'<div class="%PREFIX%%DATASET%-%CLASS%"></div>',suggestions:'<span class="%PREFIX%%SUGGESTIONS%"></span>',suggestion:'<div class="%PREFIX%%SUGGESTION%"></div>'}},function(e,t,n){"use strict";var i=n(4),a={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:"0"},defaultClasses:{root:"algolia-autocomplete",prefix:"aa",noPrefix:!1,dropdownMenu:"dropdown-menu",input:"input",hint:"hint",suggestions:"suggestions",suggestion:"suggestion",cursor:"cursor",dataset:"dataset",empty:"empty"},appendTo:{wrapper:{position:"absolute",zIndex:"100",display:"none"},input:{},inputWithNoHint:{},dropdown:{display:"block"}}};i.isMsie()&&i.mixin(a.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),i.isMsie()&&i.isMsie()<=7&&i.mixin(a.input,{marginTop:"-1px"}),e.exports=a},function(e,t,n){"use strict";e.exports={hits:n(21),popularIn:n(24)}},function(e,t,n){"use strict";var a=n(4),o=n(22),s=n(23);e.exports=function(t,i){var e=s(t.as._ua);return e&&3<=e[0]&&20<e[1]&&((i=i||{}).additionalUA="autocomplete.js "+o),function(e,n){t.search(e,i,function(e,t){e?a.error(e.message):n(t.hits,t)})}}},function(e,t){e.exports="0.37.1"},function(e,t){"use strict";e.exports=function(e){var t=e.match(/Algolia for JavaScript \((\d+\.)(\d+\.)(\d+)\)/)||e.match(/Algolia for vanilla JavaScript (\d+\.)(\d+\.)(\d+)/);if(t)return[t[1],t[2],t[3]]}},function(e,t,n){"use strict";var u=n(4),d=n(22),h=n(23);e.exports=function(t,i,a,l){var e=h(t.as._ua);if(e&&3<=e[0]&&20<e[1]&&((i=i||{}).additionalUA="autocomplete.js "+d),!a.source)return u.error("Missing 'source' key");var c=u.isFunction(a.source)?a.source:function(e){return e[a.source]};if(!a.index)return u.error("Missing 'index' key");var p=a.index;return l=l||{},function(e,r){t.search(e,i,function(e,o){if(e)u.error(e.message);else{if(0<o.hits.length){var s=o.hits[0],t=u.mixin({hitsPerPage:0},a);delete t.source,delete t.index;var n=h(p.as._ua);return n&&3<=n[0]&&20<n[1]&&(i.additionalUA="autocomplete.js "+d),void p.search(c(s),t,function(e,t){if(e)u.error(e.message);else{var n,i=[];l.includeAll&&(n=l.allTitle||"All departments",i.push(u.mixin({facet:{value:n,count:t.nbHits}},u.cloneDeep(s)))),u.each(t.facets,function(e,n){u.each(e,function(e,t){i.push(u.mixin({facet:{facet:n,value:t,count:e}},u.cloneDeep(s)))})});for(var a=1;a<o.hits.length;++a)i.push(o.hits[a]);r(i,o)}})}r([])}})}}}]),jQuery.fn.algoliaAutocomplete=jQuery.fn.autocomplete.noConflict(),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jquery")):e(jQuery)}(function(Ie,je){"use strict";var e,Fe={beforeShow:n,move:n,change:n,show:n,hide:n,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},Be=[],Ue=!!/msie/i.exec(window.navigator.userAgent),Qe=((e=document.createElement("div").style).cssText="background-color:rgba(0,0,0,.5)",t(e.backgroundColor,"rgba")||t(e.backgroundColor,"hsla")),He=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),Ne=function(){var e="";if(Ue)for(var t=1;t<=6;t++)e+="<div class='sp-"+t+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function t(e,t){return!!~(""+e).indexOf(t)}function qe(e,t,n,i){for(var a=[],o=0;o<e.length;o++){var s,r,l,c,p=e[o];p?(r=(s=tinycolor(p)).toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light",r+=tinycolor.equals(t,p)?" sp-thumb-active":"",l=s.toString(i.preferredFormat||"rgb"),c=Qe?"background-color:"+s.toRgbString():"filter:"+s.toFilter(),a.push('<span title="'+l+'" data-color="'+s.toRgbString()+'" class="'+r+'"><span class="sp-thumb-inner" style="'+c+';" /></span>')):a.push(Ie("<div />").append(Ie('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",i.noColorSelectedText)).html())}return"<div class='sp-cf "+n+"'>"+a.join("")+"</div>"}function o(e,t){var n,i,a,o,s,r,l,p=(s=t,r=e,(l=Ie.extend({},Fe,s)).callbacks={move:Ge(l.move,r),change:Ge(l.change,r),show:Ge(l.show,r),hide:Ge(l.hide,r),beforeShow:Ge(l.beforeShow,r)},l),u=p.flat,c=p.showSelectionPalette,d=p.localStorageKey,h=p.theme,m=p.callbacks,g=(n=Pe,function(){var e=this,t=arguments;a&&clearTimeout(o),!a&&o||(o=setTimeout(function(){o=null,n.apply(e,t)},i))}),f=!(i=10),v=!1,y=0,b=0,_=0,x=0,w=0,k=0,C=0,S=0,A=0,L=0,T=1,D=[],E=[],O={},R=p.selectionPalette.slice(0),P=p.maxSelectionSize,$="sp-dragging",M=null,I=e.ownerDocument,j=(I.body,Ie(e)),F=!1,B=Ie(Ne,I).addClass(h),U=B.find(".sp-picker-container"),Q=B.find(".sp-color"),H=B.find(".sp-dragger"),N=B.find(".sp-hue"),q=B.find(".sp-slider"),z=B.find(".sp-alpha-inner"),G=B.find(".sp-alpha"),W=B.find(".sp-alpha-handle"),K=B.find(".sp-input"),J=B.find(".sp-palette"),V=B.find(".sp-initial"),Z=B.find(".sp-cancel"),Y=B.find(".sp-clear"),X=B.find(".sp-choose"),ee=B.find(".sp-palette-toggle"),te=j.is("input"),ne=te&&"color"===j.attr("type")&&Ke(),ie=te&&!u,ae=ie?Ie(He).addClass(h).addClass(p.className).addClass(p.replacerClassName):Ie([]),oe=ie?ae:j,se=ae.find(".sp-preview-inner"),re=p.color||te&&j.val(),le=!1,ce=p.preferredFormat,pe=!p.showButtons||p.clickoutFiresChange,ue=!re,de=p.allowEmpty&&!ne;function he(){if(p.showPaletteOnly&&(p.showPalette=!0),ee.text(p.showPaletteOnly?p.togglePaletteMoreText:p.togglePaletteLessText),p.palette){D=p.palette.slice(0),E=Ie.isArray(D[0])?D:[D],O={};for(var e=0;e<E.length;e++)for(var t=0;t<E[e].length;t++){var n=tinycolor(E[e][t]).toRgbString();O[n]=!0}}B.toggleClass("sp-flat",u),B.toggleClass("sp-input-disabled",!p.showInput),B.toggleClass("sp-alpha-enabled",p.showAlpha),B.toggleClass("sp-clear-enabled",de),B.toggleClass("sp-buttons-disabled",!p.showButtons),B.toggleClass("sp-palette-buttons-disabled",!p.togglePaletteOnly),B.toggleClass("sp-palette-disabled",!p.showPalette),B.toggleClass("sp-palette-only",p.showPaletteOnly),B.toggleClass("sp-initial-disabled",!p.showInitial),B.addClass(p.className).addClass(p.containerClassName),Pe()}function me(){if(d&&window.localStorage){try{var e=window.localStorage[d].split(",#");1<e.length&&(delete window.localStorage[d],Ie.each(e,function(e,t){ge(t)}))}catch(e){}try{R=window.localStorage[d].split(";")}catch(e){}}}function ge(e){if(c){var t=tinycolor(e).toRgbString();if(!O[t]&&-1===Ie.inArray(t,R))for(R.push(t);R.length>P;)R.shift();if(d&&window.localStorage)try{window.localStorage[d]=R.join(";")}catch(e){}}}function fe(){var n=Te(),e=Ie.map(E,function(e,t){return qe(e,n,"sp-palette-row sp-palette-row-"+t,p)});me(),R&&e.push(qe(function(){var e=[];if(p.showPalette)for(var t=0;t<R.length;t++){var n=tinycolor(R[t]).toRgbString();O[n]||e.push(R[t])}return e.reverse().slice(0,p.maxSelectionSize)}(),n,"sp-palette-row sp-palette-row-selection",p)),J.html(e.join(""))}function ve(){var e,t;p.showInitial&&(e=le,t=Te(),V.html(qe([e,t],t,"sp-palette-row-initial",p)))}function ye(){(b<=0||y<=0||x<=0)&&Pe(),v=!0,B.addClass($),M=null,j.trigger("dragstart.spectrum",[Te()])}function be(){v=!1,B.removeClass($),j.trigger("dragstop.spectrum",[Te()])}function _e(){var e,t=K.val();null!==t&&""!==t||!de?(e=tinycolor(t)).isValid()?(Le(e),Re(!0)):K.addClass("sp-validation-error"):(Le(null),Re(!0))}function xe(){(f?Se:we)()}function we(){var e=Ie.Event("beforeShow.spectrum");f?Pe():(j.trigger(e,[Te()]),!1===m.beforeShow(Te())||e.isDefaultPrevented()||(function(){for(var e=0;e<Be.length;e++)Be[e]&&Be[e].hide()}(),f=!0,Ie(I).bind("keydown.spectrum",ke),Ie(I).bind("click.spectrum",Ce),Ie(window).bind("resize.spectrum",g),ae.addClass("sp-active"),B.removeClass("sp-hidden"),Pe(),Ee(),le=Te(),ve(),m.show(le),j.trigger("show.spectrum",[le])))}function ke(e){27===e.keyCode&&Se()}function Ce(e){2!=e.button&&(v||(pe?Re(!0):Ae(),Se()))}function Se(){f&&!u&&(f=!1,Ie(I).unbind("keydown.spectrum",ke),Ie(I).unbind("click.spectrum",Ce),Ie(window).unbind("resize.spectrum",g),ae.removeClass("sp-active"),B.addClass("sp-hidden"),m.hide(Te()),j.trigger("hide.spectrum",[Te()]))}function Ae(){Le(le,!0)}function Le(e,t){var n,i;tinycolor.equals(e,Te())?Ee():(!e&&de?ue=!0:(ue=!1,i=(n=tinycolor(e)).toHsv(),S=i.h%360/360,A=i.s,L=i.v,T=i.a),Ee(),n&&n.isValid()&&!t&&(ce=p.preferredFormat||n.getFormat()))}function Te(e){return e=e||{},de&&ue?null:tinycolor.fromRatio({h:S,s:A,v:L,a:Math.round(100*T)/100},{format:e.format||ce})}function De(){Ee(),m.move(Te()),j.trigger("move.spectrum",[Te()])}function Ee(){K.removeClass("sp-validation-error"),Oe();var e=tinycolor.fromRatio({h:S,s:1,v:1});Q.css("background-color",e.toHexString());var t=ce;T<1&&(0!==T||"name"!==t)&&("hex"!==t&&"hex3"!==t&&"hex6"!==t&&"name"!==t||(t="rgb"));var n,i,a,o,s,r=Te({format:t}),l="";se.removeClass("sp-clear-display"),se.css("background-color","transparent"),!r&&de?se.addClass("sp-clear-display"):(n=r.toHexString(),i=r.toRgbString(),Qe||1===r.alpha?se.css("background-color",i):(se.css("background-color","transparent"),se.css("filter",r.toFilter())),p.showAlpha&&((a=r.toRgb()).a=0,s="linear-gradient(left, "+(o=tinycolor(a).toRgbString())+", "+n+")",Ue?z.css("filter",tinycolor(o).toFilter({gradientType:1},n)):(z.css("background","-webkit-"+s),z.css("background","-moz-"+s),z.css("background","-ms-"+s),z.css("background","linear-gradient(to right, "+o+", "+n+")"))),l=r.toString(t)),p.showInput&&K.val(l),p.showPalette&&fe(),ve()}function Oe(){var e,t,n,i,a=A,o=L;de&&ue?(W.hide(),q.hide(),H.hide()):(W.show(),q.show(),H.show(),e=a*y,t=b-o*b,e=Math.max(-_,Math.min(y-_,e-_)),t=Math.max(-_,Math.min(b-_,t-_)),H.css({top:t+"px",left:e+"px"}),n=T*w,W.css({left:n-k/2+"px"}),i=S*x,q.css({top:i-C+"px"}))}function Re(e){var t=Te(),n="",i=!tinycolor.equals(t,le);t&&(n=t.toString(ce),ge(t)),te&&j.val(n),e&&i&&(m.change(t),j.trigger("change",[t]))}function Pe(){var e,t,n,i,a,o,s,r,l,c;f&&(y=Q.width(),b=Q.height(),_=H.height(),N.width(),x=N.height(),C=q.height(),w=G.width(),k=W.width(),u||(B.css("position","absolute"),p.offset?B.offset(p.offset):B.offset((t=oe,n=(e=B).outerWidth(),i=e.outerHeight(),a=t.outerHeight(),o=e[0].ownerDocument,s=o.documentElement,r=s.clientWidth+Ie(o).scrollLeft(),l=s.clientHeight+Ie(o).scrollTop(),(c=t.offset()).top+=a,c.left-=Math.min(c.left,c.left+n>r&&n<r?Math.abs(c.left+n-r):0),c.top-=Math.min(c.top,c.top+i>l&&i<l?Math.abs(+(i+a)):0),c))),Oe(),p.showPalette&&fe(),j.trigger("reflow.spectrum"))}function $e(){Se(),F=!0,j.attr("disabled",!0),oe.addClass("sp-disabled")}!function(){var e;function t(e){return e.data&&e.data.ignore?(Le(Ie(e.target).closest(".sp-thumb-el").data("color")),De()):(Le(Ie(e.target).closest(".sp-thumb-el").data("color")),De(),Re(!0),p.hideAfterPaletteSelect&&Se()),!1}Ue&&B.find("*:not(input)").attr("unselectable","on"),he(),ie&&j.after(ae).hide(),de||Y.hide(),u?j.after(B).hide():(1!==(e="parent"===p.appendTo?j.parent():Ie(p.appendTo)).length&&(e=Ie("body")),e.append(B)),me(),oe.bind("click.spectrum touchstart.spectrum",function(e){F||xe(),e.stopPropagation(),Ie(e.target).is("input")||e.preventDefault()}),!j.is(":disabled")&&!0!==p.disabled||$e(),B.click(ze),K.change(_e),K.bind("paste",function(){setTimeout(_e,1)}),K.keydown(function(e){13==e.keyCode&&_e()}),Z.text(p.cancelText),Z.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),Ae(),Se()}),Y.attr("title",p.clearText),Y.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),ue=!0,De(),u&&Re(!0)}),X.text(p.chooseText),X.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),Ue&&K.is(":focus")&&K.trigger("change"),K.hasClass("sp-validation-error")||(Re(!0),Se())}),ee.text(p.showPaletteOnly?p.togglePaletteMoreText:p.togglePaletteLessText),ee.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),p.showPaletteOnly=!p.showPaletteOnly,p.showPaletteOnly||u||B.css("left","-="+(U.outerWidth(!0)+5)),he()}),We(G,function(e,t,n){T=e/w,ue=!1,n.shiftKey&&(T=Math.round(10*T)/10),De()},ye,be),We(N,function(e,t){S=parseFloat(t/x),ue=!1,p.showAlpha||(T=1),De()},ye,be),We(Q,function(e,t,n){var i,a,o;n.shiftKey?M||(i=A*y,a=b-L*b,o=Math.abs(e-i)>Math.abs(t-a),M=o?"x":"y"):M=null;var s=!M||"y"===M;M&&"x"!==M||(A=parseFloat(e/y)),s&&(L=parseFloat((b-t)/b)),ue=!1,p.showAlpha||(T=1),De()},ye,be),re?(Le(re),Ee(),ce=p.preferredFormat||tinycolor(re).format,ge(re)):Ee(),u&&we();var n=Ue?"mousedown.spectrum":"click.spectrum touchstart.spectrum";J.delegate(".sp-thumb-el",n,t),V.delegate(".sp-thumb-el:nth-child(1)",n,{ignore:!0},t)}();var Me={show:we,hide:Se,toggle:xe,reflow:Pe,option:function(e,t){return e===je?Ie.extend({},p):t===je?p[e]:(p[e]=t,"preferredFormat"===e&&(ce=p.preferredFormat),void he())},enable:function(){F=!1,j.attr("disabled",!1),oe.removeClass("sp-disabled")},disable:$e,offset:function(e){p.offset=e,Pe()},set:function(e){Le(e),Re()},get:Te,destroy:function(){j.show(),oe.unbind("click.spectrum touchstart.spectrum"),B.remove(),ae.remove(),Be[Me.id]=null},container:B};return Me.id=Be.push(Me)-1,Me}function n(){}function ze(e){e.stopPropagation()}function Ge(e,t){var n=Array.prototype.slice,i=n.call(arguments,2);return function(){return e.apply(t,i.concat(n.call(arguments)))}}function We(s,r,t,e){r=r||function(){},t=t||function(){},e=e||function(){};var l=document,c=!1,p={},u=0,d=0,h="ontouchstart"in window,n={};function m(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function i(e){if(c){if(Ue&&l.documentMode<9&&!e.button)return g();var t=e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0],n=t&&t.pageX||e.pageX,i=t&&t.pageY||e.pageY,a=Math.max(0,Math.min(n-p.left,d)),o=Math.max(0,Math.min(i-p.top,u));h&&m(e),r.apply(s,[a,o,e])}}function g(){c&&(Ie(l).unbind(n),Ie(l.body).removeClass("sp-dragging"),setTimeout(function(){e.apply(s,arguments)},0)),c=!1}n.selectstart=m,n.dragstart=m,n["touchmove mousemove"]=i,n["touchend mouseup"]=g,Ie(s).bind("touchstart mousedown",function(e){(e.which?3==e.which:2==e.button)||c||!1!==t.apply(s,arguments)&&(c=!0,u=Ie(s).height(),d=Ie(s).width(),p=Ie(s).offset(),Ie(l).bind(n),Ie(l.body).addClass("sp-dragging"),i(e),m(e))})}function Ke(){return Ie.fn.spectrum.inputTypeColorSupport()}var s="spectrum.id";Ie.fn.spectrum=function(n,e){if("string"!=typeof n)return this.spectrum("destroy").each(function(){var e=o(this,Ie.extend({},n,Ie(this).data()));Ie(this).data(s,e.id)});var i=this,a=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=Be[Ie(this).data(s)];if(e){var t=e[n];if(!t)throw new Error("Spectrum: no such method: '"+n+"'");"get"==n?i=e.get():"container"==n?i=e.container:"option"==n?i=e.option.apply(e,a):"destroy"==n?(e.destroy(),Ie(this).removeData(s)):t.apply(e,a)}}),i},Ie.fn.spectrum.load=!0,Ie.fn.spectrum.loadOpts={},Ie.fn.spectrum.draggable=We,Ie.fn.spectrum.defaults=Fe,Ie.fn.spectrum.inputTypeColorSupport=function e(){var t;return void 0===e._cachedResult&&(t=Ie("<input type='color'/>")[0],e._cachedResult="color"===t.type&&""!==t.value),e._cachedResult},Ie.spectrum={},Ie.spectrum.localization={},Ie.spectrum.palettes={},Ie.fn.spectrum.processNativeColorInputs=function(){var e=Ie("input[type=color]");e.length&&!Ke()&&e.spectrum({preferredFormat:"hex6"})},function(){var o=/^[\s,#]+/,s=/\s+$/,i=0,c=Math,r=c.round,p=c.min,u=c.max,e=c.random,d=function(e,t){if(t=t||{},(e=e||"")instanceof d)return e;if(!(this instanceof d))return new d(e,t);var n=function(e){var t={r:0,g:0,b:0},n=1,i=!1,a=!1;"string"==typeof e&&(e=function(e){e=e.replace(o,"").replace(s,"").toLowerCase();var t,n=!1;if(A[e])e=A[e],n=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=j.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=j.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=j.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=j.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=j.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=j.hsva.exec(e))return{h:t[1],s:t[2],v:t[3],a:t[4]};if(t=j.hex8.exec(e))return{a:function(e){return O(e)/255}(t[1]),r:O(t[2]),g:O(t[3]),b:O(t[4]),format:n?"name":"hex8"};if(t=j.hex6.exec(e))return{r:O(t[1]),g:O(t[2]),b:O(t[3]),format:n?"name":"hex"};if(t=j.hex3.exec(e))return{r:O(t[1]+""+t[1]),g:O(t[2]+""+t[2]),b:O(t[3]+""+t[3]),format:n?"name":"hex"};return!1}(e));"object"==typeof e&&(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")?(t=function(e,t,n){return{r:255*D(e,255),g:255*D(t,255),b:255*D(n,255)}}(e.r,e.g,e.b),i=!0,a="%"===String(e.r).substr(-1)?"prgb":"rgb"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")?(e.s=P(e.s),e.v=P(e.v),t=function(e,t,n){e=6*D(e,360),t=D(t,100),n=D(n,100);var i=c.floor(e),a=e-i,o=n*(1-t),s=n*(1-a*t),r=n*(1-(1-a)*t),l=i%6;return{r:255*[n,s,o,o,r,n][l],g:255*[r,n,n,s,o,o][l],b:255*[o,o,r,n,n,s][l]}}(e.h,e.s,e.v),i=!0,a="hsv"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")&&(e.s=P(e.s),e.l=P(e.l),t=function(e,t,n){var i,a,o;function s(e,t,n){return n<0&&(n+=1),1<n&&--n,n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}{var r,l;e=D(e,360),t=D(t,100),n=D(n,100),0===t?i=a=o=n:(i=s(l=2*n-(r=n<.5?n*(1+t):n+t-n*t),r,e+1/3),a=s(l,r,e),o=s(l,r,e-1/3))}return{r:255*i,g:255*a,b:255*o}}(e.h,e.s,e.l),i=!0,a="hsl"),e.hasOwnProperty("a")&&(n=e.a));return n=T(n),{ok:i,format:e.format||a,r:p(255,u(t.r,0)),g:p(255,u(t.g,0)),b:p(255,u(t.b,0)),a:n}}(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=r(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=r(this._r)),this._g<1&&(this._g=r(this._g)),this._b<1&&(this._b=r(this._b)),this._ok=n.ok,this._tc_id=i++};function a(e,t,n){e=D(e,255),t=D(t,255),n=D(n,255);var i,a=u(e,t,n),o=p(e,t,n),s=(a+o)/2;if(a==o)i=l=0;else{var r=a-o,l=.5<s?r/(2-a-o):r/(a+o);switch(a){case e:i=(t-n)/r+(t<n?6:0);break;case t:i=(n-e)/r+2;break;case n:i=(e-t)/r+4}i/=6}return{h:i,s:l,l:s}}function l(e,t,n){e=D(e,255),t=D(t,255),n=D(n,255);var i,a=u(e,t,n),o=p(e,t,n),s=a,r=a-o,l=0===a?0:r/a;if(a==o)i=0;else{switch(a){case e:i=(t-n)/r+(t<n?6:0);break;case t:i=(n-e)/r+2;break;case n:i=(e-t)/r+4}i/=6}return{h:i,s:l,v:s}}function t(e,t,n,i){var a=[R(r(e).toString(16)),R(r(t).toString(16)),R(r(n).toString(16))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function h(e,t,n,i){var a;return[R((a=i,Math.round(255*parseFloat(a)).toString(16))),R(r(e).toString(16)),R(r(t).toString(16)),R(r(n).toString(16))].join("")}function n(e,t){t=0===t?0:t||10;var n=d(e).toHsl();return n.s-=t/100,n.s=E(n.s),d(n)}function m(e,t){t=0===t?0:t||10;var n=d(e).toHsl();return n.s+=t/100,n.s=E(n.s),d(n)}function g(e){return d(e).desaturate(100)}function f(e,t){t=0===t?0:t||10;var n=d(e).toHsl();return n.l+=t/100,n.l=E(n.l),d(n)}function v(e,t){t=0===t?0:t||10;var n=d(e).toRgb();return n.r=u(0,p(255,n.r-r(-t/100*255))),n.g=u(0,p(255,n.g-r(-t/100*255))),n.b=u(0,p(255,n.b-r(-t/100*255))),d(n)}function y(e,t){t=0===t?0:t||10;var n=d(e).toHsl();return n.l-=t/100,n.l=E(n.l),d(n)}function b(e,t){var n=d(e).toHsl(),i=(r(n.h)+t)%360;return n.h=i<0?360+i:i,d(n)}function _(e){var t=d(e).toHsl();return t.h=(t.h+180)%360,d(t)}function x(e){var t=d(e).toHsl(),n=t.h;return[d(e),d({h:(n+120)%360,s:t.s,l:t.l}),d({h:(n+240)%360,s:t.s,l:t.l})]}function w(e){var t=d(e).toHsl(),n=t.h;return[d(e),d({h:(n+90)%360,s:t.s,l:t.l}),d({h:(n+180)%360,s:t.s,l:t.l}),d({h:(n+270)%360,s:t.s,l:t.l})]}function k(e){var t=d(e).toHsl(),n=t.h;return[d(e),d({h:(n+72)%360,s:t.s,l:t.l}),d({h:(n+216)%360,s:t.s,l:t.l})]}function C(e,t,n){t=t||6,n=n||30;var i=d(e).toHsl(),a=360/n,o=[d(e)];for(i.h=(i.h-(a*t>>1)+720)%360;--t;)i.h=(i.h+a)%360,o.push(d(i));return o}function S(e,t){t=t||6;for(var n=d(e).toHsv(),i=n.h,a=n.s,o=n.v,s=[],r=1/t;t--;)s.push(d({h:i,s:a,v:o})),o=(o+r)%1;return s}d.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},setAlpha:function(e){return this._a=T(e),this._roundA=r(100*this._a)/100,this},toHsv:function(){var e=l(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=l(this._r,this._g,this._b),t=r(360*e.h),n=r(100*e.s),i=r(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+i+"%)":"hsva("+t+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=a(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=a(this._r,this._g,this._b),t=r(360*e.h),n=r(100*e.s),i=r(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+i+"%)":"hsla("+t+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return t(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return h(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:r(this._r),g:r(this._g),b:r(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+r(this._r)+", "+r(this._g)+", "+r(this._b)+")":"rgba("+r(this._r)+", "+r(this._g)+", "+r(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:r(100*D(this._r,255))+"%",g:r(100*D(this._g,255))+"%",b:r(100*D(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+r(100*D(this._r,255))+"%, "+r(100*D(this._g,255))+"%, "+r(100*D(this._b,255))+"%)":"rgba("+r(100*D(this._r,255))+"%, "+r(100*D(this._g,255))+"%, "+r(100*D(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&L[t(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+h(this._r,this._g,this._b,this._a),n=t,i=this._gradientType?"GradientType = 1, ":"";return e&&(n=d(e).toHex8String()),"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,i=this._a<1&&0<=this._a;return t||!i||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(f,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(y,arguments)},desaturate:function(){return this._applyModification(n,arguments)},saturate:function(){return this._applyModification(m,arguments)},greyscale:function(){return this._applyModification(g,arguments)},spin:function(){return this._applyModification(b,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(C,arguments)},complement:function(){return this._applyCombination(_,arguments)},monochromatic:function(){return this._applyCombination(S,arguments)},splitcomplement:function(){return this._applyCombination(k,arguments)},triad:function(){return this._applyCombination(x,arguments)},tetrad:function(){return this._applyCombination(w,arguments)}},d.fromRatio=function(e,t){if("object"==typeof e){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]="a"===i?e[i]:P(e[i]));e=n}return d(e,t)},d.equals=function(e,t){return!(!e||!t)&&d(e).toRgbString()==d(t).toRgbString()},d.random=function(){return d.fromRatio({r:e(),g:e(),b:e()})},d.mix=function(e,t,n){n=0===n?0:n||50;var i=d(e).toRgb(),a=d(t).toRgb(),o=n/100,s=2*o-1,r=a.a-i.a,l=s*r==-1?s:(s+r)/(1+s*r),c=1-(l=(l+1)/2),p={r:a.r*l+i.r*c,g:a.g*l+i.g*c,b:a.b*l+i.b*c,a:a.a*o+i.a*(1-o)};return d(p)},d.readability=function(e,t){var n=d(e),i=d(t),a=n.toRgb(),o=i.toRgb(),s=n.getBrightness(),r=i.getBrightness(),l=Math.max(a.r,o.r)-Math.min(a.r,o.r)+Math.max(a.g,o.g)-Math.min(a.g,o.g)+Math.max(a.b,o.b)-Math.min(a.b,o.b);return{brightness:Math.abs(s-r),color:l}},d.isReadable=function(e,t){var n=d.readability(e,t);return 125<n.brightness&&500<n.color},d.mostReadable=function(e,t){for(var n=null,i=0,a=!1,o=0;o<t.length;o++){var s=d.readability(e,t[o]),r=125<s.brightness&&500<s.color,l=s.brightness/125*3+s.color/500;(r&&!a||r&&a&&i<l||!r&&!a&&i<l)&&(a=r,i=l,n=d(t[o]))}return n};var A=d.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},L=d.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(A);function T(e){return e=parseFloat(e),(isNaN(e)||e<0||1<e)&&(e=1),e}function D(e,t){var n;"string"==typeof(n=e)&&-1!=n.indexOf(".")&&1===parseFloat(n)&&(e="100%");var i,a="string"==typeof(i=e)&&-1!=i.indexOf("%");return e=p(t,u(0,parseFloat(e))),a&&(e=parseInt(e*t,10)/100),c.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function E(e){return p(1,u(0,e))}function O(e){return parseInt(e,16)}function R(e){return 1==e.length?"0"+e:""+e}function P(e){return e<=1&&(e=100*e+"%"),e}var $,M,I,j=(M="[\\s|\\(]+("+($="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+$+")[,|\\s]+("+$+")\\s*\\)?",I="[\\s|\\(]+("+$+")[,|\\s]+("+$+")[,|\\s]+("+$+")[,|\\s]+("+$+")\\s*\\)?",{rgb:new RegExp("rgb"+M),rgba:new RegExp("rgba"+I),hsl:new RegExp("hsl"+M),hsla:new RegExp("hsla"+I),hsv:new RegExp("hsv"+M),hsva:new RegExp("hsva"+I),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});window.tinycolor=d}(),Ie(function(){Ie.fn.spectrum.load&&Ie.fn.spectrum.processNativeColorInputs()})}),function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(e,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(e)),n(t),t}:n(jQuery)}(function(t){var e,n,i,a,h,o,s,m,g,f,v,y,b,r,l,_,c=(t&&t.fn&&t.fn.select2&&t.fn.select2.amd&&(e=t.fn.select2.amd),e&&e.requirejs||(e?i=e:e={},f={},v={},y={},b={},r=Object.prototype.hasOwnProperty,l=[].slice,_=/\.js$/,m=function(e,t){var n,i,a=u(e),o=a[0],s=t[1];return e=a[1],o&&(n=k(o=p(o,s))),o?e=n&&n.normalize?n.normalize(e,(i=s,function(e){return p(e,i)})):p(e,s):(o=(a=u(e=p(e,s)))[0],e=a[1],o&&(n=k(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:n}},g={require:function(e){return w(e)},exports:function(e){var t=f[e];return void 0!==t?t:f[e]={}},module:function(e){return{id:e,uri:"",exports:f[e],config:(t=e,function(){return y&&y.config&&y.config[t]||{}})};var t}},o=function(e,t,n,i){var a,o,s,r,l,c,p=[],u=typeof n,d=C(i=i||e);if("undefined"==u||"function"==u){for(t=!t.length&&n.length?["require","exports","module"]:t,l=0;l<t.length;l+=1)if("require"===(o=(r=m(t[l],d)).f))p[l]=g.require(e);else if("exports"===o)p[l]=g.exports(e),c=!0;else if("module"===o)a=p[l]=g.module(e);else if(x(f,o)||x(v,o)||x(b,o))p[l]=k(o);else{if(!r.p)throw new Error(e+" missing "+o);r.p.load(r.n,w(i,!0),function(t){return function(e){f[t]=e}}(o),{}),p[l]=f[o]}s=n?n.apply(f[e],p):void 0,e&&(a&&a.exports!==h&&a.exports!==f[e]?f[e]=a.exports:s===h&&c||(f[e]=s))}else e&&(f[e]=n)},n=i=s=function(e,t,n,i,a){if("string"==typeof e)return g[e]?g[e](t):k(m(e,C(t)).f);if(!e.splice){if((y=e).deps&&s(y.deps,y.callback),!t)return;t.splice?(e=t,t=n,n=null):e=h}return t=t||function(){},"function"==typeof n&&(n=i,i=a),i?o(h,e,t,n):setTimeout(function(){o(h,e,t,n)},4),s},s.config=function(e){return s(e)},n._defined=f,(a=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),x(f,e)||x(v,e)||(v[e]=[e,t,n])}).amd={jQuery:!0},e.requirejs=n,e.require=i,e.define=a),e.define("almond",function(){}),e.define("jquery",[],function(){var e=t||$;return null==e&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),e}),e.define("select2/utils",["jquery"],function(o){var a={};function c(e){var t=e.prototype,n=[];for(var i in t)"function"==typeof t[i]&&"constructor"!==i&&n.push(i);return n}function e(){this.listeners={}}a.Extend=function(e,t){var n={}.hasOwnProperty;function i(){this.constructor=e}for(var a in t)n.call(t,a)&&(e[a]=t[a]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},a.Decorate=function(i,a){var e=c(a),t=c(i);function o(){var e=Array.prototype.unshift,t=a.prototype.constructor.length,n=i.prototype.constructor;0<t&&(e.call(arguments,i.prototype.constructor),n=a.prototype.constructor),n.apply(this,arguments)}a.displayName=i.displayName,o.prototype=new function(){this.constructor=o};for(var n=0;n<t.length;n++){var s=t[n];o.prototype[s]=i.prototype[s]}for(var r=0;r<e.length;r++){var l=e[r];o.prototype[l]=function(e){var t=function(){};e in o.prototype&&(t=o.prototype[e]);var n=a.prototype[e];return function(){return Array.prototype.unshift.call(arguments,t),n.apply(this,arguments)}}(l)}return o},e.prototype.on=function(e,t){this.listeners=this.listeners||{},e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t]},e.prototype.trigger=function(e){var t=Array.prototype.slice,n=t.call(arguments,1);this.listeners=this.listeners||{},null==n&&(n=[]),0===n.length&&n.push({}),(n[0]._type=e)in this.listeners&&this.invoke(this.listeners[e],t.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},e.prototype.invoke=function(e,t){for(var n=0,i=e.length;n<i;n++)e[n].apply(this,t)},a.Observable=e,a.generateChars=function(e){for(var t="",n=0;n<e;n++)t+=Math.floor(36*Math.random()).toString(36);return t},a.bind=function(e,t){return function(){e.apply(t,arguments)}},a._convertData=function(e){for(var t in e){var n=t.split("-"),i=e;if(1!==n.length){for(var a=0;a<n.length;a++){var o=n[a];(o=o.substring(0,1).toLowerCase()+o.substring(1))in i||(i[o]={}),a==n.length-1&&(i[o]=e[t]),i=i[o]}delete e[t]}}return e},a.hasScroll=function(e,t){var n=o(t),i=t.style.overflowX,a=t.style.overflowY;return(i!==a||"hidden"!==a&&"visible"!==a)&&("scroll"===i||"scroll"===a||n.innerHeight()<t.scrollHeight||n.innerWidth()<t.scrollWidth)},a.escapeMarkup=function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof e?e:String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})},a.appendMany=function(e,t){var n;"1.7"===o.fn.jquery.substr(0,3)&&(n=o(),o.map(t,function(e){n=n.add(e)}),t=n),e.append(t)},a.__cache={};var n=0;return a.GetUniqueElementId=function(e){var t=e.getAttribute("data-select2-id");return null==t&&(e.id?(t=e.id,e.setAttribute("data-select2-id",t)):(e.setAttribute("data-select2-id",++n),t=n.toString())),t},a.StoreData=function(e,t,n){var i=a.GetUniqueElementId(e);a.__cache[i]||(a.__cache[i]={}),a.__cache[i][t]=n},a.GetData=function(e,t){var n=a.GetUniqueElementId(e);return t?a.__cache[n]&&null!=a.__cache[n][t]?a.__cache[n][t]:o(e).data(t):a.__cache[n]},a.RemoveData=function(e){var t=a.GetUniqueElementId(e);null!=a.__cache[t]&&delete a.__cache[t],e.removeAttribute("data-select2-id")},a}),e.define("select2/results",["jquery","./utils"],function(h,m){function i(e,t,n){this.$element=e,this.data=n,this.options=t,i.__super__.constructor.call(this)}return m.Extend(i,m.Observable),i.prototype.render=function(){var e=h('<ul class="select2-results__options" role="listbox"></ul>');return this.options.get("multiple")&&e.attr("aria-multiselectable","true"),this.$results=e},i.prototype.clear=function(){this.$results.empty()},i.prototype.displayMessage=function(e){var t=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var n=h('<li role="alert" aria-live="assertive" class="select2-results__option"></li>'),i=this.options.get("translations").get(e.message);n.append(t(i(e.args))),n[0].className+=" select2-results__message",this.$results.append(n)},i.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},i.prototype.append=function(e){this.hideLoading();var t=[];if(null!=e.results&&0!==e.results.length){e.results=this.sort(e.results);for(var n=0;n<e.results.length;n++){var i=e.results[n],a=this.option(i);t.push(a)}this.$results.append(t)}else 0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"})},i.prototype.position=function(e,t){t.find(".select2-results").append(e)},i.prototype.sort=function(e){return this.options.get("sorter")(e)},i.prototype.highlightFirstItem=function(){var e=this.$results.find(".select2-results__option[aria-selected]"),t=e.filter("[aria-selected=true]");0<t.length?t.first().trigger("mouseenter"):e.first().trigger("mouseenter"),this.ensureHighlightVisible()},i.prototype.setClasses=function(){var t=this;this.data.current(function(e){var i=h.map(e,function(e){return e.id.toString()});t.$results.find(".select2-results__option[aria-selected]").each(function(){var e=h(this),t=m.GetData(this,"data"),n=""+t.id;null!=t.element&&t.element.selected||null==t.element&&-1<h.inArray(n,i)?e.attr("aria-selected","true"):e.attr("aria-selected","false")})})},i.prototype.showLoading=function(e){this.hideLoading();var t={disabled:!0,loading:!0,text:this.options.get("translations").get("searching")(e)},n=this.option(t);n.className+=" loading-results",this.$results.prepend(n)},i.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},i.prototype.option=function(e){var t=document.createElement("li");t.className="select2-results__option";var n={role:"option","aria-selected":"false"},i=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector||window.Element.prototype.webkitMatchesSelector;for(var a in(null!=e.element&&i.call(e.element,":disabled")||null==e.element&&e.disabled)&&(delete n["aria-selected"],n["aria-disabled"]="true"),null==e.id&&delete n["aria-selected"],null!=e._resultId&&(t.id=e._resultId),e.title&&(t.title=e.title),e.children&&(n.role="group",n["aria-label"]=e.text,delete n["aria-selected"]),n){var o=n[a];t.setAttribute(a,o)}if(e.children){var s=h(t),r=document.createElement("strong");r.className="select2-results__group",h(r),this.template(e,r);for(var l=[],c=0;c<e.children.length;c++){var p=e.children[c],u=this.option(p);l.push(u)}var d=h("<ul></ul>",{class:"select2-results__options select2-results__options--nested"});d.append(l),s.append(r),s.append(d)}else this.template(e,t);return m.StoreData(t,"data",e),t},i.prototype.bind=function(t,e){var l=this,n=t.id+"-results";this.$results.attr("id",n),t.on("results:all",function(e){l.clear(),l.append(e.data),t.isOpen()&&(l.setClasses(),l.highlightFirstItem())}),t.on("results:append",function(e){l.append(e.data),t.isOpen()&&l.setClasses()}),t.on("query",function(e){l.hideMessages(),l.showLoading(e)}),t.on("select",function(){t.isOpen()&&(l.setClasses(),l.options.get("scrollAfterSelect")&&l.highlightFirstItem())}),t.on("unselect",function(){t.isOpen()&&(l.setClasses(),l.options.get("scrollAfterSelect")&&l.highlightFirstItem())}),t.on("open",function(){l.$results.attr("aria-expanded","true"),l.$results.attr("aria-hidden","false"),l.setClasses(),l.ensureHighlightVisible()}),t.on("close",function(){l.$results.attr("aria-expanded","false"),l.$results.attr("aria-hidden","true"),l.$results.removeAttr("aria-activedescendant")}),t.on("results:toggle",function(){var e=l.getHighlightedResults();0!==e.length&&e.trigger("mouseup")}),t.on("results:select",function(){var e,t=l.getHighlightedResults();0!==t.length&&(e=m.GetData(t[0],"data"),"true"==t.attr("aria-selected")?l.trigger("close",{}):l.trigger("select",{data:e}))}),t.on("results:previous",function(){var e,t,n,i,a,o=l.getHighlightedResults(),s=l.$results.find("[aria-selected]"),r=s.index(o);r<=0||(e=r-1,0===o.length&&(e=0),(t=s.eq(e)).trigger("mouseenter"),n=l.$results.offset().top,i=t.offset().top,a=l.$results.scrollTop()+(i-n),0===e?l.$results.scrollTop(0):i-n<0&&l.$results.scrollTop(a))}),t.on("results:next",function(){var e,t,n,i,a=l.getHighlightedResults(),o=l.$results.find("[aria-selected]"),s=o.index(a)+1;s>=o.length||((e=o.eq(s)).trigger("mouseenter"),t=l.$results.offset().top+l.$results.outerHeight(!1),n=e.offset().top+e.outerHeight(!1),i=l.$results.scrollTop()+n-t,0===s?l.$results.scrollTop(0):t<n&&l.$results.scrollTop(i))}),t.on("results:focus",function(e){e.element.addClass("select2-results__option--highlighted")}),t.on("results:message",function(e){l.displayMessage(e)}),h.fn.mousewheel&&this.$results.on("mousewheel",function(e){var t=l.$results.scrollTop(),n=l.$results.get(0).scrollHeight-t+e.deltaY,i=0<e.deltaY&&t-e.deltaY<=0,a=e.deltaY<0&&n<=l.$results.height();i?(l.$results.scrollTop(0),e.preventDefault(),e.stopPropagation()):a&&(l.$results.scrollTop(l.$results.get(0).scrollHeight-l.$results.height()),e.preventDefault(),e.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(e){var t=h(this),n=m.GetData(this,"data");"true"!==t.attr("aria-selected")?l.trigger("select",{originalEvent:e,data:n}):l.options.get("multiple")?l.trigger("unselect",{originalEvent:e,data:n}):l.trigger("close",{})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(e){var t=m.GetData(this,"data");l.getHighlightedResults().removeClass("select2-results__option--highlighted"),l.trigger("results:focus",{data:t,element:h(this)})})},i.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},i.prototype.destroy=function(){this.$results.remove()},i.prototype.ensureHighlightVisible=function(){var e,t,n,i,a,o=this.getHighlightedResults();0!==o.length&&(e=this.$results.find("[aria-selected]").index(o),t=this.$results.offset().top,n=o.offset().top,i=this.$results.scrollTop()+(n-t),a=n-t,i-=2*o.outerHeight(!1),e<=2?this.$results.scrollTop(0):(a>this.$results.outerHeight()||a<0)&&this.$results.scrollTop(i))},i.prototype.template=function(e,t){var n=this.options.get("templateResult"),i=this.options.get("escapeMarkup"),a=n(e,t);null==a?t.style.display="none":"string"==typeof a?t.innerHTML=i(a):h(t).append(a)},i}),e.define("select2/keys",[],function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}}),e.define("select2/selection/base",["jquery","../utils","../keys"],function(n,i,a){function o(e,t){this.$element=e,this.options=t,o.__super__.constructor.call(this)}return i.Extend(o,i.Observable),o.prototype.render=function(){var e=n('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=i.GetData(this.$element[0],"old-tabindex")?this._tabindex=i.GetData(this.$element[0],"old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),e.attr("title",this.$element.attr("title")),e.attr("tabindex",this._tabindex),e.attr("aria-disabled","false"),this.$selection=e},o.prototype.bind=function(e,t){var n=this,i=e.id+"-results";this.container=e,this.$selection.on("focus",function(e){n.trigger("focus",e)}),this.$selection.on("blur",function(e){n._handleBlur(e)}),this.$selection.on("keydown",function(e){n.trigger("keypress",e),e.which===a.SPACE&&e.preventDefault()}),e.on("results:focus",function(e){n.$selection.attr("aria-activedescendant",e.data._resultId)}),e.on("selection:update",function(e){n.update(e.data)}),e.on("open",function(){n.$selection.attr("aria-expanded","true"),n.$selection.attr("aria-owns",i),n._attachCloseHandler(e)}),e.on("close",function(){n.$selection.attr("aria-expanded","false"),n.$selection.removeAttr("aria-activedescendant"),n.$selection.removeAttr("aria-owns"),n.$selection.trigger("focus"),n._detachCloseHandler(e)}),e.on("enable",function(){n.$selection.attr("tabindex",n._tabindex),n.$selection.attr("aria-disabled","false")}),e.on("disable",function(){n.$selection.attr("tabindex","-1"),n.$selection.attr("aria-disabled","true")})},o.prototype._handleBlur=function(e){var t=this;window.setTimeout(function(){document.activeElement==t.$selection[0]||n.contains(t.$selection[0],document.activeElement)||t.trigger("blur",e)},1)},o.prototype._attachCloseHandler=function(e){n(document.body).on("mousedown.select2."+e.id,function(e){var t=n(e.target).closest(".select2");n(".select2.select2-container--open").each(function(){this!=t[0]&&i.GetData(this,"element").select2("close")})})},o.prototype._detachCloseHandler=function(e){n(document.body).off("mousedown.select2."+e.id)},o.prototype.position=function(e,t){t.find(".selection").append(e)},o.prototype.destroy=function(){this._detachCloseHandler(this.container)},o.prototype.update=function(e){throw new Error("The `update` method must be defined in child classes.")},o.prototype.isEnabled=function(){return!this.isDisabled()},o.prototype.isDisabled=function(){return this.options.get("disabled")},o}),e.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(e,t,n,i){function a(){a.__super__.constructor.apply(this,arguments)}return n.Extend(a,t),a.prototype.render=function(){var e=a.__super__.render.call(this);return e.addClass("select2-selection--single"),e.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),e},a.prototype.bind=function(t,e){var n=this;a.__super__.bind.apply(this,arguments);var i=t.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",i).attr("role","textbox").attr("aria-readonly","true"),this.$selection.attr("aria-labelledby",i),this.$selection.on("mousedown",function(e){1===e.which&&n.trigger("toggle",{originalEvent:e})}),this.$selection.on("focus",function(e){}),this.$selection.on("blur",function(e){}),t.on("focus",function(e){t.isOpen()||n.$selection.trigger("focus")})},a.prototype.clear=function(){var e=this.$selection.find(".select2-selection__rendered");e.empty(),e.removeAttr("title")},a.prototype.display=function(e,t){var n=this.options.get("templateSelection");return this.options.get("escapeMarkup")(n(e,t))},a.prototype.selectionContainer=function(){return e("<span></span>")},a.prototype.update=function(e){var t,n,i,a;0!==e.length?(t=e[0],n=this.$selection.find(".select2-selection__rendered"),i=this.display(t,n),n.empty().append(i),(a=t.title||t.text)?n.attr("title",a):n.removeAttr("title")):this.clear()},a}),e.define("select2/selection/multiple",["jquery","./base","../utils"],function(a,e,l){function n(e,t){n.__super__.constructor.apply(this,arguments)}return l.Extend(n,e),n.prototype.render=function(){var e=n.__super__.render.call(this);return e.addClass("select2-selection--multiple"),e.html('<ul class="select2-selection__rendered"></ul>'),e},n.prototype.bind=function(e,t){var i=this;n.__super__.bind.apply(this,arguments),this.$selection.on("click",function(e){i.trigger("toggle",{originalEvent:e})}),this.$selection.on("click",".select2-selection__choice__remove",function(e){var t,n;i.isDisabled()||(t=a(this).parent(),n=l.GetData(t[0],"data"),i.trigger("unselect",{originalEvent:e,data:n}))})},n.prototype.clear=function(){var e=this.$selection.find(".select2-selection__rendered");e.empty(),e.removeAttr("title")},n.prototype.display=function(e,t){var n=this.options.get("templateSelection");return this.options.get("escapeMarkup")(n(e,t))},n.prototype.selectionContainer=function(){return a('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>')},n.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],n=0;n<e.length;n++){var i=e[n],a=this.selectionContainer(),o=this.display(i,a);a.append(o);var s=i.title||i.text;s&&a.attr("title",s),l.StoreData(a[0],"data",i),t.push(a)}var r=this.$selection.find(".select2-selection__rendered");l.appendMany(r,t)}},n}),e.define("select2/selection/placeholder",["../utils"],function(e){function t(e,t,n){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n)}return t.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},t.prototype.createPlaceholder=function(e,t){var n=this.selectionContainer();return n.html(this.display(t)),n.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),n},t.prototype.update=function(e,t){var n=1==t.length&&t[0].id!=this.placeholder.id;if(1<t.length||n)return e.call(this,t);this.clear();var i=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(i)},t}),e.define("select2/selection/allowClear",["jquery","../keys","../utils"],function(a,i,r){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(e){i._handleClear(e)}),t.on("keypress",function(e){i._handleKeyboardClear(e,t)})},e.prototype._handleClear=function(e,t){if(!this.isDisabled()){var n=this.$selection.find(".select2-selection__clear");if(0!==n.length){t.stopPropagation();var i=r.GetData(n[0],"data"),a=this.$element.val();this.$element.val(this.placeholder.id);var o={data:i};if(this.trigger("clear",o),o.prevented)this.$element.val(a);else{for(var s=0;s<i.length;s++)if(o={data:i[s]},this.trigger("unselect",o),o.prevented)return void this.$element.val(a);this.$element.trigger("input").trigger("change"),this.trigger("toggle",{})}}}},e.prototype._handleKeyboardClear=function(e,t,n){n.isOpen()||t.which!=i.DELETE&&t.which!=i.BACKSPACE||this._handleClear(t)},e.prototype.update=function(e,t){var n,i;e.call(this,t),0<this.$selection.find(".select2-selection__placeholder").length||0===t.length||(n=this.options.get("translations").get("removeAllItems"),i=a('<span class="select2-selection__clear" title="'+n()+'">&times;</span>'),r.StoreData(i[0],"data",t),this.$selection.find(".select2-selection__rendered").prepend(i))},e}),e.define("select2/selection/search",["jquery","../utils","../keys"],function(i,r,l){function e(e,t,n){e.call(this,t,n)}return e.prototype.render=function(e){var t=i('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="searchbox" aria-autocomplete="list" /></li>');this.$searchContainer=t,this.$search=t.find("input");var n=e.call(this);return this._transferTabIndex(),n},e.prototype.bind=function(e,t,n){var i=this,a=t.id+"-results";e.call(this,t,n),t.on("open",function(){i.$search.attr("aria-controls",a),i.$search.trigger("focus")}),t.on("close",function(){i.$search.val(""),i.$search.removeAttr("aria-controls"),i.$search.removeAttr("aria-activedescendant"),i.$search.trigger("focus")}),t.on("enable",function(){i.$search.prop("disabled",!1),i._transferTabIndex()}),t.on("disable",function(){i.$search.prop("disabled",!0)}),t.on("focus",function(e){i.$search.trigger("focus")}),t.on("results:focus",function(e){e.data._resultId?i.$search.attr("aria-activedescendant",e.data._resultId):i.$search.removeAttr("aria-activedescendant")}),this.$selection.on("focusin",".select2-search--inline",function(e){i.trigger("focus",e)}),this.$selection.on("focusout",".select2-search--inline",function(e){i._handleBlur(e)}),this.$selection.on("keydown",".select2-search--inline",function(e){var t,n;e.stopPropagation(),i.trigger("keypress",e),i._keyUpPrevented=e.isDefaultPrevented(),e.which!==l.BACKSPACE||""!==i.$search.val()||0<(t=i.$searchContainer.prev(".select2-selection__choice")).length&&(n=r.GetData(t[0],"data"),i.searchRemoveChoice(n),e.preventDefault())}),this.$selection.on("click",".select2-search--inline",function(e){i.$search.val()&&e.stopPropagation()});var o=document.documentMode,s=o&&o<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(e){s?i.$selection.off("input.search input.searchcheck"):i.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(e){var t;s&&"input"===e.type?i.$selection.off("input.search input.searchcheck"):(t=e.which)!=l.SHIFT&&t!=l.CTRL&&t!=l.ALT&&t!=l.TAB&&i.handleSearch(e)})},e.prototype._transferTabIndex=function(e){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},e.prototype.createPlaceholder=function(e,t){this.$search.attr("placeholder",t.text)},e.prototype.update=function(e,t){var n=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),e.call(this,t),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),n&&this.$search.trigger("focus")},e.prototype.handleSearch=function(){var e;this.resizeSearch(),this._keyUpPrevented||(e=this.$search.val(),this.trigger("query",{term:e})),this._keyUpPrevented=!1},e.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t}),this.$search.val(t.text),this.handleSearch()},e.prototype.resizeSearch=function(){this.$search.css("width","25px");var e="";e=""!==this.$search.attr("placeholder")?this.$selection.find(".select2-selection__rendered").width():.75*(this.$search.val().length+1)+"em",this.$search.css("width",e)},e}),e.define("select2/selection/eventRelay",["jquery"],function(s){function e(){}return e.prototype.bind=function(e,t,n){var i=this,a=["open","opening","close","closing","select","selecting","unselect","unselecting","clear","clearing"],o=["opening","closing","selecting","unselecting","clearing"];e.call(this,t,n),t.on("*",function(e,t){var n;-1!==s.inArray(e,a)&&(t=t||{},n=s.Event("select2:"+e,{params:t}),i.$element.trigger(n),-1!==s.inArray(e,o)&&(t.prevented=n.isDefaultPrevented()))})},e}),e.define("select2/translation",["jquery","require"],function(t,n){function i(e){this.dict=e||{}}return i.prototype.all=function(){return this.dict},i.prototype.get=function(e){return this.dict[e]},i.prototype.extend=function(e){this.dict=t.extend({},e.all(),this.dict)},i._cache={},i.loadPath=function(e){var t;return e in i._cache||(t=n(e),i._cache[e]=t),new i(i._cache[e])},i}),e.define("select2/diacritics",[],function(){return{"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Œ":"OE","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","œ":"oe","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ώ":"ω","ς":"σ","’":"'"}}),e.define("select2/data/base",["../utils"],function(i){function n(e,t){n.__super__.constructor.call(this)}return i.Extend(n,i.Observable),n.prototype.current=function(e){throw new Error("The `current` method must be defined in child classes.")},n.prototype.query=function(e,t){throw new Error("The `query` method must be defined in child classes.")},n.prototype.bind=function(e,t){},n.prototype.destroy=function(){},n.prototype.generateResultId=function(e,t){var n=e.id+"-result-";return n+=i.generateChars(4),null!=t.id?n+="-"+t.id.toString():n+="-"+i.generateChars(4),n},n}),e.define("select2/data/select",["./base","../utils","jquery"],function(e,r,l){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return r.Extend(n,e),n.prototype.current=function(e){var n=[],i=this;this.$element.find(":selected").each(function(){var e=l(this),t=i.item(e);n.push(t)}),e(n)},n.prototype.select=function(a){var e,o=this;if(a.selected=!0,l(a.element).is("option"))return a.element.selected=!0,void this.$element.trigger("input").trigger("change");this.$element.prop("multiple")?this.current(function(e){var t=[];(a=[a]).push.apply(a,e);for(var n=0;n<a.length;n++){var i=a[n].id;-1===l.inArray(i,t)&&t.push(i)}o.$element.val(t),o.$element.trigger("input").trigger("change")}):(e=a.id,this.$element.val(e),this.$element.trigger("input").trigger("change"))},n.prototype.unselect=function(a){var o=this;if(this.$element.prop("multiple")){if(a.selected=!1,l(a.element).is("option"))return a.element.selected=!1,void this.$element.trigger("input").trigger("change");this.current(function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n].id;i!==a.id&&-1===l.inArray(i,t)&&t.push(i)}o.$element.val(t),o.$element.trigger("input").trigger("change")})}},n.prototype.bind=function(e,t){var n=this;(this.container=e).on("select",function(e){n.select(e.data)}),e.on("unselect",function(e){n.unselect(e.data)})},n.prototype.destroy=function(){this.$element.find("*").each(function(){r.RemoveData(this)})},n.prototype.query=function(i,e){var a=[],o=this;this.$element.children().each(function(){var e,t,n=l(this);(n.is("option")||n.is("optgroup"))&&(e=o.item(n),null!==(t=o.matches(i,e))&&a.push(t))}),e({results:a})},n.prototype.addOptions=function(e){r.appendMany(this.$element,e)},n.prototype.option=function(e){var t;e.children?(t=document.createElement("optgroup")).label=e.text:void 0!==(t=document.createElement("option")).textContent?t.textContent=e.text:t.innerText=e.text,void 0!==e.id&&(t.value=e.id),e.disabled&&(t.disabled=!0),e.selected&&(t.selected=!0),e.title&&(t.title=e.title);var n=l(t),i=this._normalizeItem(e);return i.element=t,r.StoreData(t,"data",i),n},n.prototype.item=function(e){var t={};if(null!=(t=r.GetData(e[0],"data")))return t;if(e.is("option"))t={id:e.val(),text:e.text(),disabled:e.prop("disabled"),selected:e.prop("selected"),title:e.prop("title")};else if(e.is("optgroup")){t={text:e.prop("label"),children:[],title:e.prop("title")};for(var n=e.children("option"),i=[],a=0;a<n.length;a++){var o=l(n[a]),s=this.item(o);i.push(s)}t.children=i}return(t=this._normalizeItem(t)).element=e[0],r.StoreData(e[0],"data",t),t},n.prototype._normalizeItem=function(e){return e!==Object(e)&&(e={id:e,text:e}),null!=(e=l.extend({},{text:""},e)).id&&(e.id=e.id.toString()),null!=e.text&&(e.text=e.text.toString()),null==e._resultId&&e.id&&null!=this.container&&(e._resultId=this.generateResultId(this.container,e)),l.extend({},{selected:!1,disabled:!1},e)},n.prototype.matches=function(e,t){return this.options.get("matcher")(e,t)},n}),e.define("select2/data/array",["./select","../utils","jquery"],function(e,h,m){function i(e,t){this._dataToConvert=t.get("data")||[],i.__super__.constructor.call(this,e,t)}return h.Extend(i,e),i.prototype.bind=function(e,t){i.__super__.bind.call(this,e,t),this.addOptions(this.convertToOptions(this._dataToConvert))},i.prototype.select=function(n){var e=this.$element.find("option").filter(function(e,t){return t.value==n.id.toString()});0===e.length&&(e=this.option(n),this.addOptions(e)),i.__super__.select.call(this,n)},i.prototype.convertToOptions=function(e){for(var t=this,n=this.$element.find("option"),i=n.map(function(){return t.item(m(this)).id}).get(),a=[],o=0;o<e.length;o++){var s,r,l,c,p,u,d=this._normalizeItem(e[o]);0<=m.inArray(d.id,i)?(s=n.filter(function(e){return function(){return m(this).val()==e.id}}(d)),r=this.item(s),l=m.extend(!0,{},d,r),c=this.option(l),s.replaceWith(c)):(p=this.option(d),d.children&&(u=this.convertToOptions(d.children),h.appendMany(p,u)),a.push(p))}return a},i}),e.define("select2/data/ajax",["./array","../utils","jquery"],function(e,t,o){function n(e,t){this.ajaxOptions=this._applyDefaults(t.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),n.__super__.constructor.call(this,e,t)}return t.Extend(n,e),n.prototype._applyDefaults=function(e){var t={data:function(e){return o.extend({},e,{q:e.term})},transport:function(e,t,n){var i=o.ajax(e);return i.then(t),i.fail(n),i}};return o.extend({},t,e,!0)},n.prototype.processResults=function(e){return e},n.prototype.query=function(n,i){var a=this;null!=this._request&&(o.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var t=o.extend({type:"GET"},this.ajaxOptions);function e(){var e=t.transport(t,function(e){var t=a.processResults(e,n);a.options.get("debug")&&window.console&&console.error&&(t&&t.results&&o.isArray(t.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),i(t)},function(){"status"in e&&(0===e.status||"0"===e.status)||a.trigger("results:message",{message:"errorLoading"})});a._request=e}"function"==typeof t.url&&(t.url=t.url.call(this.$element,n)),"function"==typeof t.data&&(t.data=t.data.call(this.$element,n)),this.ajaxOptions.delay&&null!=n.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(e,this.ajaxOptions.delay)):e()},n}),e.define("select2/data/tags",["jquery"],function(p){function e(e,t,n){var i=n.get("tags"),a=n.get("createTag");void 0!==a&&(this.createTag=a);var o=n.get("insertTag");if(void 0!==o&&(this.insertTag=o),e.call(this,t,n),p.isArray(i))for(var s=0;s<i.length;s++){var r=i[s],l=this._normalizeItem(r),c=this.option(l);this.$element.append(c)}}return e.prototype.query=function(e,c,p){var u=this;this._removeOldTags(),null!=c.term&&null==c.page?e.call(this,c,function e(t,n){for(var i=t.results,a=0;a<i.length;a++){var o=i[a],s=null!=o.children&&!e({results:o.children},!0);if((o.text||"").toUpperCase()===(c.term||"").toUpperCase()||s)return!n&&(t.data=i,void p(t))}if(n)return!0;var r,l=u.createTag(c);null!=l&&((r=u.option(l)).attr("data-select2-tag",!0),u.addOptions([r]),u.insertTag(i,l)),t.results=i,p(t)}):e.call(this,c,p)},e.prototype.createTag=function(e,t){var n=p.trim(t.term);return""===n?null:{id:n,text:n}},e.prototype.insertTag=function(e,t,n){t.unshift(n)},e.prototype._removeOldTags=function(e){this.$element.find("option[data-select2-tag]").each(function(){this.selected||p(this).remove()})},e}),e.define("select2/data/tokenizer",["jquery"],function(u){function e(e,t,n){var i=n.get("tokenizer");void 0!==i&&(this.tokenizer=i),e.call(this,t,n)}return e.prototype.bind=function(e,t,n){e.call(this,t,n),this.$search=t.dropdown.$search||t.selection.$search||n.find(".select2-search__field")},e.prototype.query=function(e,t,n){var a=this;t.term=t.term||"";var i=this.tokenizer(t,this.options,function(e){var t,n,i=a._normalizeItem(e);a.$element.find("option").filter(function(){return u(this).val()===i.id}).length||((t=a.option(i)).attr("data-select2-tag",!0),a._removeOldTags(),a.addOptions([t])),n=i,a.trigger("select",{data:n})});i.term!==t.term&&(this.$search.length&&(this.$search.val(i.term),this.$search.trigger("focus")),t.term=i.term),e.call(this,t,n)},e.prototype.tokenizer=function(e,t,n,i){for(var a=n.get("tokenSeparators")||[],o=t.term,s=0,r=this.createTag||function(e){return{id:e.term,text:e.term}};s<o.length;){var l,c,p=o[s];-1!==u.inArray(p,a)?(l=o.substr(0,s),null!=(c=r(u.extend({},t,{term:l})))?(i(c),o=o.substr(s+1)||"",s=0):s++):s++}return{term:o}},e}),e.define("select2/data/minimumInputLength",[],function(){function e(e,t,n){this.minimumInputLength=n.get("minimumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){t.term=t.term||"",t.term.length<this.minimumInputLength?this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:t.term,params:t}}):e.call(this,t,n)},e}),e.define("select2/data/maximumInputLength",[],function(){function e(e,t,n){this.maximumInputLength=n.get("maximumInputLength"),e.call(this,t,n)}return e.prototype.query=function(e,t,n){t.term=t.term||"",0<this.maximumInputLength&&t.term.length>this.maximumInputLength?this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:t.term,params:t}}):e.call(this,t,n)},e}),e.define("select2/data/maximumSelectionLength",[],function(){function e(e,t,n){this.maximumSelectionLength=n.get("maximumSelectionLength"),e.call(this,t,n)}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("select",function(){i._checkIfMaximumSelected()})},e.prototype.query=function(e,t,n){var i=this;this._checkIfMaximumSelected(function(){e.call(i,t,n)})},e.prototype._checkIfMaximumSelected=function(e,n){var i=this;this.current(function(e){var t=null!=e?e.length:0;0<i.maximumSelectionLength&&t>=i.maximumSelectionLength?i.trigger("results:message",{message:"maximumSelected",args:{maximum:i.maximumSelectionLength}}):n&&n()})},e}),e.define("select2/dropdown",["jquery","./utils"],function(t,e){function n(e,t){this.$element=e,this.options=t,n.__super__.constructor.call(this)}return e.Extend(n,e.Observable),n.prototype.render=function(){var e=t('<span class="select2-dropdown"><span class="select2-results"></span></span>');return e.attr("dir",this.options.get("dir")),this.$dropdown=e},n.prototype.bind=function(){},n.prototype.position=function(e,t){},n.prototype.destroy=function(){this.$dropdown.remove()},n}),e.define("select2/dropdown/search",["jquery","../utils"],function(o,e){function t(){}return t.prototype.render=function(e){var t=e.call(this),n=o('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="searchbox" aria-autocomplete="list" /></span>');return this.$searchContainer=n,this.$search=n.find("input"),t.prepend(n),t},t.prototype.bind=function(e,t,n){var i=this,a=t.id+"-results";e.call(this,t,n),this.$search.on("keydown",function(e){i.trigger("keypress",e),i._keyUpPrevented=e.isDefaultPrevented()}),this.$search.on("input",function(e){o(this).off("keyup")}),this.$search.on("keyup input",function(e){i.handleSearch(e)}),t.on("open",function(){i.$search.attr("tabindex",0),i.$search.attr("aria-controls",a),i.$search.trigger("focus"),window.setTimeout(function(){i.$search.trigger("focus")},0)}),t.on("close",function(){i.$search.attr("tabindex",-1),i.$search.removeAttr("aria-controls"),i.$search.removeAttr("aria-activedescendant"),i.$search.val(""),i.$search.trigger("blur")}),t.on("focus",function(){t.isOpen()||i.$search.trigger("focus")}),t.on("results:all",function(e){null!=e.query.term&&""!==e.query.term||(i.showSearch(e)?i.$searchContainer.removeClass("select2-search--hide"):i.$searchContainer.addClass("select2-search--hide"))}),t.on("results:focus",function(e){e.data._resultId?i.$search.attr("aria-activedescendant",e.data._resultId):i.$search.removeAttr("aria-activedescendant")})},t.prototype.handleSearch=function(e){var t;this._keyUpPrevented||(t=this.$search.val(),this.trigger("query",{term:t})),this._keyUpPrevented=!1},t.prototype.showSearch=function(e,t){return!0},t}),e.define("select2/dropdown/hidePlaceholder",[],function(){function e(e,t,n,i){this.placeholder=this.normalizePlaceholder(n.get("placeholder")),e.call(this,t,n,i)}return e.prototype.append=function(e,t){t.results=this.removePlaceholder(t.results),e.call(this,t)},e.prototype.normalizePlaceholder=function(e,t){return"string"==typeof t&&(t={id:"",text:t}),t},e.prototype.removePlaceholder=function(e,t){for(var n=t.slice(0),i=t.length-1;0<=i;i--){var a=t[i];this.placeholder.id===a.id&&n.splice(i,1)}return n},e}),e.define("select2/dropdown/infiniteScroll",["jquery"],function(n){function e(e,t,n,i){this.lastParams={},e.call(this,t,n,i),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return e.prototype.append=function(e,t){this.$loadingMore.remove(),this.loading=!1,e.call(this,t),this.showLoadingMore(t)&&(this.$results.append(this.$loadingMore),this.loadMoreIfNeeded())},e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("query",function(e){i.lastParams=e,i.loading=!0}),t.on("query:append",function(e){i.lastParams=e,i.loading=!0}),this.$results.on("scroll",this.loadMoreIfNeeded.bind(this))},e.prototype.loadMoreIfNeeded=function(){var e,t=n.contains(document.documentElement,this.$loadingMore[0]);!this.loading&&t&&(e=this.$results.offset().top+this.$results.outerHeight(!1),this.$loadingMore.offset().top+this.$loadingMore.outerHeight(!1)<=e+50&&this.loadMore())},e.prototype.loadMore=function(){this.loading=!0;var e=n.extend({},{page:1},this.lastParams);e.page++,this.trigger("query:append",e)},e.prototype.showLoadingMore=function(e,t){return t.pagination&&t.pagination.more},e.prototype.createLoadingMore=function(){var e=n('<li class="select2-results__option select2-results__option--load-more"role="option" aria-disabled="true"></li>'),t=this.options.get("translations").get("loadingMore");return e.html(t(this.lastParams)),e},e}),e.define("select2/dropdown/attachBody",["jquery","../utils"],function(m,r){function e(e,t,n){this.$dropdownParent=m(n.get("dropdownParent")||document.body),e.call(this,t,n)}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("open",function(){i._showDropdown(),i._attachPositioningHandler(t),i._bindContainerResultHandlers(t)}),t.on("close",function(){i._hideDropdown(),i._detachPositioningHandler(t)}),this.$dropdownContainer.on("mousedown",function(e){e.stopPropagation()})},e.prototype.destroy=function(e){e.call(this),this.$dropdownContainer.remove()},e.prototype.position=function(e,t,n){t.attr("class",n.attr("class")),t.removeClass("select2"),t.addClass("select2-container--open"),t.css({position:"absolute",top:-999999}),this.$container=n},e.prototype.render=function(e){var t=m("<span></span>"),n=e.call(this);return t.append(n),this.$dropdownContainer=t},e.prototype._hideDropdown=function(e){this.$dropdownContainer.detach()},e.prototype._bindContainerResultHandlers=function(e,t){var n;this._containerResultsHandlersBound||(n=this,t.on("results:all",function(){n._positionDropdown(),n._resizeDropdown()}),t.on("results:append",function(){n._positionDropdown(),n._resizeDropdown()}),t.on("results:message",function(){n._positionDropdown(),n._resizeDropdown()}),t.on("select",function(){n._positionDropdown(),n._resizeDropdown()}),t.on("unselect",function(){n._positionDropdown(),n._resizeDropdown()}),this._containerResultsHandlersBound=!0)},e.prototype._attachPositioningHandler=function(e,t){var n=this,i="scroll.select2."+t.id,a="resize.select2."+t.id,o="orientationchange.select2."+t.id,s=this.$container.parents().filter(r.hasScroll);s.each(function(){r.StoreData(this,"select2-scroll-position",{x:m(this).scrollLeft(),y:m(this).scrollTop()})}),s.on(i,function(e){var t=r.GetData(this,"select2-scroll-position");m(this).scrollTop(t.y)}),m(window).on(i+" "+a+" "+o,function(e){n._positionDropdown(),n._resizeDropdown()})},e.prototype._detachPositioningHandler=function(e,t){var n="scroll.select2."+t.id,i="resize.select2."+t.id,a="orientationchange.select2."+t.id;this.$container.parents().filter(r.hasScroll).off(n),m(window).off(n+" "+i+" "+a)},e.prototype._positionDropdown=function(){var e=m(window),t=this.$dropdown.hasClass("select2-dropdown--above"),n=this.$dropdown.hasClass("select2-dropdown--below"),i=null,a=this.$container.offset();a.bottom=a.top+this.$container.outerHeight(!1);var o={height:this.$container.outerHeight(!1)};o.top=a.top,o.bottom=a.top+o.height;var s=this.$dropdown.outerHeight(!1),r=e.scrollTop(),l=e.scrollTop()+e.height(),c=r<a.top-s,p=l>a.bottom+s,u={left:a.left,top:o.bottom},d=this.$dropdownParent;"static"===d.css("position")&&(d=d.offsetParent());var h={top:0,left:0};(m.contains(document.body,d[0])||d[0].isConnected)&&(h=d.offset()),u.top-=h.top,u.left-=h.left,t||n||(i="below"),p||!c||t?!c&&p&&t&&(i="below"):i="above",("above"==i||t&&"below"!==i)&&(u.top=o.top-h.top-s),null!=i&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+i),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+i)),this.$dropdownContainer.css(u)},e.prototype._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},e.prototype._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},e}),e.define("select2/dropdown/minimumResultsForSearch",[],function(){function e(e,t,n,i){this.minimumResultsForSearch=n.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),e.call(this,t,n,i)}return e.prototype.showSearch=function(e,t){return!(function e(t){for(var n=0,i=0;i<t.length;i++){var a=t[i];a.children?n+=e(a.children):n++}return n}(t.data.results)<this.minimumResultsForSearch)&&e.call(this,t)},e}),e.define("select2/dropdown/selectOnClose",["../utils"],function(o){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("close",function(e){i._handleSelectOnClose(e)})},e.prototype._handleSelectOnClose=function(e,t){if(t&&null!=t.originalSelect2Event){var n=t.originalSelect2Event;if("select"===n._type||"unselect"===n._type)return}var i,a=this.getHighlightedResults();a.length<1||null!=(i=o.GetData(a[0],"data")).element&&i.element.selected||null==i.element&&i.selected||this.trigger("select",{data:i})},e}),e.define("select2/dropdown/closeOnSelect",[],function(){function e(){}return e.prototype.bind=function(e,t,n){var i=this;e.call(this,t,n),t.on("select",function(e){i._selectTriggered(e)}),t.on("unselect",function(e){i._selectTriggered(e)})},e.prototype._selectTriggered=function(e,t){var n=t.originalEvent;n&&(n.ctrlKey||n.metaKey)||this.trigger("close",{originalEvent:n,originalSelect2Event:t})},e}),e.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,n="Please delete "+t+" character";return 1!=t&&(n+="s"),n},inputTooShort:function(e){return"Please enter "+(e.minimum-e.input.length)+" or more characters"},loadingMore:function(){return"Loading more results…"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return 1!=e.maximum&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching…"},removeAllItems:function(){return"Remove all items"}}}),e.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(c,p,u,d,h,m,g,f,v,y,s,t,b,_,x,w,k,C,S,A,L,T,D,E,O,R,P,$,e){function n(){this.reset()}return n.prototype.apply=function(e){var t,n,i,a,o;null==(e=c.extend(!0,{},this.defaults,e)).dataAdapter&&(null!=e.ajax?e.dataAdapter=x:null!=e.data?e.dataAdapter=_:e.dataAdapter=b,0<e.minimumInputLength&&(e.dataAdapter=y.Decorate(e.dataAdapter,C)),0<e.maximumInputLength&&(e.dataAdapter=y.Decorate(e.dataAdapter,S)),0<e.maximumSelectionLength&&(e.dataAdapter=y.Decorate(e.dataAdapter,A)),e.tags&&(e.dataAdapter=y.Decorate(e.dataAdapter,w)),null==e.tokenSeparators&&null==e.tokenizer||(e.dataAdapter=y.Decorate(e.dataAdapter,k)),null!=e.query&&(t=p(e.amdBase+"compat/query"),e.dataAdapter=y.Decorate(e.dataAdapter,t)),null!=e.initSelection&&(n=p(e.amdBase+"compat/initSelection"),e.dataAdapter=y.Decorate(e.dataAdapter,n))),null==e.resultsAdapter&&(e.resultsAdapter=u,null!=e.ajax&&(e.resultsAdapter=y.Decorate(e.resultsAdapter,E)),null!=e.placeholder&&(e.resultsAdapter=y.Decorate(e.resultsAdapter,D)),e.selectOnClose&&(e.resultsAdapter=y.Decorate(e.resultsAdapter,P))),null==e.dropdownAdapter&&(e.multiple?e.dropdownAdapter=L:(i=y.Decorate(L,T),e.dropdownAdapter=i),0!==e.minimumResultsForSearch&&(e.dropdownAdapter=y.Decorate(e.dropdownAdapter,R)),e.closeOnSelect&&(e.dropdownAdapter=y.Decorate(e.dropdownAdapter,$)),null==e.dropdownCssClass&&null==e.dropdownCss&&null==e.adaptDropdownCssClass||(a=p(e.amdBase+"compat/dropdownCss"),e.dropdownAdapter=y.Decorate(e.dropdownAdapter,a)),e.dropdownAdapter=y.Decorate(e.dropdownAdapter,O)),null==e.selectionAdapter&&(e.multiple?e.selectionAdapter=h:e.selectionAdapter=d,null!=e.placeholder&&(e.selectionAdapter=y.Decorate(e.selectionAdapter,m)),e.allowClear&&(e.selectionAdapter=y.Decorate(e.selectionAdapter,g)),e.multiple&&(e.selectionAdapter=y.Decorate(e.selectionAdapter,f)),null==e.containerCssClass&&null==e.containerCss&&null==e.adaptContainerCssClass||(o=p(e.amdBase+"compat/containerCss"),e.selectionAdapter=y.Decorate(e.selectionAdapter,o)),e.selectionAdapter=y.Decorate(e.selectionAdapter,v)),e.language=this._resolveLanguage(e.language),e.language.push("en");for(var s=[],r=0;r<e.language.length;r++){var l=e.language[r];-1===s.indexOf(l)&&s.push(l)}return e.language=s,e.translations=this._processTranslations(e.language,e.debug),e},n.prototype.reset=function(){function r(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return t[e]||e})}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:y.escapeMarkup,language:{},matcher:function e(t,n){if(""===c.trim(t.term))return n;if(n.children&&0<n.children.length){for(var i=c.extend(!0,{},n),a=n.children.length-1;0<=a;a--)null==e(t,n.children[a])&&i.children.splice(a,1);return 0<i.children.length?i:e(t,i)}var o=r(n.text).toUpperCase(),s=r(t.term).toUpperCase();return-1<o.indexOf(s)?n:null},minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,scrollAfterSelect:!1,sorter:function(e){return e},templateResult:function(e){return e.text},templateSelection:function(e){return e.text},theme:"default",width:"resolve"}},n.prototype.applyFromElement=function(e,t){var n=e.language,i=this.defaults.language,a=t.prop("lang"),o=t.closest("[lang]").prop("lang"),s=Array.prototype.concat.call(this._resolveLanguage(a),this._resolveLanguage(n),this._resolveLanguage(i),this._resolveLanguage(o));return e.language=s,e},n.prototype._resolveLanguage=function(e){if(!e)return[];if(c.isEmptyObject(e))return[];if(c.isPlainObject(e))return[e];for(var t,n=c.isArray(e)?e:[e],i=[],a=0;a<n.length;a++)i.push(n[a]),"string"==typeof n[a]&&0<n[a].indexOf("-")&&(t=n[a].split("-")[0],i.push(t));return i},n.prototype._processTranslations=function(e,t){for(var n=new s,i=0;i<e.length;i++){var a=new s,o=e[i];if("string"==typeof o)try{a=s.loadPath(o)}catch(e){try{o=this.defaults.amdLanguageBase+o,a=s.loadPath(o)}catch(e){t&&window.console&&console.warn&&console.warn('Select2: The language file for "'+o+'" could not be automatically loaded. A fallback will be used instead.')}}else a=c.isPlainObject(o)?new s(o):o;n.extend(a)}return n},n.prototype.set=function(e,t){var n={};n[c.camelCase(e)]=t;var i=y._convertData(n);c.extend(!0,this.defaults,i)},new n}),e.define("select2/options",["require","jquery","./defaults","./utils"],function(i,u,a,d){function e(e,t){var n;this.options=e,null!=t&&this.fromElement(t),null!=t&&(this.options=a.applyFromElement(this.options,t)),this.options=a.apply(this.options),t&&t.is("input")&&(n=i(this.get("amdBase")+"compat/inputData"),this.options.dataAdapter=d.Decorate(this.options.dataAdapter,n))}return e.prototype.fromElement=function(e){var t=["select2"];null==this.options.multiple&&(this.options.multiple=e.prop("multiple")),null==this.options.disabled&&(this.options.disabled=e.prop("disabled")),null==this.options.dir&&(e.prop("dir")?this.options.dir=e.prop("dir"):e.closest("[dir]").prop("dir")?this.options.dir=e.closest("[dir]").prop("dir"):this.options.dir="ltr"),e.prop("disabled",this.options.disabled),e.prop("multiple",this.options.multiple),d.GetData(e[0],"select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),d.StoreData(e[0],"data",d.GetData(e[0],"select2Tags")),d.StoreData(e[0],"tags",!0)),d.GetData(e[0],"ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),e.attr("ajax--url",d.GetData(e[0],"ajaxUrl")),d.StoreData(e[0],"ajax-Url",d.GetData(e[0],"ajaxUrl")));var n={};function i(e,t){return t.toUpperCase()}for(var a=0;a<e[0].attributes.length;a++){var o,s,r=e[0].attributes[a].name,l="data-";r.substr(0,l.length)==l&&(o=r.substring(l.length),s=d.GetData(e[0],o),n[o.replace(/-([a-z])/g,i)]=s)}u.fn.jquery&&"1."==u.fn.jquery.substr(0,2)&&e[0].dataset&&(n=u.extend(!0,{},e[0].dataset,n));var c=u.extend(!0,{},d.GetData(e[0]),n),c=d._convertData(c);for(var p in c)-1<u.inArray(p,t)||(u.isPlainObject(this.options[p])?u.extend(this.options[p],c[p]):this.options[p]=c[p]);return this},e.prototype.get=function(e){return this.options[e]},e.prototype.set=function(e,t){this.options[e]=t},e}),e.define("select2/core",["jquery","./options","./utils","./keys"],function(o,c,p,i){var u=function(e,t){null!=p.GetData(e[0],"select2")&&p.GetData(e[0],"select2").destroy(),this.$element=e,this.id=this._generateId(e),t=t||{},this.options=new c(t,e),u.__super__.constructor.call(this);var n=e.attr("tabindex")||0;p.StoreData(e[0],"old-tabindex",n),e.attr("tabindex","-1");var i=this.options.get("dataAdapter");this.dataAdapter=new i(e,this.options);var a=this.render();this._placeContainer(a);var o=this.options.get("selectionAdapter");this.selection=new o(e,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,a);var s=this.options.get("dropdownAdapter");this.dropdown=new s(e,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,a);var r=this.options.get("resultsAdapter");this.results=new r(e,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var l=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(e){l.trigger("selection:update",{data:e})}),e.addClass("select2-hidden-accessible"),e.attr("aria-hidden","true"),this._syncAttributes(),p.StoreData(e[0],"select2",this),e.data("select2",this)};return p.Extend(u,p.Observable),u.prototype._generateId=function(e){return"select2-"+(null!=e.attr("id")?e.attr("id"):null!=e.attr("name")?e.attr("name")+"-"+p.generateChars(2):p.generateChars(4)).replace(/(:|\.|\[|\]|,)/g,"")},u.prototype._placeContainer=function(e){e.insertAfter(this.$element);var t=this._resolveWidth(this.$element,this.options.get("width"));null!=t&&e.css("width",t)},u.prototype._resolveWidth=function(e,t){var n=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==t){var i=this._resolveWidth(e,"style");return null!=i?i:this._resolveWidth(e,"element")}if("element"==t){var a=e.outerWidth(!1);return a<=0?"auto":a+"px"}if("style"!=t)return"computedstyle"!=t?t:window.getComputedStyle(e[0]).width;var o=e.attr("style");if("string"!=typeof o)return null;for(var s=o.split(";"),r=0,l=s.length;r<l;r+=1){var c=s[r].replace(/\s/g,"").match(n);if(null!==c&&1<=c.length)return c[1]}return null},u.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},u.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",function(){t.dataAdapter.current(function(e){t.trigger("selection:update",{data:e})})}),this.$element.on("focus.select2",function(e){t.trigger("focus",e)}),this._syncA=p.bind(this._syncAttributes,this),this._syncS=p.bind(this._syncSubtree,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._syncA);var e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=e?(this._observer=new e(function(e){t._syncA(),t._syncS(null,e)}),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener("DOMAttrModified",t._syncA,!1),this.$element[0].addEventListener("DOMNodeInserted",t._syncS,!1),this.$element[0].addEventListener("DOMNodeRemoved",t._syncS,!1))},u.prototype._registerDataEvents=function(){var n=this;this.dataAdapter.on("*",function(e,t){n.trigger(e,t)})},u.prototype._registerSelectionEvents=function(){var n=this,i=["toggle","focus"];this.selection.on("toggle",function(){n.toggleDropdown()}),this.selection.on("focus",function(e){n.focus(e)}),this.selection.on("*",function(e,t){-1===o.inArray(e,i)&&n.trigger(e,t)})},u.prototype._registerDropdownEvents=function(){var n=this;this.dropdown.on("*",function(e,t){n.trigger(e,t)})},u.prototype._registerResultsEvents=function(){var n=this;this.results.on("*",function(e,t){n.trigger(e,t)})},u.prototype._registerEvents=function(){var n=this;this.on("open",function(){n.$container.addClass("select2-container--open")}),this.on("close",function(){n.$container.removeClass("select2-container--open")}),this.on("enable",function(){n.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){n.$container.addClass("select2-container--disabled")}),this.on("blur",function(){n.$container.removeClass("select2-container--focus")}),this.on("query",function(t){n.isOpen()||n.trigger("open",{}),this.dataAdapter.query(t,function(e){n.trigger("results:all",{data:e,query:t})})}),this.on("query:append",function(t){this.dataAdapter.query(t,function(e){n.trigger("results:append",{data:e,query:t})})}),this.on("keypress",function(e){var t=e.which;n.isOpen()?t===i.ESC||t===i.TAB||t===i.UP&&e.altKey?(n.close(e),e.preventDefault()):t===i.ENTER?(n.trigger("results:select",{}),e.preventDefault()):t===i.SPACE&&e.ctrlKey?(n.trigger("results:toggle",{}),e.preventDefault()):t===i.UP?(n.trigger("results:previous",{}),e.preventDefault()):t===i.DOWN&&(n.trigger("results:next",{}),e.preventDefault()):(t===i.ENTER||t===i.SPACE||t===i.DOWN&&e.altKey)&&(n.open(),e.preventDefault())})},u.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.isDisabled()?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},u.prototype._isChangeMutation=function(e,t){var n=!1,i=this;if(!e||!e.target||"OPTION"===e.target.nodeName||"OPTGROUP"===e.target.nodeName){if(t)if(t.addedNodes&&0<t.addedNodes.length)for(var a=0;a<t.addedNodes.length;a++)t.addedNodes[a].selected&&(n=!0);else t.removedNodes&&0<t.removedNodes.length?n=!0:o.isArray(t)&&o.each(t,function(e,t){if(i._isChangeMutation(e,t))return!(n=!0)});else n=!0;return n}},u.prototype._syncSubtree=function(e,t){var n=this._isChangeMutation(e,t),i=this;n&&this.dataAdapter.current(function(e){i.trigger("selection:update",{data:e})})},u.prototype.trigger=function(e,t){var n=u.__super__.trigger,i={open:"opening",close:"closing",select:"selecting",unselect:"unselecting",clear:"clearing"};if(void 0===t&&(t={}),e in i){var a=i[e],o={prevented:!1,name:e,args:t};if(n.call(this,a,o),o.prevented)return void(t.prevented=!0)}n.call(this,e,t)},u.prototype.toggleDropdown=function(){this.isDisabled()||(this.isOpen()?this.close():this.open())},u.prototype.open=function(){this.isOpen()||this.isDisabled()||this.trigger("query",{})},u.prototype.close=function(e){this.isOpen()&&this.trigger("close",{originalEvent:e})},u.prototype.isEnabled=function(){return!this.isDisabled()},u.prototype.isDisabled=function(){return this.options.get("disabled")},u.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},u.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},u.prototype.focus=function(e){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},u.prototype.enable=function(e){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),null!=e&&0!==e.length||(e=[!0]);var t=!e[0];this.$element.prop("disabled",t)},u.prototype.data=function(){this.options.get("debug")&&0<arguments.length&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var t=[];return this.dataAdapter.current(function(e){t=e}),t},u.prototype.val=function(e){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==e||0===e.length)return this.$element.val();var t=e[0];o.isArray(t)&&(t=o.map(t,function(e){return e.toString()})),this.$element.val(t).trigger("input").trigger("change")},u.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._syncA),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener("DOMAttrModified",this._syncA,!1),this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,!1),this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,!1)),this._syncA=null,this._syncS=null,this.$element.off(".select2"),this.$element.attr("tabindex",p.GetData(this.$element[0],"old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),p.RemoveData(this.$element[0]),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},u.prototype.render=function(){var e=o('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return e.attr("dir",this.options.get("dir")),this.$container=e,this.$container.addClass("select2-container--"+this.options.get("theme")),p.StoreData(e[0],"element",this.$element),e},u}),e.define("jquery-mousewheel",["jquery"],function(e){return e}),e.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults","./select2/utils"],function(a,e,o,t,s){var r;return null==a.fn.select2&&(r=["open","close","destroy"],a.fn.select2=function(t){if("object"==typeof(t=t||{}))return this.each(function(){var e=a.extend(!0,{},t);new o(a(this),e)}),this;if("string"!=typeof t)throw new Error("Invalid arguments for Select2: "+t);var n,i=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=s.GetData(this,"select2");null==e&&window.console&&console.error&&console.error("The select2('"+t+"') method was called on an element that is not using Select2."),n=e[t].apply(e,i)}),-1<a.inArray(t,r)?this:n}),null==a.fn.select2.defaults&&(a.fn.select2.defaults=t),o}),{define:e.define,require:e.require});function x(e,t){return r.call(e,t)}function p(e,t){var n,i,a,o,s,r,l,c,p,u,d,h=t&&t.split("/"),m=y.map,g=m&&m["*"]||{};if(e){for(s=(e=e.split("/")).length-1,y.nodeIdCompat&&_.test(e[s])&&(e[s]=e[s].replace(_,"")),"."===e[0].charAt(0)&&h&&(e=h.slice(0,h.length-1).concat(e)),p=0;p<e.length;p++)if("."===(d=e[p]))e.splice(p,1),--p;else if(".."===d){if(0===p||1===p&&".."===e[2]||".."===e[p-1])continue;0<p&&(e.splice(p-1,2),p-=2)}e=e.join("/")}if((h||g)&&m){for(p=(n=e.split("/")).length;0<p;--p){if(i=n.slice(0,p).join("/"),h)for(u=h.length;0<u;--u)if(a=(a=m[h.slice(0,u).join("/")])&&a[i]){o=a,r=p;break}if(o)break;!l&&g&&g[i]&&(l=g[i],c=p)}!o&&l&&(o=l,r=c),o&&(n.splice(0,r,o),e=n.join("/"))}return e}function w(t,n){return function(){var e=l.call(arguments,0);return"string"!=typeof e[0]&&1===e.length&&e.push(null),s.apply(h,e.concat([t,n]))}}function k(e){var t;if(x(v,e)&&(t=v[e],delete v[e],b[e]=!0,o.apply(h,t)),!x(f,e)&&!x(b,e))throw new Error("No "+e);return f[e]}function u(e){var t,n=e?e.indexOf("!"):-1;return-1<n&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function C(e){return e?u(e):[]}var d=c.require("jquery.select2");return t.fn.select2.amd=c,d}),QR8bitByte.prototype={getLength:function(e){return this.data.length},write:function(e){for(var t=0;t<this.data.length;t++)e.put(this.data.charCodeAt(t),8)}},QRCode.prototype={addData:function(e){var t=new QR8bitByte(e);this.dataList.push(t),this.dataCache=null},isDark:function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){if(this.typeNumber<1){for(var e=1,e=1;e<40;e++){for(var t=QRRSBlock.getRSBlocks(e,this.errorCorrectLevel),n=new QRBitBuffer,i=0,a=0;a<t.length;a++)i+=t[a].dataCount;for(a=0;a<this.dataList.length;a++){var o=this.dataList[a];n.put(o.mode,4),n.put(o.getLength(),QRUtil.getLengthInBits(o.mode,e)),o.write(n)}if(n.getLengthInBits()<=8*i)break}this.typeNumber=e}this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,t){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[n][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,t),7<=this.typeNumber&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=QRCode.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,t)},setupPositionProbePattern:function(e,t){for(var n=-1;n<=7;n++)if(!(e+n<=-1||this.moduleCount<=e+n))for(var i=-1;i<=7;i++)t+i<=-1||this.moduleCount<=t+i||(this.modules[e+n][t+i]=0<=n&&n<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=i&&i<=4)},getBestMaskPattern:function(){for(var e=0,t=0,n=0;n<8;n++){this.makeImpl(!0,n);var i=QRUtil.getLostPoint(this);(0==n||i<e)&&(e=i,t=n)}return t},createMovieClip:function(e,t,n){var i=e.createEmptyMovieClip(t,n);this.make();for(var a=0;a<this.modules.length;a++)for(var o=+a,s=0;s<this.modules[a].length;s++){var r=+s;this.modules[a][s]&&(i.beginFill(0,100),i.moveTo(r,o),i.lineTo(1+r,o),i.lineTo(1+r,1+o),i.lineTo(r,1+o),i.endFill())}return i},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},setupPositionAdjustPattern:function(){for(var e=QRUtil.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var n=0;n<e.length;n++){var i=e[t],a=e[n];if(null==this.modules[i][a])for(var o=-2;o<=2;o++)for(var s=-2;s<=2;s++)this.modules[i+o][a+s]=-2==o||2==o||-2==s||2==s||0==o&&0==s}},setupTypeNumber:function(e){for(var t=QRUtil.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var i=!e&&1==(t>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=i}for(n=0;n<18;n++){i=!e&&1==(t>>n&1);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=i}},setupTypeInfo:function(e,t){for(var n=this.errorCorrectLevel<<3|t,i=QRUtil.getBCHTypeInfo(n),a=0;a<15;a++){var o=!e&&1==(i>>a&1);a<6?this.modules[a][8]=o:a<8?this.modules[a+1][8]=o:this.modules[this.moduleCount-15+a][8]=o}for(a=0;a<15;a++){o=!e&&1==(i>>a&1);a<8?this.modules[8][this.moduleCount-a-1]=o:a<9?this.modules[8][15-a-1+1]=o:this.modules[8][15-a-1]=o}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var n=-1,i=this.moduleCount-1,a=7,o=0,s=this.moduleCount-1;0<s;s-=2)for(6==s&&s--;;){for(var r,l=0;l<2;l++){null==this.modules[i][s-l]&&(r=!1,o<e.length&&(r=1==(e[o]>>>a&1)),QRUtil.getMask(t,i,s-l)&&(r=!r),this.modules[i][s-l]=r,-1==--a&&(o++,a=7))}if((i+=n)<0||this.moduleCount<=i){i-=n,n=-n;break}}}},QRCode.PAD0=236,QRCode.PAD1=17,QRCode.createData=function(e,t,n){for(var i=QRRSBlock.getRSBlocks(e,t),a=new QRBitBuffer,o=0;o<n.length;o++){var s=n[o];a.put(s.mode,4),a.put(s.getLength(),QRUtil.getLengthInBits(s.mode,e)),s.write(a)}for(var r=0,o=0;o<i.length;o++)r+=i[o].dataCount;if(a.getLengthInBits()>8*r)throw new Error("code length overflow. ("+a.getLengthInBits()+">"+8*r+")");for(a.getLengthInBits()+4<=8*r&&a.put(0,4);a.getLengthInBits()%8!=0;)a.putBit(!1);for(;!(a.getLengthInBits()>=8*r||(a.put(QRCode.PAD0,8),a.getLengthInBits()>=8*r));)a.put(QRCode.PAD1,8);return QRCode.createBytes(a,i)},QRCode.createBytes=function(e,t){for(var n=0,i=0,a=0,o=new Array(t.length),s=new Array(t.length),r=0;r<t.length;r++){var l=t[r].dataCount,c=t[r].totalCount-l,i=Math.max(i,l),a=Math.max(a,c);o[r]=new Array(l);for(var p=0;p<o[r].length;p++)o[r][p]=255&e.buffer[p+n];n+=l;var u=QRUtil.getErrorCorrectPolynomial(c),d=new QRPolynomial(o[r],u.getLength()-1).mod(u);s[r]=new Array(u.getLength()-1);for(p=0;p<s[r].length;p++){var h=p+d.getLength()-s[r].length;s[r][p]=0<=h?d.get(h):0}}for(var m=0,p=0;p<t.length;p++)m+=t[p].totalCount;for(var g=new Array(m),f=0,p=0;p<i;p++)for(r=0;r<t.length;r++)p<o[r].length&&(g[f++]=o[r][p]);for(p=0;p<a;p++)for(r=0;r<t.length;r++)p<s[r].length&&(g[f++]=s[r][p]);return g};for(var QRMode={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},QRErrorCorrectLevel={L:1,M:0,Q:3,H:2},QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},QRUtil={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;0<=QRUtil.getBCHDigit(t)-QRUtil.getBCHDigit(QRUtil.G15);)t^=QRUtil.G15<<QRUtil.getBCHDigit(t)-QRUtil.getBCHDigit(QRUtil.G15);return(e<<10|t)^QRUtil.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;0<=QRUtil.getBCHDigit(t)-QRUtil.getBCHDigit(QRUtil.G18);)t^=QRUtil.G18<<QRUtil.getBCHDigit(t)-QRUtil.getBCHDigit(QRUtil.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return QRUtil.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,n){switch(e){case QRMaskPattern.PATTERN000:return(t+n)%2==0;case QRMaskPattern.PATTERN001:return t%2==0;case QRMaskPattern.PATTERN010:return n%3==0;case QRMaskPattern.PATTERN011:return(t+n)%3==0;case QRMaskPattern.PATTERN100:return(Math.floor(t/2)+Math.floor(n/3))%2==0;case QRMaskPattern.PATTERN101:return t*n%2+t*n%3==0;case QRMaskPattern.PATTERN110:return(t*n%2+t*n%3)%2==0;case QRMaskPattern.PATTERN111:return(t*n%3+(t+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new QRPolynomial([1],0),n=0;n<e;n++)t=t.multiply(new QRPolynomial([1,QRMath.gexp(n)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case QRMode.MODE_NUMBER:return 10;case QRMode.MODE_ALPHA_NUM:return 9;case QRMode.MODE_8BIT_BYTE:case QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(t<27)switch(e){case QRMode.MODE_NUMBER:return 12;case QRMode.MODE_ALPHA_NUM:return 11;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(t<41))throw new Error("type:"+t);switch(e){case QRMode.MODE_NUMBER:return 14;case QRMode.MODE_ALPHA_NUM:return 13;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),n=0,i=0;i<t;i++)for(var a=0;a<t;a++){for(var o=0,s=e.isDark(i,a),r=-1;r<=1;r++)if(!(i+r<0||t<=i+r))for(var l=-1;l<=1;l++)a+l<0||t<=a+l||0==r&&0==l||s==e.isDark(i+r,a+l)&&o++;5<o&&(n+=3+o-5)}for(i=0;i<t-1;i++)for(a=0;a<t-1;a++){var c=0;e.isDark(i,a)&&c++,e.isDark(i+1,a)&&c++,e.isDark(i,a+1)&&c++,e.isDark(i+1,a+1)&&c++,0!=c&&4!=c||(n+=3)}for(i=0;i<t;i++)for(a=0;a<t-6;a++)e.isDark(i,a)&&!e.isDark(i,a+1)&&e.isDark(i,a+2)&&e.isDark(i,a+3)&&e.isDark(i,a+4)&&!e.isDark(i,a+5)&&e.isDark(i,a+6)&&(n+=40);for(a=0;a<t;a++)for(i=0;i<t-6;i++)e.isDark(i,a)&&!e.isDark(i+1,a)&&e.isDark(i+2,a)&&e.isDark(i+3,a)&&e.isDark(i+4,a)&&!e.isDark(i+5,a)&&e.isDark(i+6,a)&&(n+=40);for(var p=0,a=0;a<t;a++)for(i=0;i<t;i++)e.isDark(i,a)&&p++;return n+=10*(Math.abs(100*p/t/t-50)/5)}},QRMath={glog:function(e){if(e<1)throw new Error("glog("+e+")");return QRMath.LOG_TABLE[e]},gexp:function(e){for(;e<0;)e+=255;for(;256<=e;)e-=255;return QRMath.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},i=0;i<8;i++)QRMath.EXP_TABLE[i]=1<<i;for(i=8;i<256;i++)QRMath.EXP_TABLE[i]=QRMath.EXP_TABLE[i-4]^QRMath.EXP_TABLE[i-5]^QRMath.EXP_TABLE[i-6]^QRMath.EXP_TABLE[i-8];for(i=0;i<255;i++)QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]]=i;function QRPolynomial(e,t){if(null==e.length)throw new Error(e.length+"/"+t);for(var n=0;n<e.length&&0==e[n];)n++;this.num=new Array(e.length-n+t);for(var i=0;i<e.length-n;i++)this.num[i]=e[i+n]}function QRRSBlock(e,t){this.totalCount=e,this.dataCount=t}function QRBitBuffer(){this.buffer=new Array,this.length=0}QRPolynomial.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),n=0;n<this.getLength();n++)for(var i=0;i<e.getLength();i++)t[n+i]^=QRMath.gexp(QRMath.glog(this.get(n))+QRMath.glog(e.get(i)));return new QRPolynomial(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=QRMath.glog(this.get(0))-QRMath.glog(e.get(0)),n=new Array(this.getLength()),i=0;i<this.getLength();i++)n[i]=this.get(i);for(i=0;i<e.getLength();i++)n[i]^=QRMath.gexp(QRMath.glog(e.get(i))+t);return new QRPolynomial(n,0).mod(e)}},QRRSBlock.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],QRRSBlock.getRSBlocks=function(e,t){var n=QRRSBlock.getRsBlockTable(e,t);if(null==n)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var i=n.length/3,a=new Array,o=0;o<i;o++)for(var s=n[3*o+0],r=n[3*o+1],l=n[3*o+2],c=0;c<s;c++)a.push(new QRRSBlock(r,l));return a},QRRSBlock.getRsBlockTable=function(e,t){switch(t){case QRErrorCorrectLevel.L:return QRRSBlock.RS_BLOCK_TABLE[4*(e-1)+0];case QRErrorCorrectLevel.M:return QRRSBlock.RS_BLOCK_TABLE[4*(e-1)+1];case QRErrorCorrectLevel.Q:return QRRSBlock.RS_BLOCK_TABLE[4*(e-1)+2];case QRErrorCorrectLevel.H:return QRRSBlock.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},QRBitBuffer.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var n=0;n<t;n++)this.putBit(1==(e>>>t-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},function(r){r.fn.qrcode=function(c){"string"==typeof c&&(c={text:c}),c=r.extend({},{render:"canvas",width:256,height:256,typeNumber:-1,correctLevel:QRErrorCorrectLevel.H,background:"#ffffff",foreground:"#000000"},c);return this.each(function(){var e=("canvas"==c.render?function(){var e=new QRCode(c.typeNumber,c.correctLevel);e.addData(c.text),e.make();var t=document.createElement("canvas");t.width=c.width,t.height=c.height;for(var n=t.getContext("2d"),i=c.width/e.getModuleCount(),a=c.height/e.getModuleCount(),o=0;o<e.getModuleCount();o++)for(var s=0;s<e.getModuleCount();s++){n.fillStyle=e.isDark(o,s)?c.foreground:c.background;var r=Math.ceil((s+1)*i)-Math.floor(s*i),l=Math.ceil((o+1)*a)-Math.floor(o*a);n.fillRect(Math.round(s*i),Math.round(o*a),r,l)}return t}:function(){var e=new QRCode(c.typeNumber,c.correctLevel);e.addData(c.text),e.make();for(var t=r("<table></table>").css("width",c.width+"px").css("height",c.height+"px").css("border","0px").css("border-collapse","collapse").css("background-color",c.background),n=c.width/e.getModuleCount(),i=c.height/e.getModuleCount(),a=0;a<e.getModuleCount();a++)for(var o=r("<tr></tr>").css("height",i+"px").appendTo(t),s=0;s<e.getModuleCount();s++)r("<td></td>").css("width",n+"px").css("background-color",e.isDark(a,s)?c.foreground:c.background).appendTo(o);return t})();r(e).appendTo(this)})}}(jQuery);